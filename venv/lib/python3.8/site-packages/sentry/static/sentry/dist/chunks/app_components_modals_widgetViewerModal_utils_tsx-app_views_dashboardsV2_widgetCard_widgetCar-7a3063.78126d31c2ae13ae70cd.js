"use strict";(globalThis.webpackChunk=globalThis.webpackChunk||[]).push([["app_components_modals_widgetViewerModal_utils_tsx-app_views_dashboardsV2_widgetCard_widgetCar-7a3063"],{"./app/components/charts/simpleTableChart.tsx":(e,t,s)=>{s.d(t,{Z:()=>w,p:()=>b});var i=s("../node_modules/@emotion/styled/base/dist/emotion-styled-base.browser.esm.js"),r=(s("../node_modules/core-js/modules/es.array.includes.js"),s("../node_modules/react/index.js")),n=s("./app/components/panels/panelTable.tsx"),o=s("./app/components/tooltip.tsx"),a=s("./app/components/truncate.tsx"),l=s("./app/styles/space.tsx"),d=s("./app/utils/discover/fieldRenderers.tsx"),u=s("./app/utils/discover/fields.tsx"),c=s("./app/utils/withOrganization.tsx"),p=s("./app/views/eventsV2/table/topResultsIndicator.tsx"),g=s("./app/views/eventsV2/utils.tsx"),m=s("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");function h(e){let{className:t,loading:s,eventView:i,fields:n,metadata:a,data:l,title:c,fieldHeaderMap:h,stickyHeaders:w,getCustomFieldRenderer:x,organization:Z,topResultsIndicators:R,location:j,fieldAliases:S,loader:_}=e;const E=null!=a?a:{},F=Z.features.includes("discover-frontend-use-events-endpoint"),q=(0,g.Hg)(n.map(((e,t)=>({field:e,alias:S[t]}))),F);return(0,m.BX)(r.Fragment,{children:[c&&(0,m.tZ)("h4",{children:c}),(0,m.tZ)(f,{className:t,isLoading:s,loader:_,headers:q.map(((e,t)=>{var s;const i=(0,u.qG)(e.name,e.type,E),r=e.column.alias||(null!==(s=null==h?void 0:h[e.key])&&void 0!==s?s:e.name);return(0,m.tZ)(y,{align:i,children:(0,m.tZ)(o.Z,{title:r,children:(0,m.tZ)(v,{value:r,maxLength:30,expandable:!1})})},t)})),isEmpty:!(null!=l&&l.length),stickyHeaders:w,disablePadding:!0,children:null==l?void 0:l.map(((e,t)=>function(e,t,s,r){return r.map(((r,n)=>{var o;const a=null!==(o=null==x?void 0:x(r.key,s,{organization:Z}))&&void 0!==o?o:(0,d.Js)(r.key,s);return(0,m.BX)(b,{children:[R&&0===n&&(0,m.tZ)(p.Z,{count:R,index:e}),a(t,{organization:Z,location:j,eventView:i})]},`${e}-${n}:${r.name}`)}))}(t,e,E,q)))})]})}h.displayName="SimpleTableChart";const v=(0,i.Z)(a.Z,{target:"e3tr8vk3"})({name:"1bmnxg7",styles:"white-space:nowrap"}),f=(0,i.Z)(n.Z,{target:"e3tr8vk2"})("border-radius:0;border-left:0;border-right:0;border-bottom:0;margin:0;",n.z,"{height:min-content;}"),y=(0,i.Z)("div",{target:"e3tr8vk1"})((e=>e.align?`text-align: ${e.align};`:"")," padding:",(0,l.Z)(1)," ",(0,l.Z)(3),";"),b=(0,i.Z)("div",{target:"e3tr8vk0"})("padding:",(0,l.Z)(1)," ",(0,l.Z)(3),";"),w=(0,c.Z)(h)},"./app/components/modals/widgetViewerModal/utils.tsx":(e,t,s)=>{let i;function r(e){return e.match(/\/widget\/[0-9]+\/$/)}s.d(t,{R:()=>i,X:()=>r}),function(e){e.SORT="sort",e.QUERY="query",e.LEGEND="legend",e.PAGE="page",e.CURSOR="cursor",e.WIDTH="width",e.START="viewerStart",e.END="viewerEnd"}(i||(i={}))},"./app/utils/dashboards/issueFieldRenderers.tsx":(e,t,s)=>{s.d(t,{N:()=>x,O:()=>O});var i=s("../node_modules/@emotion/styled/base/dist/emotion-styled-base.browser.esm.js"),r=(s("../node_modules/core-js/modules/es.array.includes.js"),s("../node_modules/react/index.js")),n=s("./app/components/assigneeSelector.tsx"),o=s("./app/components/count.tsx"),a=s("./app/components/links/link.tsx"),l=s("./app/components/organizations/timeRangeSelector/utils.tsx"),d=s("./app/components/tooltip.tsx"),u=s("./app/constants/index.tsx"),c=s("./app/locale.tsx"),p=s("./app/stores/memberListStore.tsx"),g=s("./app/styles/space.tsx"),m=s("./app/utils/discover/eventView.tsx"),h=s("./app/views/dashboardsV2/widgetBuilder/issueWidget/fields.tsx"),v=s("./app/utils/discover/styles.tsx"),f=s("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");const y={issue:{sortField:null,renderFunc:(e,t)=>{let{organization:s}=t;const i=e["issue.id"];if(!i)return(0,f.tZ)(v.W2,{children:(0,f.tZ)(v.PV,{shortId:`${e.issue}`})});const r={pathname:`/organizations/${s.slug}/issues/${i}/`};return(0,f.tZ)(v.W2,{children:(0,f.tZ)(v.Jo,{to:r,"aria-label":i,children:(0,f.tZ)(v.PV,{shortId:`${e.issue}`})})})}},assignee:{sortField:null,renderFunc:e=>{const t=p.Z.getAll();return(0,f.tZ)(F,{children:(0,f.tZ)(n.Z,{id:e.id,memberList:t,noDropdown:!0})})}},lifetimeEvents:{sortField:null,renderFunc:(e,t)=>{let{organization:s}=t;return b(e,s,"lifetimeEvents")}},lifetimeUsers:{sortField:null,renderFunc:(e,t)=>{let{organization:s}=t;return b(e,s,"lifetimeUsers")}},events:{sortField:"freq",renderFunc:(e,t)=>{let{organization:s}=t;return b(e,s,"events")}},users:{sortField:"user",renderFunc:(e,t)=>{let{organization:s}=t;return b(e,s,"users")}},lifetimeCount:{sortField:null,renderFunc:(e,t)=>{let{organization:s}=t;return b(e,s,"lifetimeEvents")}},lifetimeUserCount:{sortField:null,renderFunc:(e,t)=>{let{organization:s}=t;return b(e,s,"lifetimeUsers")}},count:{sortField:null,renderFunc:(e,t)=>{let{organization:s}=t;return b(e,s,"events")}},userCount:{sortField:null,renderFunc:(e,t)=>{let{organization:s}=t;return b(e,s,"users")}},links:{sortField:null,renderFunc:e=>{let{links:t}=e;return(0,f.tZ)(q,{dangerouslySetInnerHTML:{__html:t}})}}},b=(e,t,s)=>{const{start:i,end:n,period:a}=e,p=!!/user/i.exec(s.toLowerCase()),g=e[s],m=e[p?"users":"events"],h=e[p?"lifetimeUsers":"lifetimeEvents"],y=e[p?"filteredUsers":"filteredEvents"],b=w(e,t),x=w(e,t,!0),Z=i&&n?"time range":(0,l.T)(a||u.GY).toLowerCase();return(0,f.tZ)(v.W2,{children:(0,f.tZ)(d.Z,{isHoverable:!0,skipWrapper:!0,overlayStyle:{padding:0},title:(0,f.BX)("div",{children:[y?(0,f.BX)(r.Fragment,{children:[(0,f.BX)(j,{to:x,children:[(0,c.t)("Matching search filters"),(0,f.tZ)(_,{value:y})]}),(0,f.tZ)(E,{})]}):null,(0,f.BX)(j,{to:b,children:[(0,c.t)(`Total in ${Z}`),(0,f.tZ)(_,{value:m})]}),(0,f.tZ)(E,{}),(0,f.BX)(R,{children:[(0,c.t)("Since issue began"),(0,f.tZ)(_,{value:h})]})]}),children:(0,f.tZ)("span",{children:["events","users"].includes(s)&&y?(0,f.BX)(r.Fragment,{children:[(0,f.tZ)(o.Z,{value:y}),(0,f.tZ)(S,{value:g})]}):(0,f.tZ)(o.Z,{value:g})})})})};b.displayName="issuesCountRenderer";const w=(e,t,s)=>{const i={projects:[Number(e.projectId)]};return m.ZP.fromSavedQuery({...i,id:void 0,start:e.start,end:e.end,range:e.period,name:e.title,fields:["title","release","environment","user","timestamp"],orderby:"-timestamp",query:`issue.id:${e.id}${s?e.discoverSearchQuery:""}`,version:2}).getResultsViewUrlTarget(t.slug)};function x(e){if(y.hasOwnProperty(e))return y[e].sortField;switch(e){case h.Sh.LAST_SEEN:return"date";case h.Sh.FIRST_SEEN:return"new";default:return null}}const Z={name:"s5gdgx",styles:"width:100%;justify-content:space-between;display:flex;padding:6px 10px"},R=(0,i.Z)("div",{target:"e1va53iy6"})(Z,";"),j=(0,i.Z)(a.Z,{target:"e1va53iy5"})(Z,";color:",(e=>e.theme.gray400),";&:hover{color:",(e=>e.theme.gray400),";background:",(e=>e.theme.hover),";}"),S=(0,i.Z)(o.Z,{target:"e1va53iy4"})(":before{content:'/';padding-left:",(0,g.Z)(.25),";padding-right:2px;}"),_=(0,i.Z)((e=>{let{value:t,...s}=e;return(0,f.tZ)("div",{...s,children:(0,f.tZ)(o.Z,{value:t})})}),{target:"e1va53iy3"})("text-align:right;font-weight:bold;font-variant-numeric:tabular-nums;padding-left:",(0,g.Z)(2),";color:",(e=>e.theme.subText),";"),E=(0,i.Z)("div",{target:"e1va53iy2"})("height:1px;overflow:hidden;background-color:",(e=>e.theme.innerBorder),";"),F=(0,i.Z)("div",{target:"e1va53iy1"})({name:"1sl6pdq",styles:"display:flex;justify-content:left;margin-left:18px;height:24px;:hover{cursor:default;}"}),q=(0,i.Z)("span",{target:"e1va53iy0"})({name:"1bmnxg7",styles:"white-space:nowrap"});function O(e){return y.hasOwnProperty(e)?y[e].renderFunc:null}},"./app/utils/discover/charts.tsx":(e,t,s)=>{s.d(t,{CX:()=>a,gu:()=>l});var i=s("./app/locale.tsx"),r=s("./app/utils.tsx"),n=s("./app/utils/discover/fields.tsx"),o=s("./app/utils/formatters.tsx");function a(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";if(!(0,r.ri)(e))return"â€”";switch((0,n.Px)(t)){case"integer":case"number":return e.toLocaleString();case"percentage":return(0,o.rl)(e,2);case"duration":return(0,o.g9)(e/1e3,2,!0);default:return e.toString()}}function l(e,t){let s=arguments.length>2&&void 0!==arguments[2]&&arguments[2];switch((0,n.Px)(t)){case"integer":case"number":return s?(0,o.Du)(e):e.toLocaleString();case"percentage":return(0,o.rl)(e,0);case"duration":return d(e);default:return e.toString()}}function d(e){if(0===e)return"0";if(e>=o.ps){const t=(e/o.ps).toFixed(0);return(0,i.t)("%swk",t)}if(e>=o.x4){const t=(e/o.x4).toFixed(0);return(0,i.t)("%sd",t)}if(e>=o.kr){const t=(e/o.kr).toFixed(0);return(0,i.t)("%shr",t)}if(e>=o.EB){const t=(e/o.EB).toFixed(0);return(0,i.t)("%smin",t)}if(e>=o.sh){const t=(e/o.sh).toFixed(0);return(0,i.t)("%ss",t)}const t=e.toFixed(0);return(0,i.t)("%sms",t)}},"./app/views/dashboardsV2/datasetConfig/base.tsx":(e,t,s)=>{s.d(t,{v:()=>$});var i=s("./app/views/dashboardsV2/types.tsx"),r=(s("../node_modules/core-js/modules/es.array.includes.js"),s("../node_modules/core-js/modules/web.dom-collections.iterator.js"),s("./app/components/charts/utils.tsx")),n=s("./app/components/links/link.tsx"),o=s("./app/components/tooltip.tsx"),a=s("./app/locale.tsx"),l=s("./app/utils/discover/fieldRenderers.tsx"),d=s("./app/utils/discover/fields.tsx"),u=s("./app/utils/discover/styles.tsx"),c=s("./app/utils/discover/urls.tsx"),p=s("./app/utils/events.tsx"),g=s("./app/utils/measurements/measurements.tsx"),m=s("./app/views/eventsV2/utils.tsx"),h=s("./app/views/performance/traceDetails/utils.tsx"),v=s("./app/views/dashboardsV2/widgetCard/widgetQueries.tsx"),f=s("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");const y={defaultWidgetQuery:{name:"",fields:["count()"],columns:[],fieldAliases:[],aggregates:["count()"],conditions:"",orderby:"-count()"},getCustomFieldRenderer:function(e,t,s){var i;const r=!(null!=s&&null!==(i=s.organization)&&void 0!==i&&i.features.includes("discover-frontend-use-events-endpoint"));return"id"===e?b:"trace"===e?w:(0,l.Js)(e,t,r)},getTableFieldOptions:function(e,t){const s=null==e?void 0:e.organization,i=(0,g.i)();return(0,m.R0)({organization:s,tagKeys:Object.values(null!=t?t:{}).map((e=>{let{key:t}=e;return t})),measurementKeys:Object.values(i).map((e=>{let{key:t}=e;return t})),spanOperationBreakdownKeys:d.$4})},supportedDisplayTypes:[i.FO.AREA,i.FO.BAR,i.FO.BIG_NUMBER,i.FO.LINE,i.FO.TABLE,i.FO.TOP_N,i.FO.WORLD_MAP],transformSeries:function(e,t,s){var i;let n=[];const o=t.name,a=(null==s||null===(i=s.organization)||void 0===i?void 0:i.features.includes("new-widget-builder-experience-design"))||!1;if((0,r.Xe)(e)){let s=[];const i=t.aggregates.length>1&&t.columns.length;s=a&&i?(0,v.vD)(e,o):Object.keys(e).map((t=>{const s=o?`${o} : ${t}`:t,i=e[t];return[i.order||0,(0,v.FN)(i,s)]})),n=[...s.sort(((e,t)=>e[0]-t[0])).map((e=>e[1]))]}else{const s=t.aggregates[0],i=o?`${o} : ${s}`:s,r=(0,v.FN)(e,i);n.push(r)}return n},transformTable:function(e,t,s){var i;let r=e;if(null==s||null===(i=s.organization)||void 0===i?void 0:i.features.includes("discover-frontend-use-events-endpoint")){var n,o;const t=null===(n=e.meta)||void 0===n?void 0:n.fields;r={...e,meta:{...t,isMetricsData:null===(o=e.meta)||void 0===o?void 0:o.isMetricsData}}}return r}};function b(e,t){let{eventView:s,organization:i}=t;const r=null==e?void 0:e.id;if(!s||"string"!=typeof r)return null;const l=(0,c.JE)(e),d=(0,c.eQ)({orgSlug:i.slug,eventSlug:l,eventView:s});return(0,f.tZ)(o.Z,{title:(0,a.t)("View Event"),children:(0,f.tZ)(n.Z,{"data-test-id":"view-event",to:d,children:(0,f.tZ)(u.W2,{children:(0,p.XQ)(r)})})})}function w(e,t){let{eventView:s,organization:i,location:r}=t;const l=null==e?void 0:e.trace;if(!s||"string"!=typeof l)return null;const d=s.normalizeDateSelection(r),c=(0,h.YA)(i,String(e.trace),d,{});return(0,f.tZ)(o.Z,{title:(0,a.t)("View Trace"),children:(0,f.tZ)(n.Z,{"data-test-id":"view-trace",to:c,children:(0,f.tZ)(u.W2,{children:(0,p.XQ)(l)})})})}b.displayName="renderEventIdAsLinkable",w.displayName="renderTraceAsLinkable";var x=s("./app/stores/groupStore.tsx"),Z=s("./app/utils/dashboards/issueFieldRenderers.tsx"),R=s("./app/utils/dates.tsx"),j=s("./app/utils/stream.tsx"),S=s("./app/views/issueList/utils.tsx"),_=s("./app/views/dashboardsV2/widgetBuilder/issueWidget/fields.tsx"),E=s("./app/views/dashboardsV2/widgetBuilder/issueWidget/utils.tsx");const F={defaultWidgetQuery:{name:"",fields:["issue","assignee","title"],columns:["issue","assignee","title"],fieldAliases:[],aggregates:[],conditions:"",orderby:S.qh.DATE},getCustomFieldRenderer:Z.O,getTableFieldOptions:()=>(0,E.S)(),fieldHeaderMap:_.kh,supportedDisplayTypes:[i.FO.TABLE],transformTable:function(e,t,s){x.Z.add(e);const i=[];return e.forEach((e=>{var r;let{id:n,shortId:o,title:a,lifetime:l,filtered:d,count:u,userCount:c,project:p,annotations:g,...m}=e;const h={};Object.keys(m).filter((e=>["number","string"].includes(typeof m[e]))).forEach((e=>{h[e]=m[e]}));const v={...h,events:u,users:c,id:n,"issue.id":n,issue:o,title:a,project:p.slug,links:null==g?void 0:g.join(", ")};l&&(v.lifetimeEvents=null==l?void 0:l.count,v.lifetimeUsers=null==l?void 0:l.userCount),d&&(v.filteredEvents=null==d?void 0:d.count,v.filteredUsers=null==d?void 0:d.userCount);const f=t.conditions,y=[];if("string"==typeof f){const e=(0,j.w)(f);for(const t in e)if(!S.QL.includes(t)){const s=e[t].includes(" ")?`"${e[t]}"`:e[t];y.push(`${t}:${s}`)}e.__text&&y.push(e.__text)}v.discoverSearchQuery=(y.length?" ":"")+y.join(" "),v.projectId=p.id;const{period:b,start:w,end:x}=(null==s||null===(r=s.pageFilters)||void 0===r?void 0:r.datetime)||{};w&&x&&(v.start=(0,R.v5)(w),v.end=(0,R.v5)(x)),v.period=null!=b?b:"",i.push(v)})),{data:i}}};var q=s("../node_modules/lodash/omit.js"),O=s.n(q),C=s("./app/types/index.tsx"),M=s("./app/utils.tsx"),T=s("./app/views/dashboardsV2/widgetBuilder/releaseWidget/fields.tsx"),D=s("./app/views/dashboardsV2/widgetCard/releaseWidgetQueries.tsx");function A(e,t,s){const i=Object.entries(t.by).map((e=>{let[t,s]=e;return`${s}`})).join(", ");return`${s?`${s} > `:""}${i?`${i} : ${(0,D.nD)(e)}`:(0,D.nD)(e)}`}function k(e){const t={};for(const[s,i]of Object.entries(e))t[(0,D.nD)(s)]=i;return t}function z(e,t,s){const i={};return s.length?(void 0===e["session.status"]||s.forEach((s=>{const r=s.match(T.$4);r&&(e["session.status"]===r[1]?"session"===r[2]?i[s]=t["sum(session)"]:"user"===r[2]&&(i[s]=t["count_unique(user)"]):i[s]=0)})),i):i}const L={defaultWidgetQuery:{name:"",fields:[`crash_free_rate(${C.r2.SESSION})`],columns:[],fieldAliases:[],aggregates:[`crash_free_rate(${C.r2.SESSION})`],conditions:"",orderby:`-crash_free_rate(${C.r2.SESSION})`},getCustomFieldRenderer:(e,t)=>(0,l.Js)(e,t,!1),getTableFieldOptions:function(){return(0,T.e1)(Object.values(T.Jo),T.ve)},supportedDisplayTypes:[i.FO.AREA,i.FO.BAR,i.FO.BIG_NUMBER,i.FO.LINE,i.FO.TABLE,i.FO.TOP_N],transformSeries:function(e,t){if(null===e)return[];const s=t.name,i=t.columns.includes("session.status"),{derivedStatusFields:r,injectedFields:n}=(0,D.gp)(t.aggregates,t.orderby,i),o=[];return e.groups.length?(e.groups.forEach((t=>{Object.keys(t.series).forEach((i=>{n.includes((0,D.nD)(i))||o.push({seriesName:A(i,t,s),data:e.intervals.map(((e,s)=>{var r;return{name:e,value:null!==(r=t.series[i][s])&&void 0!==r?r:0}}))})})),r.length&&(0,M.ri)(t.by["session.status"])&&r.forEach((i=>{const r=i.match(T.$4);if(r){let n;t.by["session.status"]===r[1]&&("session"===r[2]?n="sum(session)":"user"===r[2]&&(n="count_unique(user)")),o.push({seriesName:A(i,t,s),data:e.intervals.map(((e,s)=>{var i;return{name:e,value:n&&null!==(i=t.series[n][s])&&void 0!==i?i:0}}))})}}))})),o):[{seriesName:`(${(0,a.t)("no results")})`,data:e.intervals.map((e=>({name:e,value:0})))}]},transformTable:function(e,t){const s=t.columns.includes("session.status"),{derivedStatusFields:i,injectedFields:r}=(0,D.gp)(t.aggregates,t.orderby,s),n=e.groups.map(((e,t)=>({id:String(t),...k(e.by),...O()(k(e.totals),r),...z(e.by,e.totals,i)}))),o=n[0];return{meta:{...(a=O()(o,"id"),Object.keys(null!=a?a:{}).reduce(((e,t)=>(e[t]=T.ve.includes(t)?"string":(0,d.Px)(t),e)),{}))},data:n};var a}};function $(e){switch(e){case i.l9.ISSUE:return F;case i.l9.RELEASE:return L;case i.l9.DISCOVER:default:return y}}},"./app/views/dashboardsV2/utils.tsx":(e,t,s)=>{s.d(t,{Cg:()=>T,DW:()=>F,Gl:()=>A,Mf:()=>O,Tk:()=>D,hS:()=>M,qk:()=>j,s:()=>q,tT:()=>S,y1:()=>E,yd:()=>k,z1:()=>C}),s("../node_modules/core-js/modules/es.array.includes.js"),s("../node_modules/core-js/modules/web.dom-collections.iterator.js");var i=s("../node_modules/lodash/cloneDeep.js"),r=s.n(i),n=s("../node_modules/lodash/pick.js"),o=s.n(n),a=s("../node_modules/lodash/trimStart.js"),l=s.n(a),d=s("../node_modules/query-string/index.js"),u=s("./images/dashboard/widget-area.svg"),c=s("./images/dashboard/widget-bar.svg"),p=s("./images/dashboard/widget-big-number.svg"),g=s("./images/dashboard/widget-line-1.svg"),m=s("./images/dashboard/widget-table.svg"),h=s("./images/dashboard/widget-world-map.svg"),v=s("./app/components/arithmeticInput/parser.tsx"),f=s("./app/components/charts/utils.tsx"),y=s("./app/utils.tsx"),b=s("./app/utils/dates.tsx"),w=s("./app/utils/discover/eventView.tsx"),x=s("./app/utils/discover/fields.tsx"),Z=s("./app/utils/discover/types.tsx"),R=s("./app/views/dashboardsV2/types.tsx");function j(e){return r()(e)}function S(e,t,s,i){const{start:r,end:n,period:o}=s.datetime,{projects:a,environments:d}=s,u=i!==R.FO.WORLD_MAP||t.columns.includes("geo.country_code")?[...t.columns,...t.aggregates]:["geo.country_code",...t.columns,...t.aggregates],c=i!==R.FO.WORLD_MAP||t.conditions.includes("has:geo.country_code")?t.conditions:`${t.conditions} has:geo.country_code`.trim(),{orderby:p}=t,g=p?`${p.startsWith("-")?"-":""}${(0,x.LY)(l()(p,"-"))}`:p;return w.ZP.fromSavedQuery({id:void 0,name:e,version:2,fields:u,query:c,orderby:g,projects:a,range:null!=o?o:void 0,start:r?(0,b.v5)(r):void 0,end:n?(0,b.v5)(n):void 0,environment:d})}function _(e){return"string"==typeof e?[e]:e}function E(e){if(e){const t=_(e.queryNames),s=_(e.queryConditions),i=_(e.queryFields),r=[];if(s&&t&&i&&"string"==typeof e.queryOrderby){const{columns:n,aggregates:o}=(0,x.n0)(i);s.forEach(((s,a)=>{r.push({name:t[a],conditions:s,fields:i,columns:n,aggregates:o,orderby:e.queryOrderby})}))}if(e.title&&e.displayType&&e.interval&&r.length>0)return{...o()(e,["title","displayType","interval"]),widgetType:R.l9.DISCOVER,queries:r}}}function F(e){switch(e){case R.FO.BAR:return c;case R.FO.AREA:case R.FO.TOP_N:return u;case R.FO.BIG_NUMBER:return p;case R.FO.TABLE:return m;case R.FO.WORLD_MAP:return h;case R.FO.LINE:default:return g}}function q(e,t,s){let i="bar"===e.displayType?"1d":e.interval;i||(i="5m");const r=(0,b.YJ)(i),n=(0,f.Nm)(t);if(s)return i=(0,f.ZS)(t,s),n>f.aC&&n<=f.w3&&(i="1h"),"bar"===e.displayType?"1d":i;if(n/(60*r)>66){const e=(0,f.ZS)(t,"high");if(r<(0,b.YJ)(e))return e}return i}function O(e){const t=new Set;return e.filter(x.GO).forEach((e=>{const s=(0,v.W9)((0,x.bQ)(e)).tc;s.fields.forEach((e=>{let{term:s}=e;return t.add(s)})),s.functions.forEach((e=>{let{term:s}=e;return t.add(s)}))})),Array.from(t)}function C(e,t,s){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;const r=S(e.title,e.queries[i],t,e.displayType),n=r.getResultsViewUrlTarget(s.slug),o=r.getYAxisOptions().map((e=>{let{value:t}=e;return t}));switch(n.query.yAxis=[...new Set(e.queries[0].aggregates.filter((e=>o.includes(e))))].slice(0,3),e.displayType){case R.FO.WORLD_MAP:n.query.display=Z.DC.WORLDMAP;break;case R.FO.BAR:n.query.display=Z.DC.BAR;break;case R.FO.TOP_N:n.query.display=Z.DC.TOP5;const t=e.queries[0].aggregates;n.query.yAxis=t[t.length-1],t.slice(0,-1).includes(t[t.length-1])&&(n.query.field=t.slice(0,-1))}const a=n.query.field,l=e.queries[0],u=(0,y.ri)(l.fields)?l.fields:[...l.columns,...l.aggregates],c=O(u);c.forEach((e=>{Array.isArray(a)&&!a.includes(e)&&a.unshift(e)}));const p=`${n.pathname}?${d.stringify({...n.query})}`;return p}function M(e,t,s){var i,r,n,o;const{start:a,end:l,utc:u,period:c}=t.datetime,p=a&&l?{start:(0,b.v5)(a),end:(0,b.v5)(l),utc:u}:{statsPeriod:c};return`/organizations/${s.slug}/issues/?${d.stringify({query:null===(i=e.queries)||void 0===i||null===(r=i[0])||void 0===r?void 0:r.conditions,sort:null===(n=e.queries)||void 0===n||null===(o=n[0])||void 0===o?void 0:o.orderby,...p,project:t.projects,environment:t.environments})}`}function T(e,t,s){const{start:i,end:r,utc:n,period:o}=t.datetime,a=i&&r?{start:(0,b.v5)(i),end:(0,b.v5)(r),utc:n}:{statsPeriod:o};return`/organizations/${s.slug}/releases/?${d.stringify({...a,project:t.projects,environment:t.environments})}`}function D(e,t){return"string"==typeof e?t.error=e:Object.keys(e).forEach((s=>{const i=e[s];"string"!=typeof i?Array.isArray(i)&&"string"==typeof i[0]?t[s]=i[0]:Array.isArray(i)&&"object"==typeof i[0]?i.map((e=>D(e,t))):D(i,t):t[s]=i})),t}function A(e){return e?{dataset:"metricsEnhanced"}:{}}function k(e){return e.filter(x.GO).length}},"./app/views/dashboardsV2/widgetBuilder/issueWidget/utils.tsx":(e,t,s)=>{s.d(t,{S:()=>o,W:()=>l}),s("../node_modules/core-js/modules/web.dom-collections.iterator.js");var i=s("./app/views/eventsV2/table/types.tsx"),r=s("./app/views/issueList/utils.tsx"),n=s("./app/views/dashboardsV2/widgetBuilder/issueWidget/fields.tsx");function o(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:n.$L;const t=Object.keys(e).sort(),s={};return t.forEach((t=>{s[`field:${t}`]={label:t,value:{kind:i.L.FIELD,meta:{name:t,dataType:e[t]}}}})),s}const a=[r.qh.DATE,r.qh.NEW,r.qh.FREQ,r.qh.PRIORITY,r.qh.USER];function l(e){const t=[...a];return e&&t.push(r.qh.TREND),t.map((e=>({label:(0,r._k)(e),value:e})))}},"./app/views/dashboardsV2/widgetCard/chart.tsx":(e,t,s)=>{s.d(t,{R:()=>D,Z:()=>k});var i=s("../node_modules/@babel/runtime/helpers/esm/defineProperty.js"),r=s("../node_modules/@emotion/styled/base/dist/emotion-styled-base.browser.esm.js"),n=(s("../node_modules/core-js/modules/web.dom-collections.iterator.js"),s("../node_modules/core-js/modules/es.array.includes.js"),s("../node_modules/react/index.js")),o=s("../node_modules/@emotion/react/dist/emotion-element-cbed451f.browser.esm.js"),a=s("../node_modules/lodash/isEqual.js"),l=s.n(a),d=s("../node_modules/lodash/omit.js"),u=s.n(d),c=s("./app/components/charts/areaChart.tsx"),p=s("./app/components/charts/barChart.tsx"),g=s("./app/components/charts/chartZoom.tsx"),m=s("./app/components/charts/errorPanel.tsx"),h=s("./app/components/charts/lineChart.tsx"),v=s("./app/components/charts/simpleTableChart.tsx"),f=s("./app/components/charts/transitionChart.tsx"),y=s("./app/components/charts/transparentLoadingMask.tsx"),b=s("./app/components/charts/utils.tsx"),w=s("./app/components/charts/worldMapChart.tsx"),x=s("./app/components/loadingIndicator.tsx"),Z=s("./app/components/placeholder.tsx"),R=s("./app/components/tooltip.tsx"),j=s("./app/icons/index.tsx"),S=s("./app/styles/space.tsx"),_=s("./app/utils/discover/charts.tsx"),E=s("./app/utils/discover/fieldRenderers.tsx"),F=s("./app/utils/discover/fields.tsx"),q=s("./app/utils/getDynamicText.tsx"),O=s("./app/views/dashboardsV2/utils.tsx"),C=s("./app/views/dashboardsV2/datasetConfig/base.tsx"),M=s("./app/views/dashboardsV2/types.tsx"),T=s("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");const D=60;class A extends n.Component{constructor(){super(...arguments),(0,i.Z)(this,"state",{containerHeight:0})}shouldComponentUpdate(e,t){var s,i;if(this.props.widget.displayType===M.FO.BIG_NUMBER&&e.widget.displayType===M.FO.BIG_NUMBER&&(this.props.windowWidth!==e.windowWidth||!l()(null===(s=this.props.widget)||void 0===s?void 0:s.layout,null===(i=e.widget)||void 0===i?void 0:i.layout)))return!0;const r={...u()(this.props,["windowWidth"]),widget:{...this.props.widget,title:""}};return e={...u()(e,["windowWidth"]),widget:{...e.widget,title:""}},!l()(r,e)||!l()(this.state,t)}tableResultComponent(e){let{loading:t,errorMessage:s,tableResults:i}=e;const{location:r,widget:n,organization:o,selection:a}=this.props;if(s)return(0,T.tZ)(V,{children:(0,T.tZ)(j.FC,{color:"gray500",size:"lg"})});if(void 0===i)return(0,T.tZ)($,{});const l=(0,C.v)(n.widgetType);return i.map(((e,s)=>{var d,u,c,p,g;const m=null!==(d=null===(u=n.queries[s])||void 0===u||null===(c=u.fields)||void 0===c?void 0:c.map(F.hr))&&void 0!==d?d:[],h=null!==(p=null===(g=n.queries[s])||void 0===g?void 0:g.fieldAliases)&&void 0!==p?p:[],v=(0,O.tT)(n.title,n.queries[0],a,n.displayType);return(0,T.tZ)(I,{eventView:v,fieldAliases:h,location:r,fields:m,title:i.length>1?e.title:"",loading:t,loader:(0,T.tZ)($,{}),metadata:e.meta,data:e.data,organization:o,stickyHeaders:!0,getCustomFieldRenderer:l.getCustomFieldRenderer},`table:${e.title}`)}))}bigNumberComponent(e){let{loading:t,errorMessage:s,tableResults:i}=e;if(s)return(0,T.tZ)(V,{children:(0,T.tZ)(j.FC,{color:"gray500",size:"lg"})});if(void 0===i||t)return(0,T.tZ)(N,{children:"â€”"});const{containerHeight:r}=this.state,{organization:n,widget:o,isMobile:a,expandNumbers:l}=this.props,d=!n.features.includes("discover-frontend-use-events-endpoint")&&o.widgetType!==M.l9.RELEASE;return i.map((e=>{const t={...e.meta},s=Object.keys(t)[0],i=!!l&&"integer"===t[s];if(i&&(t[s]="string"),!s||!e.data.length)return(0,T.tZ)(N,{children:"â€”"},`big_number:${e.title}`);const u=e.data[0],c=(0,E.fK)(s,t,d)(i?{[s]:u[s].toLocaleString()}:u),p=!(o.id||o.tempId);if(!n.features.includes("dashboard-grid-layout")||p||a)return(0,T.tZ)(N,{children:c},`big_number:${e.title}`);const g=l?`max(min(8vw, 90px), ${(0,S.Z)(4)})`:r-parseInt((0,S.Z)(1),10)-parseInt((0,S.Z)(3),10);return(0,T.tZ)(N,{style:{fontSize:g,...l?{padding:`${(0,S.Z)(1)} ${(0,S.Z)(3)} 0 ${(0,S.Z)(3)}`}:{}},children:(0,T.tZ)(R.Z,{title:c,showOnlyOnOverflow:!0,children:c})},`big_number:${e.title}`)}))}chartComponent(e){const{organization:t,widget:s}=this.props,i=t.features.includes("new-widget-builder-experience-design")&&s.queries[0].columns.length>0;switch(s.displayType){case"bar":return(0,T.tZ)(p.v,{...e,stacked:i});case"area":case"top_n":return(0,T.tZ)(c.T,{stacked:!0,...e});case"world_map":return(0,T.tZ)(w.y,{...e});default:return(0,T.tZ)(h.w,{...e})}}render(){var e,t,s;const{theme:i,tableResults:r,timeseriesResults:n,errorMessage:o,loading:a,widget:l,organization:d,onZoom:u,legendOptions:c,expandNumbers:p,showSlider:m,noPadding:h,chartZoomOptions:v}=this.props;if("table"===l.displayType)return(0,q.Z)({value:(0,T.BX)(f.Z,{loading:a,reloading:a,children:[(0,T.tZ)(L,{loading:a}),this.tableResultComponent({tableResults:r,loading:a,errorMessage:o})]}),fixed:(0,T.tZ)(Z.Z,{height:"200px",testId:"skeleton-ui"})});if("big_number"===l.displayType)return(0,T.BX)(f.Z,{loading:a,reloading:a,children:[(0,T.tZ)(L,{loading:a}),(0,T.tZ)(P,{ref:e=>{if(null!==e&&!p){const{height:t}=e.getBoundingClientRect();t!==this.state.containerHeight&&this.setState({containerHeight:t})}},children:this.bigNumberComponent({tableResults:r,loading:a,errorMessage:o})})]});if(o)return(0,T.tZ)(V,{children:(0,T.tZ)(j.FC,{color:"gray500",size:"lg"})});const{location:y,router:w,selection:x,onLegendSelectChanged:R}=this.props,{start:S,end:E,period:O,utc:C}=x.datetime,M=Boolean(d.features.includes("dashboard-grid-layout")&&(l.id||l.tempId));if("world_map"===l.displayType){const{data:e,title:t}=(0,b.JT)(r),s=[{seriesName:t,data:e}];return(0,T.BX)(f.Z,{loading:a,reloading:a,children:[(0,T.tZ)(L,{loading:a}),(0,T.tZ)(B,{autoHeightResize:M,children:(0,q.Z)({value:this.chartComponent({series:s,autoHeightResize:M}),fixed:(0,T.tZ)(Z.Z,{height:"200px",testId:"skeleton-ui"})})})]})}const A={left:0,top:0,selected:(0,b.RI)(y),formatter:e=>{const t=(0,F.hW)(e);if(null!==t){const s=(0,F.b8)(t);null!==s&&(e=s.toUpperCase())}return(0,F.by)(e)&&(e=(0,F.bQ)(e)),e},...c},k=null!==(e=null===(t=l.queries[0])||void 0===t||null===(s=t.aggregates)||void 0===s?void 0:s[0])&&void 0!==e?e:"count()",z=(0,F.GO)(k)?(0,F.vp)(k):k,$={autoHeightResize:M,grid:{left:0,right:4,top:"40px",bottom:m?D:0},seriesOptions:{showSymbol:!1},tooltip:{trigger:"axis",valueFormatter:_.CX},yAxis:{axisLabel:{color:i.chartLabel,formatter:e=>(0,_.gu)(e,z)}}};return(0,T.tZ)(g.Z,{router:w,period:O,start:S,end:E,utc:C,showSlider:m,chartZoomOptions:v,children:e=>{var t,s,r,l;if(o)return(0,T.tZ)(V,{children:(0,T.tZ)(j.FC,{color:"gray500",size:"lg"})});const d=new RegExp("(?:.* : Other$)|^Other$"),c=null==n?void 0:n.some((e=>{let{seriesName:t}=e;return t&&t.match(d)})),p=n?i.charts.getColorPalette(n.length-(c?3:2)):[];c&&(p[p.length]=i.chartOther);const g=n?n.map(((e,t)=>{let s="";return void 0!==e.seriesName&&(s=(0,F.GO)(e.seriesName)?(0,F.vp)(e.seriesName):e.seriesName),{...e,seriesName:s,color:p[t]}})):[],m=null===(t=g[0])||void 0===t||null===(s=t.data[0])||void 0===s?void 0:s.name,v=null===(r=g[0])||void 0===r||null===(l=r.data[g[0].data.length-1])||void 0===l?void 0:l.name;return(0,T.BX)(f.Z,{loading:a,reloading:a,children:[(0,T.tZ)(L,{loading:a}),(0,T.tZ)(B,{autoHeightResize:M,noPadding:h,children:(0,q.Z)({value:this.chartComponent({...e,...$,...u?{onDataZoom:(e,t)=>u({...e,seriesStart:m,seriesEnd:v},t)}:{},legend:A,series:g,onLegendSelectChanged:R}),fixed:(0,T.tZ)(Z.Z,{height:"200px",testId:"skeleton-ui"})})})]})}})}}A.displayName="WidgetCardChart";const k=(0,o.d)(A),z=(0,r.Z)((e=>(0,T.tZ)(y.Z,{...e,maskBackgroundColor:"transparent"})),{target:"eb7j3e6"})({name:"1vcob1d",styles:"display:flex;justify-content:center;align-items:center"}),L=e=>{let{loading:t}=e;return t?(0,T.tZ)(z,{visible:t,children:(0,T.tZ)(x.Z,{mini:!0})}):null};L.displayName="LoadingScreen";const $=(0,r.Z)((e=>{let{className:t}=e;return(0,T.tZ)(Z.Z,{height:"200px",className:t})}),{target:"eb7j3e5"})("background-color:",(e=>e.theme.surface200),";"),P=(0,r.Z)("div",{target:"eb7j3e4"})({name:"af8mp8",styles:"height:100%;width:100%;overflow:hidden"}),N=(0,r.Z)("div",{target:"eb7j3e3"})("line-height:1;display:inline-flex;flex:1;width:100%;min-height:0;font-size:32px;color:",(e=>e.theme.headingColor),";padding:",(0,S.Z)(1)," ",(0,S.Z)(3)," ",(0,S.Z)(3)," ",(0,S.Z)(3),";*{text-align:left!important;}"),B=(0,r.Z)("div",{target:"eb7j3e2"})((e=>e.autoHeightResize&&"height: 100%;")," padding:",(e=>e.noPadding?"0":`0 ${(0,S.Z)(3)} ${(0,S.Z)(3)}`),";"),I=(0,r.Z)(v.Z,{target:"eb7j3e1"})("margin-top:",(0,S.Z)(1.5),";border-bottom-left-radius:",(e=>e.theme.borderRadius),";border-bottom-right-radius:",(e=>e.theme.borderRadius),";font-size:",(e=>e.theme.fontSizeMedium),";box-shadow:none;"),V=(0,r.Z)(m.Z,{target:"eb7j3e0"})("padding:",(0,S.Z)(2),";")},"./app/views/dashboardsV2/widgetCard/dashboardsMEPContext.tsx":(e,t,s)=>{s.d(t,{HH:()=>l,KC:()=>u,XA:()=>a,k:()=>d}),s("../node_modules/core-js/modules/web.dom-collections.iterator.js");var i=s("../node_modules/react/index.js"),r=s("./app/utils/performance/contexts/utils.tsx"),n=s("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");const[o,a,l]=(0,r.n)({name:"DashboardsMEPContext"}),d=l.Consumer;function u(e){let{children:t}=e;const[s,r]=(0,i.useState)(void 0);return(0,n.tZ)(o,{value:{isMetricsData:s,setIsMetricsData:r},children:t})}u.displayName="DashboardsMEPProvider"},"./app/views/dashboardsV2/widgetCard/issueWidgetQueries.tsx":(e,t,s)=>{s.d(t,{Z:()=>b});var i=s("../node_modules/@babel/runtime/helpers/esm/defineProperty.js"),r=(s("../node_modules/core-js/modules/web.dom-collections.iterator.js"),s("../node_modules/react/index.js")),n=s("../node_modules/lodash/isEqual.js"),o=s.n(n),a=s("./app/components/organizations/pageFilters/utils.tsx"),l=s("./app/locale.tsx"),d=s("./app/stores/memberListStore.tsx"),u=s("./app/utils/dates.tsx"),c=s("./app/utils/getDynamicText.tsx"),p=s("./app/views/issueList/utils.tsx"),g=s("./app/views/dashboardsV2/datasetConfig/base.tsx"),m=s("./app/views/dashboardsV2/types.tsx"),h=s("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");const v=p.qh.DATE,f=["owners"];class y extends r.Component{constructor(){super(...arguments),(0,i.Z)(this,"state",{loading:!0,errorMessage:void 0,tableResults:[],memberListStoreLoaded:d.Z.isLoaded(),totalCount:null,pageLinks:null}),(0,i.Z)(this,"unlisteners",[d.Z.listen((()=>{this.setState({memberListStoreLoaded:d.Z.isLoaded()})}),void 0)]),(0,i.Z)(this,"config",(0,g.v)(m.l9.ISSUE))}componentDidMount(){this.fetchData()}componentDidUpdate(e){const{selection:t,widget:s,cursor:i}=this.props,[r]=e.widget.queries.reduce(((e,t)=>{let[s,i]=e,{name:r,...n}=t;return s.push(n),i.push(r),[s,i]}),[[],[]]),[n]=s.queries.reduce(((e,t)=>{let[s,i]=e,{name:r,...n}=t;return s.push(n),i.push(r),[s,i]}),[[],[]]);o()(s.displayType,e.widget.displayType)&&o()(s.interval,e.widget.interval)&&o()(n,r)&&(0,a.WO)(t,e.selection)&&i===e.cursor||this.fetchData()}componentWillUnmount(){this.unlisteners.forEach((e=>null==e?void 0:e()))}async fetchIssuesData(){const{selection:e,api:t,organization:s,widget:i,limit:r,cursor:n,onDataFetched:o}=this.props;this.setState({tableResults:[]});const a=i.queries[0],d=`/organizations/${s.slug}/issues/`,c={project:e.projects,environment:e.environments,query:a.conditions,sort:a.orderby||v,expand:f,limit:null!=r?r:m.$V,cursor:n};e.datetime.period&&(c.statsPeriod=e.datetime.period),e.datetime.end&&(c.end=(0,u.v5)(e.datetime.end)),e.datetime.start&&(c.start=(0,u.v5)(e.datetime.start)),e.datetime.utc&&(c.utc=e.datetime.utc);try{var p,g;const[s,r,n]=await t.requestPromise(d,{includeAllArgs:!0,method:"GET",data:{...c}}),a=this.config.transformTable(s,i.queries[0],{pageFilters:e}),l=null!==(p=null==n?void 0:n.getResponseHeader("X-Hits"))&&void 0!==p?p:null,u=null!==(g=null==n?void 0:n.getResponseHeader("Link"))&&void 0!==g?g:null;this.setState({loading:!1,errorMessage:void 0,tableResults:a.data,totalCount:l,pageLinks:u}),null==o||o({issuesResults:a.data,totalIssuesCount:null!=l?l:void 0,pageLinks:null!=u?u:void 0})}catch(e){var h,y;const t=null!==(h=null==e||null===(y=e.responseJSON)||void 0===y?void 0:y.detail)&&void 0!==h?h:null;this.setState({loading:!1,errorMessage:null!=t?t:(0,l.t)("Unable to load Widget"),tableResults:[]})}}fetchData(){this.setState({loading:!0,errorMessage:void 0}),this.fetchIssuesData()}render(){const{children:e}=this.props,{tableResults:t,loading:s,errorMessage:i,memberListStoreLoaded:r,pageLinks:n,totalCount:o}=this.state;return(0,c.Z)({value:e({loading:s||!r,transformedResults:t,errorMessage:i,pageLinks:n,totalCount:null!=o?o:void 0}),fixed:(0,h.tZ)("div",{})})}}y.displayName="IssueWidgetQueries";const b=y},"./app/views/dashboardsV2/widgetCard/releaseWidgetQueries.tsx":(e,t,s)=>{s.d(t,{ZP:()=>C,nD:()=>F,gp:()=>q});var i=s("../node_modules/@babel/runtime/helpers/esm/defineProperty.js"),r=(s("../node_modules/core-js/modules/es.array.includes.js"),s("../node_modules/core-js/modules/web.dom-collections.iterator.js"),s("../node_modules/react/index.js")),n=s("../node_modules/lodash/cloneDeep.js"),o=s.n(n),a=s("../node_modules/lodash/isEqual.js"),l=s.n(a),d=s("../node_modules/lodash/omit.js"),u=s.n(d),c=s("../node_modules/lodash/trimStart.js"),p=s.n(c),g=s("./app/actionCreators/indicator.tsx"),m=s("./app/components/charts/utils.tsx"),h=s("./app/components/organizations/pageFilters/parse.tsx"),v=s("./app/utils.tsx");const f=(e,t)=>{let{field:s,orgSlug:i,cursor:r,environment:n,groupBy:o,includeSeries:a,includeTotals:l,interval:d,limit:u,orderBy:c,project:p,query:g,includeAllArgs:f=!1,statsPeriodStart:y,statsPeriodEnd:b,...w}=t;const{start:x,end:Z,statsPeriod:R}=(0,h.fK)(w,{allowEmptyPeriod:!0}),j=Object.fromEntries(Object.entries({field:s.filter((e=>!!e)),cursor:r,end:Z,environment:n,groupBy:null==o?void 0:o.filter((e=>!!e)),includeSeries:a,includeTotals:l,interval:d||(0,m.ZS)({start:x,end:Z,period:R}),query:g||void 0,per_page:u,project:p,orderBy:c,start:x,statsPeriod:R,statsPeriodStart:y,statsPeriodEnd:b}).filter((e=>{let[,t]=e;return(0,v.ri)(t)&&""!==t}))),S=`/organizations/${i}/metrics/data/`;return e.requestPromise(S,{includeAllArgs:f,query:j})},y=(e,t)=>{let{field:s,orgSlug:i,cursor:r,environment:n,groupBy:o,interval:a,project:l,orderBy:d,query:u,includeAllArgs:c=!1,statsPeriodStart:p,statsPeriodEnd:g,limit:f,...y}=t;const{start:b,end:w,statsPeriod:x}=(0,h.fK)(y,{allowEmptyPeriod:!0}),Z=Object.fromEntries(Object.entries({field:s.filter((e=>!!e)),cursor:r,end:w,environment:n,groupBy:null==o?void 0:o.filter((e=>!!e)),interval:a||(0,m.ZS)({start:b,end:w,period:x}),orderBy:d,per_page:f,query:u||void 0,project:l,start:b,statsPeriod:x,statsPeriodStart:p,statsPeriodEnd:g}).filter((e=>{let[,t]=e;return(0,v.ri)(t)&&""!==t})));return e.requestPromise(`/organizations/${i}/sessions/`,{includeAllArgs:c,query:Z})};var b=s("./app/components/organizations/pageFilters/utils.tsx"),w=s("./app/locale.tsx"),x=s("./app/utils/discover/fields.tsx"),Z=s("./app/utils/discover/types.tsx"),R=s("./app/views/dashboardsV2/datasetConfig/base.tsx"),j=s("./app/views/dashboardsV2/types.tsx"),S=s("./app/views/dashboardsV2/utils.tsx"),_=s("./app/views/dashboardsV2/widgetBuilder/releaseWidget/fields.tsx");function E(e){var t;return null!==(t=_.wg[e])&&void 0!==t?t:e}function F(e){var t;return null!==(t=_.Mg[e])&&void 0!==t?t:e}function q(e,t,s){const i=e.map(x.hr),r=i.filter((e=>Object.values(_.Xg).includes(e))),n=[],o=p()(t,"-"),a=_.d2.includes(o)||s||"release"===o;return!o||a||e.includes(o)||n.includes(o)||n.push(o),s?(r.forEach((e=>{const t=e.match(_.$4);t&&("user"!==t[2]||i.includes("count_unique(user)")||(n.push("count_unique(user)"),i.push("count_unique(user)")),"session"!==t[2]||i.includes("sum(session)")||(n.push("sum(session)"),i.push("sum(session)")))})),{aggregates:i,derivedStatusFields:r,injectedFields:n}):{aggregates:i,derivedStatusFields:r,injectedFields:n}}class O extends r.Component{constructor(){super(...arguments),(0,i.Z)(this,"state",{loading:!0,queryFetchID:void 0,errorMessage:void 0,timeseriesResults:void 0,rawResults:void 0,tableResults:void 0,releases:void 0}),(0,i.Z)(this,"_isMounted",!1),(0,i.Z)(this,"config",(0,R.v)(j.l9.RELEASE))}componentDidMount(){this._isMounted=!0,this.requiresCustomReleaseSorting()?this.fetchReleasesAndData():this.fetchData()}componentDidUpdate(e){const{loading:t,rawResults:s}=this.state,{selection:i,widget:r,organization:n,limit:o,cursor:a}=this.props,d=["queries","title","id","layout","tempId","widgetType"],c=["name","fields","aggregates","columns"],p=r.queries.map((e=>e.name)),g=e.widget.queries.map((e=>e.name));!this.requiresCustomReleaseSorting()||l()(r.queries.map((e=>e.orderby)),e.widget.queries.map((e=>e.orderby)))&&(0,b.WO)(i,e.selection)&&l()(n,e.organization)?o===e.limit&&n.slug===e.organization.slug&&(0,b.WO)(i,e.selection)&&l()(u()(r,d),u()(e.widget,d))&&l()(r.queries.map((e=>u()(e,c))),e.widget.queries.map((e=>u()(e,c))))&&l()(r.queries.flatMap((e=>{var t;return null===(t=e.fields)||void 0===t?void 0:t.filter((e=>!!e))})),e.widget.queries.flatMap((e=>{var t;return null===(t=e.fields)||void 0===t?void 0:t.filter((e=>!!e))})))&&l()(r.queries.flatMap((e=>e.aggregates.filter((e=>!!e)))),e.widget.queries.flatMap((e=>e.aggregates.filter((e=>!!e)))))&&l()(r.queries.flatMap((e=>e.columns.filter((e=>!!e)))),e.widget.queries.flatMap((e=>e.columns.filter((e=>!!e)))))&&a===e.cursor?t||l()(p,g)||(null==s?void 0:s.length)!==r.queries.length||this.setState((e=>{var t;return{...e,timeseriesResults:null===(t=e.rawResults)||void 0===t?void 0:t.flatMap(((e,t)=>this.config.transformSeries(e,r.queries[t])))}})):this.fetchData():this.fetchReleasesAndData()}componentWillUnmount(){this._isMounted=!1}get limit(){const{limit:e}=this.props;switch(this.props.widget.displayType){case j.FO.TOP_N:return Z.hY;case j.FO.TABLE:return null!=e?e:j.$V;case j.FO.BIG_NUMBER:return 1;default:return null!=e?e:20}}requiresCustomReleaseSorting(){const{widget:e}=this.props,t=!e.queries[0].columns.includes("session.status"),s=p()(e.queries[0].orderby,"-");return t&&"release"===s}async fetchReleasesAndData(){const{selection:e,api:t,organization:s}=this.props,{environments:i,projects:r}=e;try{const e=await t.requestPromise(`/organizations/${s.slug}/releases/`,{method:"GET",data:{sort:"date",project:r,per_page:50,environments:i}});if(!this._isMounted)return;this.setState({releases:e})}catch(e){(0,g.Iw)(e.responseJSON?e.responseJSON.error:(0,w.t)("Error sorting by releases"))}this.fetchData()}fetchData(){const{selection:e,api:t,organization:s,widget:i,includeAllArgs:r,cursor:n,onDataFetched:a}=this.props;if(i.displayType===j.FO.WORLD_MAP)return void this.setState({errorMessage:(0,w.t)("World Map is not supported by metrics.")});const l=Symbol("queryFetchID");this.setState({loading:!0,errorMessage:void 0,timeseriesResults:[],rawResults:[],tableResults:[],queryFetchID:l});const{environments:d,projects:u,datetime:c}=e,{start:g,end:m,period:h}=c,v=[],b=i.queries[0].columns.includes("session.status"),x=i.queries[0].orderby.startsWith("-"),Z=p()(i.queries[0].orderby,"-"),R=_.d2.includes(Z)||b||"release"===Z,F=this.requiresCustomReleaseSorting(),{releases:O}=this.state,C=(0,S.s)(i,{start:g,end:m,period:h},F?"low":void 0);let M="";const T=[];if(F&&(O&&1===O.length&&(M+=`release:${O[0].version}`,T.push(O[0].version)),O&&O.length>1)){M+="release:["+O[0].version,T.push(O[0].version);for(let e=1;e<O.length;e++)M+=","+O[e].version,T.push(O[e].version);M+="]",x||T.reverse()}const{aggregates:D,injectedFields:A}=q(i.queries[0].aggregates,i.queries[0].orderby,b),k=i.queries[0].columns,z=i.displayType!==j.FO.TABLE?1:0,L=i.displayType===j.FO.TABLE||i.displayType===j.FO.BIG_NUMBER||k.length>0?1:0;i.queries.forEach((e=>{let i,o;b?(i={field:D.filter((e=>!Object.values(_.Xg).includes(e))),orgSlug:s.slug,end:m,environment:d,groupBy:k,limit:void 0,orderBy:"",interval:C,project:u,query:e.conditions,start:g,statsPeriod:h,includeAllArgs:r,cursor:n},o=y):(i={field:D.map(E),orgSlug:s.slug,end:m,environment:d,groupBy:k.map(E),limit:0===k.length?1:F?100:this.limit,orderBy:R?"":x?`-${E(Z)}`:E(Z),interval:C,project:u,query:e.conditions+(""===M?"":` ${M}`),start:g,statsPeriod:h,includeAllArgs:r,cursor:n,includeSeries:z,includeTotals:L},o=f,!Z||R||D.includes(Z)||k.includes(Z)||(i.field=[...i.field,E(Z)],A.includes(Z)||A.push(Z))),v.push(o(t,i))}));let $=0;v.forEach((async(e,t)=>{try{const s=await e;let r,n;if(Array.isArray(s)?(r=s[0],n=s[2]):r=s,!this._isMounted)return;this.setState((e=>{var s,d,u,c;if(e.queryFetchID!==l)return e;let p;if(T.length&&(r.groups.sort((function(e,t){const s=e.by.release,i=t.by.release;return T.indexOf(s)-T.indexOf(i)})),r.groups=r.groups.slice(0,this.limit)),L){var g,m,h;const s=this.config.transformTable(r,i.queries[0]);s.title=null!==(g=null===(m=i.queries[t])||void 0===m?void 0:m.name)&&void 0!==g?g:"",p=[...null!==(h=e.tableResults)&&void 0!==h?h:[],s]}else p=void 0;const v=[...null!==(s=e.timeseriesResults)&&void 0!==s?s:[]];if(z){const e=this.config.transformSeries(r,i.queries[t]);e.forEach(((s,i)=>{v[t*e.length+i]=s}))}var f,y;if(null==a||a({timeseriesResults:v,tableResults:p}),[j.FO.TABLE,j.FO.BIG_NUMBER].includes(i.displayType))return{...e,errorMessage:void 0,tableResults:p,pageLinks:null!==(f=null===(y=n)||void 0===y?void 0:y.getResponseHeader("link"))&&void 0!==f?f:void 0};const b=o()(null!==(d=e.rawResults)&&void 0!==d?d:[]);return b[t]=r,{...e,errorMessage:void 0,timeseriesResults:v,rawResults:b,pageLinks:null!==(u=null===(c=n)||void 0===c?void 0:c.getResponseHeader("link"))&&void 0!==u?u:void 0}}))}catch(e){var s;const t=(null==e||null===(s=e.responseJSON)||void 0===s?void 0:s.detail)||(0,w.t)("An unknown error occurred.");if(!this._isMounted)return;this.setState({errorMessage:t})}finally{if($++,!this._isMounted)return;this.setState((e=>e.queryFetchID!==l?e:{...e,loading:$!==v.length}))}}))}render(){const{children:e}=this.props,{loading:t,timeseriesResults:s,tableResults:i,errorMessage:r,pageLinks:n}=this.state;return e({loading:t,timeseriesResults:s,tableResults:i,errorMessage:r,pageLinks:n})}}O.displayName="ReleaseWidgetQueries";const C=O},"./app/views/dashboardsV2/widgetCard/widgetCardChartContainer.tsx":(e,t,s)=>{s.d(t,{b:()=>_,Z:()=>E});var i=s("../node_modules/@emotion/styled/base/dist/emotion-styled-base.browser.esm.js"),r=s("../node_modules/react/index.js"),n=s("../node_modules/react-router/es/index.js"),o=s("./app/components/charts/transparentLoadingMask.tsx"),a=s("./app/components/loadingIndicator.tsx"),l=s("./app/views/dashboardsV2/types.tsx"),d=s("./app/views/dashboardsV2/widgetCard/chart.tsx"),u=(s("../node_modules/core-js/modules/web.dom-collections.iterator.js"),s("./app/components/charts/errorPanel.tsx")),c=s("./app/components/charts/simpleTableChart.tsx"),p=s("./app/components/placeholder.tsx"),g=s("./app/icons/index.tsx"),m=s("./app/styles/space.tsx"),h=s("./app/utils.tsx"),v=s("./app/views/dashboardsV2/utils.tsx"),f=s("./app/views/dashboardsV2/datasetConfig/base.tsx"),y=s("./app/views/dashboardsV2/widgetBuilder/issueWidget/fields.tsx"),b=s("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");function w(e){var t;let{organization:s,selection:i,widget:r,errorMessage:n,loading:o,transformedResults:a,location:d}=e;const c=(0,f.v)(l.l9.ISSUE);if(n)return(0,b.tZ)(u.Z,{children:(0,b.tZ)(g.FC,{color:"gray500",size:"lg"})});if(o)return(0,b.tZ)(x,{height:"200px"});const p=r.queries[0],m=(0,h.ri)(p.fields)?p.fields:[...p.columns,...p.aggregates],w=null!==(t=p.fieldAliases)&&void 0!==t?t:[],R=(0,v.tT)(r.title,r.queries[0],i,r.displayType);return(0,b.tZ)(Z,{location:d,title:"",eventView:R,fields:m,fieldAliases:w,loading:o,metadata:y.$L,data:a,organization:s,getCustomFieldRenderer:c.getCustomFieldRenderer,fieldHeaderMap:c.fieldHeaderMap,stickyHeaders:!0})}w.displayName="IssueWidgetCard";const x=(0,i.Z)(p.Z,{target:"e11eoa721"})("background-color:",(e=>e.theme.surface200),";"),Z=(0,i.Z)(c.Z,{target:"e11eoa720"})("margin-top:",(0,m.Z)(1.5),";border-bottom-left-radius:",(e=>e.theme.borderRadius),";border-bottom-right-radius:",(e=>e.theme.borderRadius),";font-size:",(e=>e.theme.fontSizeMedium),";box-shadow:none;");var R=s("./app/views/dashboardsV2/widgetCard/issueWidgetQueries.tsx"),j=s("./app/views/dashboardsV2/widgetCard/releaseWidgetQueries.tsx"),S=s("./app/views/dashboardsV2/widgetCard/widgetQueries.tsx");function _(e){let{location:t,router:s,api:i,organization:n,selection:o,widget:a,isMobile:u,renderErrorMessage:c,tableItemLimit:p,windowWidth:g,onZoom:m,onLegendSelectChanged:h,legendOptions:v,expandNumbers:f,onDataFetched:y,showSlider:x,noPadding:Z,chartZoomOptions:_}=e;return a.widgetType===l.l9.ISSUE?(0,b.tZ)(R.Z,{api:i,organization:n,widget:a,selection:o,limit:p,onDataFetched:y,children:e=>{let{transformedResults:s,errorMessage:i,loading:l}=e;return(0,b.BX)(r.Fragment,{children:["function"==typeof c?c(i):null,(0,b.tZ)(q,{loading:l}),(0,b.tZ)(w,{transformedResults:s,loading:l,errorMessage:i,widget:a,organization:n,location:t,selection:o})]})}}):a.widgetType===l.l9.RELEASE?(0,b.tZ)(j.ZP,{api:i,organization:n,widget:a,selection:o,limit:null!==(E=a.limit)&&void 0!==E?E:p,onDataFetched:y,children:e=>{let{tableResults:i,timeseriesResults:l,errorMessage:p,loading:h}=e;return(0,b.BX)(r.Fragment,{children:["function"==typeof c?c(p):null,(0,b.tZ)(d.Z,{timeseriesResults:l,tableResults:i,errorMessage:p,loading:h,location:t,widget:a,selection:o,router:s,organization:n,isMobile:u,windowWidth:g,expandNumbers:f,onZoom:m,showSlider:x,noPadding:Z,chartZoomOptions:_})]})}}):(0,b.tZ)(S.ZP,{api:i,organization:n,widget:a,selection:o,limit:p,onDataFetched:y,children:e=>{let{tableResults:i,timeseriesResults:l,errorMessage:p,loading:y}=e;return(0,b.BX)(r.Fragment,{children:["function"==typeof c?c(p):null,(0,b.tZ)(d.Z,{timeseriesResults:l,tableResults:i,errorMessage:p,loading:y,location:t,widget:a,selection:o,router:s,organization:n,isMobile:u,windowWidth:g,onZoom:m,onLegendSelectChanged:h,legendOptions:v,expandNumbers:f,showSlider:x,noPadding:Z,chartZoomOptions:_})]})}});var E}_.displayName="WidgetCardChartContainer";const E=(0,n.withRouter)(_),F=(0,i.Z)((e=>(0,b.tZ)(o.Z,{...e,maskBackgroundColor:"transparent"})),{target:"e14ay5ol0"})({name:"1vcob1d",styles:"display:flex;justify-content:center;align-items:center"}),q=e=>{let{loading:t}=e;return t?(0,b.tZ)(F,{visible:t,children:(0,b.tZ)(a.Z,{mini:!0})}):null};q.displayName="LoadingScreen"},"./app/views/dashboardsV2/widgetCard/widgetQueries.tsx":(e,t,s)=>{s.d(t,{FN:()=>j,ZP:()=>E,vD:()=>S});var i=s("../node_modules/@babel/runtime/helpers/esm/defineProperty.js"),r=(s("../node_modules/core-js/modules/web.dom-collections.iterator.js"),s("../node_modules/core-js/modules/es.array.includes.js"),s("../node_modules/core-js/modules/es.error.cause.js"),s("../node_modules/react/index.js")),n=s("../node_modules/lodash/cloneDeep.js"),o=s.n(n),a=s("../node_modules/lodash/isEqual.js"),l=s.n(a),d=s("../node_modules/lodash/omit.js"),u=s.n(d),c=s("../node_modules/lodash/trimStart.js"),p=s.n(c),g=s("./app/actionCreators/events.tsx"),m=s("./app/components/charts/utils.tsx"),h=s("./app/components/organizations/pageFilters/utils.tsx"),v=s("./app/locale.tsx"),f=s("./app/utils/discover/fields.tsx"),y=s("./app/utils/discover/genericDiscoverQuery.tsx"),b=s("./app/utils/discover/types.tsx"),w=s("./app/views/dashboardsV2/datasetConfig/base.tsx"),x=s("./app/views/dashboardsV2/types.tsx"),Z=s("./app/views/dashboardsV2/utils.tsx"),R=s("./app/views/dashboardsV2/widgetCard/dashboardsMEPContext.tsx");function j(e,t){var s,i;return{seriesName:t,data:null!==(s=null==e||null===(i=e.data)||void 0===i?void 0:i.map((e=>{let[t,s]=e;return{name:1e3*t,value:s.reduce(((e,t)=>{let{count:s}=t;return e+s}),0)}})))&&void 0!==s?s:[]}}function S(e,t){const s=[];return Object.keys(e).forEach((i=>{Object.keys(u()(e[i],"order")).forEach((r=>{const n=`${i} : ${r}`,o=t?`${t} > ${n}`:n,a=e[i][r];s.push([e[i].order||0,j(a,o)])}))})),s}class _ extends r.Component{constructor(){super(...arguments),(0,i.Z)(this,"state",{loading:!0,queryFetchID:void 0,errorMessage:void 0,timeseriesResults:void 0,rawResults:void 0,tableResults:void 0,pageLinks:void 0}),(0,i.Z)(this,"context",void 0),(0,i.Z)(this,"config",(0,w.v)(x.l9.DISCOVER)),(0,i.Z)(this,"_isMounted",!1)}componentDidMount(){this._isMounted=!0,this.fetchData()}componentDidUpdate(e){var t;const{selection:s,widget:i,cursor:r,organization:n}=this.props,[o,a]=e.widget.queries.map((e=>(e.aggregates=e.aggregates.filter((e=>!!e)),e.columns=e.columns.filter((e=>!!e)),e))).reduce(((e,t)=>{let[s,i]=e,{name:r,...n}=t;return s.push(r),i.push(n),[s,i]}),[[],[]]),[d,u]=i.queries.map((e=>(e.aggregates=e.aggregates.filter((e=>!!e&&"equation|"!==e)),e.columns=e.columns.filter((e=>!!e&&"equation|"!==e)),e))).reduce(((e,t)=>{let[s,i]=e,{name:r,...n}=t;return s.push(r),i.push(n),[s,i]}),[[],[]]);i.limit===e.widget.limit&&l()(i.displayType,e.widget.displayType)&&l()(i.interval,e.widget.interval)&&l()(u,a)&&(0,h.WO)(s,e.selection)&&r===e.cursor?this.state.loading||l()(o,d)||(null===(t=this.state.rawResults)||void 0===t?void 0:t.length)!==i.queries.length||this.setState((e=>{const t=i.queries.reduce(((t,s,i)=>t.concat(this.config.transformSeries(e.rawResults[i],s,{organization:n}))),[]);return{...e,timeseriesResults:t}})):this.fetchData()}componentWillUnmount(){this._isMounted=!1}get isMEPEnabled(){return this.props.organization.features.includes("dashboards-mep")}fetchEventData(e){const{selection:t,api:s,organization:i,widget:r,limit:n,cursor:o,onDataFetched:a}=this.props,l=i.features.includes("discover-frontend-use-events-endpoint");let d=[];const u=r.queries.map((e=>{const a=(0,Z.tT)(r.title,e,t);let d="";const u={per_page:null!=n?n:x.$V,cursor:o,...(0,Z.Gl)(this.isMEPEnabled)};e.orderby&&(u.sort="string"==typeof e.orderby?[e.orderby]:e.orderby);const c=l?`/organizations/${i.slug}/events/`:`/organizations/${i.slug}/eventsv2/`;if("table"===r.displayType)d=c,u.referrer="api.dashboards.tablewidget";else if("big_number"===r.displayType)d=c,u.per_page=1,u.referrer="api.dashboards.bignumberwidget";else{if("world_map"!==r.displayType)throw Error("Expected widget displayType to be either big_number, table or world_map");d=`/organizations/${i.slug}/events-geo/`,delete u.per_page,u.referrer="api.dashboards.worldmapwidget"}return(0,y.AA)(s,d,{...a.generateQueryStringObject(),...u})}));let c,p=0;u.forEach((async(t,s)=>{try{var n,o,l;const[g,h,v]=await t;c=!1!==c&&(null===(n=g.meta)||void 0===n?void 0:n.isMetricsData);const f=this.config.transformTable(g,r.queries[0],{organization:i});if(f.title=null!==(o=null===(l=r.queries[s])||void 0===l?void 0:l.name)&&void 0!==o?o:"",d=[...d,f],!this._isMounted)return;const y=null==v?void 0:v.getResponseHeader("Link");null==a||a({tableResults:d,pageLinks:null!=y?y:void 0}),this.setState((t=>t.queryFetchID!==e?t:{...t,tableResults:d,pageLinks:y}))}catch(e){var g;const t=(null==e||null===(g=e.responseJSON)||void 0===g?void 0:g.detail)||(0,v.t)("An unknown error occurred.");this.setState({errorMessage:t})}finally{var m;if(p++,!this._isMounted)return;null===(m=this.context)||void 0===m||m.setIsMetricsData(c),this.setState((t=>t.queryFetchID!==e?t:{...t,loading:p!==u.length}))}}))}fetchTimeseriesData(e,t){const{selection:s,api:i,organization:r,widget:n,onDataFetched:a}=this.props;this.setState({timeseriesResults:[],rawResults:[]});const{environments:l,projects:d}=s,{start:u,end:c,period:h}=s.datetime,y=(0,Z.s)(n,{start:u,end:c,period:h}),w=n.queries.map((e=>{let s;var o;if("top_n"===n.displayType)s={organization:r,interval:y,start:u,end:c,project:d,environment:l,period:h,query:e.conditions,yAxis:e.aggregates[e.aggregates.length-1],includePrevious:!1,referrer:`api.dashboards.widget.${t}-chart`,partial:!0,topEvents:b.hY,field:[...e.columns,...e.aggregates],queryExtras:(0,Z.Gl)(this.isMEPEnabled)},e.orderby&&(s.orderby=e.orderby);else if(s={organization:r,interval:y,start:u,end:c,project:d,environment:l,period:h,query:e.conditions,yAxis:e.aggregates,orderby:e.orderby,includePrevious:!1,referrer:`api.dashboards.widget.${t}-chart`,partial:!0,queryExtras:(0,Z.Gl)(this.isMEPEnabled)},r.features.includes("new-widget-builder-experience-design")&&[x.FO.AREA,x.FO.BAR,x.FO.LINE].includes(t)&&0!==(null===(o=e.columns)||void 0===o?void 0:o.length)){var a;s.topEvents=null!==(a=n.limit)&&void 0!==a?a:b.hY,s.field=[...e.columns,...e.aggregates];const t=p()(e.orderby,"-");if(!e.orderby||(0,f.uI)(t)||s.field.includes(t)||s.field.push(t),s.excludeOther=1!==e.aggregates.length||1!==n.queries.length,(0,f.GO)(p()(e.orderby,"-"))){const t=(0,Z.yd)(e.aggregates),i=e.orderby.startsWith("-")?"-":"";s.orderby=`${i}equation[${t}]`,s.field=[...e.columns,...e.aggregates,p()(e.orderby,"-")]}}return(0,g.lI)(i,s)}));let R,j=0;w.forEach((async(t,s)=>{try{const i=await t;if(!this._isMounted)return;R=!1!==R&&function(e){const t=Object.values(e).map((e=>{let{isMetricsData:t}=e;return t})).reduce(((e,t)=>!1!==e&&t),void 0);return(0,m.Xe)(e)?t:e.isMetricsData}(i),this.setState((t=>{var l,d;if(t.queryFetchID!==e)return t;const u=[...null!==(l=t.timeseriesResults)&&void 0!==l?l:[]],c=this.config.transformSeries(i,n.queries[s],{organization:r});c.forEach(((e,t)=>{u[s*c.length+t]=e}));const p=o()(null!==(d=t.rawResults)&&void 0!==d?d:[]);return p[s]=i,null==a||a({timeseriesResults:u}),{...t,timeseriesResults:u,rawResults:p}}))}catch(e){var i;const t=(null==e||null===(i=e.responseJSON)||void 0===i?void 0:i.detail)||(0,v.t)("An unknown error occurred.");this.setState({errorMessage:t})}finally{var l;if(j++,!this._isMounted)return;null===(l=this.context)||void 0===l||l.setIsMetricsData(R),this.setState((t=>t.queryFetchID!==e?t:{...t,loading:j!==w.length}))}}))}fetchData(){const{widget:e}=this.props,t=Symbol("queryFetchID");this.setState({loading:!0,errorMessage:void 0,queryFetchID:t}),["table","world_map","big_number"].includes(e.displayType)?this.fetchEventData(t):this.fetchTimeseriesData(t,e.displayType)}render(){const{children:e}=this.props,{loading:t,timeseriesResults:s,tableResults:i,errorMessage:r,pageLinks:n}=this.state;return e({loading:t,timeseriesResults:null==s?void 0:s.filter((e=>!!e)),tableResults:i,errorMessage:r,pageLinks:n})}}_.displayName="WidgetQueries",(0,i.Z)(_,"contextType",R.HH);const E=_}}]);
//# sourceMappingURL=../sourcemaps/app_components_modals_widgetViewerModal_utils_tsx-app_views_dashboardsV2_widgetCard_widgetCar-7a3063.493e9d70a44a6b113850201918ac6d5c.js.map