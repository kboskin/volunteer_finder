"use strict";(globalThis.webpackChunk=globalThis.webpackChunk||[]).push([["app_views_alerts_rules_metric_details_index_tsx"],{"./app/components/alertBadge.tsx":(e,t,r)=>{r.d(t,{Z:()=>u});var s=r("../node_modules/@emotion/styled/base/dist/emotion-styled-base.browser.esm.js"),a=r("./app/icons/index.tsx"),n=r("./app/locale.tsx"),i=r("./app/styles/space.tsx"),o=r("./app/views/alerts/types.tsx"),l=r("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");function d(e){let{status:t,hideText:r=!1,isIssue:s}=e,i=(0,n.t)("Resolved"),d=a.DL,u="green300";return s?(i=(0,n.t)("Issue"),d=a.XI,u="gray300"):t===o.vt.CRITICAL?(i=(0,n.t)("Critical"),d=a.zC,u="red300"):t===o.vt.WARNING&&(i=(0,n.t)("Warning"),d=a.qV,u="yellow300"),(0,l.BX)(c,{"data-test-id":"alert-badge",children:[(0,l.BX)(p,{color:u,icon:d,children:[(0,l.tZ)(m,{color:u}),(0,l.tZ)(d,{color:"white"})]}),!r&&(0,l.tZ)(h,{color:u,children:i})]})}d.displayName="AlertBadge";const u=d,c=(0,s.Z)("div",{target:"ef4c9wd3"})({name:"s5xdrg",styles:"display:flex;align-items:center"}),p=(0,s.Z)("div",{target:"ef4c9wd2"})("width:36px;height:36px;position:relative;svg:last-child{width:",(e=>e.icon===a.XI?"13px":"16px"),";z-index:2;position:absolute;top:0;bottom:0;left:0;right:0;margin:auto;}"),m=(0,s.Z)(a.Sq,{target:"ef4c9wd1"})({name:"bgbjt4",styles:"width:36px;height:36px"}),h=(0,s.Z)("div",{target:"ef4c9wd0"})("margin-left:",(0,i.Z)(1),";")},"./app/components/charts/components/markArea.tsx":(e,t,r)=>{function s(e){return{...e}}r.d(t,{Z:()=>s}),r("../node_modules/echarts/lib/component/markArea.js")},"./app/components/collapsePanel.tsx":(e,t,r)=>{r.d(t,{$:()=>u,Z:()=>p});var s=r("../node_modules/@emotion/styled/base/dist/emotion-styled-base.browser.esm.js"),a=(r("../node_modules/core-js/modules/web.dom-collections.iterator.js"),r("../node_modules/react/index.js")),n=r("../node_modules/@emotion/react/dist/emotion-react.browser.esm.js"),i=r("./app/icons/index.tsx"),o=r("./app/locale.tsx"),l=r("./app/styles/space.tsx"),d=r("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");const u=5;function c(e){let{items:t,buttonTitle:r="More",collapseCount:s=u,disableBorder:a=!0,onClick:n}=e;return(0,d.BX)(m,{onClick:n,role:"button","data-test-id":"collapse-show-more",disableBorder:a,children:[(0,d.BX)(g,{children:[(0,d.tZ)(h,{color:"gray300"}),(0,o._N)("Show [count] [buttonTitle]",{count:t-s,buttonTitle:r})]}),(0,d.tZ)(i.g6,{color:"gray300",direction:"down"})]})}c.displayName="ShowMoreButton";const p=function(e){let{items:t,children:r,buttonTitle:s,collapseCount:n=u,disableBorder:i=!0}=e;const[o,l]=(0,a.useState)(!1);return r({isExpanded:o,showMoreButton:o||t<=n?null:(0,d.tZ)(c,{items:t,buttonTitle:s,collapseCount:n,disableBorder:i,onClick:function(){l(!0)}})})},m=(0,s.Z)("div",{target:"e1dsvobb2"})("display:flex;align-items:center;padding:",(0,l.Z)(1)," ",(0,l.Z)(2),";font-size:",(e=>e.theme.fontSizeMedium),";color:",(e=>e.theme.subText),";cursor:pointer;border-top:1px solid ",(e=>e.theme.border),";",(e=>!e.disableBorder&&(0,n.iv)("border-left:1px solid ",e.theme.border,";border-right:1px solid ",e.theme.border,";border-bottom:1px solid ",e.theme.border,";border-bottom-left-radius:",e.theme.borderRadius,";border-bottom-right-radius:",e.theme.borderRadius,";margin-bottom:",(0,l.Z)(2),";","")),";"),h=(0,s.Z)(i.Zd,{target:"e1dsvobb1"})("margin-right:",(0,l.Z)(1),";"),g=(0,s.Z)("div",{target:"e1dsvobb0"})({name:"18keaja",styles:"display:flex;align-items:center;flex-grow:1"})},"./app/components/keyValueTable.tsx":(e,t,r)=>{r.d(t,{G:()=>l,v:()=>o});var s=r("../node_modules/@emotion/styled/base/dist/emotion-styled-base.browser.esm.js"),a=r("../node_modules/react/index.js"),n=r("./app/styles/space.tsx"),i=r("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");const o=(0,s.Z)("dl",{target:"e13z4zle2"})({name:"u4s7v9",styles:"display:grid;grid-template-columns:50% 50%"}),l=e=>{let{keyName:t,value:r}=e;return(0,i.BX)(a.Fragment,{children:[(0,i.tZ)(u,{children:t}),(0,i.tZ)(c,{children:r})]})};l.displayName="KeyValueTableRow";const d=e=>{let{theme:t}=e;return`\nfont-size: ${t.fontSizeMedium};\npadding: ${(0,n.Z)(.5)} ${(0,n.Z)(1)};\nfont-weight: normal;\nline-height: inherit;\n${e=>e.theme.overflowEllipsis};\n&:nth-of-type(2n-1) {\n  background-color: ${t.backgroundSecondary};\n}\n`},u=(0,s.Z)("dt",{target:"e13z4zle1"})(d,";color:",(e=>e.theme.textColor),";"),c=(0,s.Z)("dd",{target:"e13z4zle0"})(d,";color:",(e=>e.theme.subText),";text-align:right;")},"./app/components/pageTimeRangeSelector.tsx":(e,t,r)=>{r.d(t,{Z:()=>p});var s=r("../node_modules/@emotion/styled/base/dist/emotion-styled-base.browser.esm.js"),a=r("./app/components/organizations/timeRangeSelector/index.tsx"),n=r("./app/components/panels/index.tsx"),i=r("./app/locale.tsx"),o=r("./app/styles/space.tsx"),l=r("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");function d(e){let{className:t,...r}=e;return(0,l.tZ)(u,{className:t,children:(0,l.tZ)(a.Z,{label:(0,l.tZ)(c,{children:(0,i.t)("Date Range:")}),detached:!0,...r},`period:${r.relative}-start:${r.start}-end:${r.end}-utc:${r.utc}-defaultPeriod:${r.defaultPeriod}`)})}d.displayName="PageTimeRangeSelector";const u=(0,s.Z)(n.s_,{target:"e1hsuxgy1"})("padding:0;margin:0;display:flex;justify-content:center;align-items:center;height:42px;background:",(e=>e.theme.background),";border:1px solid ",(e=>e.theme.border),";border-radius:",(e=>e.theme.borderRadius),";font-size:",(e=>e.theme.fontSizeMedium),";color:",(e=>e.theme.textColor),";>div{width:100%;align-self:stretch;}>div>div:first-child>div{padding:0 ",(0,o.Z)(2),";}>div>div:last-child:not(:first-child){min-width:calc(100% + 2px);transform:translateX(-1px);right:auto;}"),c=(0,s.Z)("span",{target:"e1hsuxgy0"})("text-align:left;font-weight:600;color:",(e=>e.theme.textColor),";>span:last-child{font-weight:400;}"),p=d},"./app/utils/discover/charts.tsx":(e,t,r)=>{r.d(t,{CX:()=>o,gu:()=>l});var s=r("./app/locale.tsx"),a=r("./app/utils.tsx"),n=r("./app/utils/discover/fields.tsx"),i=r("./app/utils/formatters.tsx");function o(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";if(!(0,a.ri)(e))return"â€”";switch((0,n.Px)(t)){case"integer":case"number":return e.toLocaleString();case"percentage":return(0,i.rl)(e,2);case"duration":return(0,i.g9)(e/1e3,2,!0);default:return e.toString()}}function l(e,t){let r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];switch((0,n.Px)(t)){case"integer":case"number":return r?(0,i.Du)(e):e.toLocaleString();case"percentage":return(0,i.rl)(e,0);case"duration":return d(e);default:return e.toString()}}function d(e){if(0===e)return"0";if(e>=i.ps){const t=(e/i.ps).toFixed(0);return(0,s.t)("%swk",t)}if(e>=i.x4){const t=(e/i.x4).toFixed(0);return(0,s.t)("%sd",t)}if(e>=i.kr){const t=(e/i.kr).toFixed(0);return(0,s.t)("%shr",t)}if(e>=i.EB){const t=(e/i.EB).toFixed(0);return(0,s.t)("%smin",t)}if(e>=i.sh){const t=(e/i.sh).toFixed(0);return(0,s.t)("%ss",t)}const t=e.toFixed(0);return(0,s.t)("%sms",t)}},"./app/utils/discover/discoverQuery.tsx":(e,t,r)=>{r.d(t,{Z:()=>l});var s=r("./app/utils/withApi.tsx"),a=r("./app/utils/discover/genericDiscoverQuery.tsx"),n=r("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");function i(e,t){return e.transactionName!==t.transactionName||e.transactionThreshold!==t.transactionThreshold||e.transactionThresholdMetric!==t.transactionThresholdMetric}function o(e){const t=e.useEvents?"events":"eventsv2",r=e.useEvents?(e,t)=>{var r;const{fields:s,...a}=null!==(r=e.meta)&&void 0!==r?r:{};return{...e,meta:{...s,...a}}}:void 0;return(0,n.tZ)(a.ZP,{route:t,shouldRefetchData:i,afterFetch:r,...e})}o.displayName="DiscoverQuery";const l=(0,s.Z)(o)},"./app/utils/performance/urls.ts":(e,t,r)=>{r.d(t,{D:()=>n});var s=r("./app/components/events/interfaces/spans/utils.tsx"),a=r("./app/utils.tsx");function n(e,t,r,n,i){const o={...n||{},transaction:r};(0,a.ri)(o.transaction)||delete o.transaction;const l={pathname:`/organizations/${e}/performance/${t}/`,query:o,hash:(0,a.ri)(i)?(0,s.ct)(i):void 0};return(0,a.ri)(l.hash)||delete l.hash,l}},"./app/views/alerts/rules/metric/constants.tsx":(e,t,r)=>{r.d(t,{H9:()=>E,Hq:()=>A,KP:()=>S,Ng:()=>c,P1:()=>m,Q6:()=>w,Vr:()=>u,W7:()=>b,XU:()=>y,Yp:()=>Z,b1:()=>o,bp:()=>f,ep:()=>R,hh:()=>p,kV:()=>d,nM:()=>T,rQ:()=>x,wT:()=>l,yq:()=>h}),r("../node_modules/core-js/modules/web.dom-collections.iterator.js"),r("../node_modules/core-js/modules/es.array.includes.js");var s=r("./app/locale.tsx"),a=r("./app/utils/performance/vitals/constants.tsx"),n=r("./app/views/alerts/rules/metric/types.tsx"),i=r("./app/views/alerts/utils/index.tsx");const o=1,l=60,d=10080,u="count()",c="p95(transaction.duration)",p={[n.qz.ERRORS]:"event.type:error",[n.qz.TRANSACTIONS]:"event.type:transaction"},m={[n.Yh.ERROR_DEFAULT]:"event.type:[error, default]",[n.Yh.ERROR]:"event.type:error",[n.Yh.DEFAULT]:"event.type:default",[n.Yh.TRANSACTION]:"event.type:transaction"},h={aggregations:["count","count_unique"],fields:["user"]},g=["avg","percentile","p50","p75","p95","p99","p100"],v=[...g,"failure_rate","apdex","count"],f=["dataset","eventTypes","aggregate","query","timeWindow","thresholdPeriod","projects","environment","resolveThreshold","thresholdType","owner","name","projectId","comparisonDelta"],y=["alertThreshold","label"],x=["type","targetType","targetIdentifier","inputChannelId","options"],S=[{value:5,label:(0,s.t)("same time 5 minutes ago")},{value:15,label:(0,s.t)("same time 15 minutes ago")},{value:60,label:(0,s.t)("same time one hour ago")},{value:1440,label:(0,s.t)("same time one day ago")},{value:10080,label:(0,s.t)("same time one week ago")},{value:43200,label:(0,s.t)("same time one month ago")}];function T(e,t){return"custom"===e&&t===n.qz.ERRORS?h:{aggregations:"apdex"===e||"custom"===e?v:g,fields:["transaction.duration"],measurementKeys:Object.keys(a.r9)}}const Z={aggregations:v,fields:["transaction.duration"],measurementKeys:Object.keys(a.r9)};function b(e){return{label:e,alertThreshold:"",actions:[]}}function R(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return{dataset:n.qz.ERRORS,eventTypes:[n.GM.ERROR],aggregate:u,query:"",timeWindow:60,thresholdPeriod:1,triggers:[b(n.F4.CRITICAL),b(n.F4.WARNING)],projects:[],environment:null,resolveThreshold:"",thresholdType:n.lT.ABOVE,...e}}function E(e){var t;const r=(0,i.A4)(e.query),s=r?i.Ey[r.source]:i.Ey.error;let a=e.getYAxis();return"transactions"===s.dataset&&/^p\d{2,3}\(\)/.test(e.getYAxis())&&(a=e.getYAxis().slice(0,3)+"(transaction.duration)"),{...R(),...s,query:null!==(t=null==r?void 0:r.query)&&void 0!==t?t:e.query,aggregate:a,environment:e.environment.length?e.environment[0]:null}}function w(e){const{eventTypes:t,aggregate:r,dataset:s}=e,a={};return(0,i.Eb)(r)&&(a.thresholdType=n.lT.BELOW,a.timeWindow=n.Tb.ONE_HOUR),r.includes("apdex")&&(a.thresholdType=n.lT.BELOW),{...R(a),eventTypes:[t],aggregate:r,dataset:s}}function A(e,t){return(0,i.Eb)(e)||t===n.t6.CHANGE?"%":e.includes("measurements.cls")?"":e.includes("duration")||e.includes("measurements")?"ms":""}},"./app/views/alerts/rules/metric/details/constants.tsx":(e,t,r)=>{r.d(t,{N7:()=>i,U2:()=>u,UC:()=>d,e2:()=>l,ud:()=>n,v3:()=>o});var s=r("./app/locale.tsx"),a=r("./app/views/alerts/rules/metric/types.tsx");const n={[a.XH.SIX_HOURS]:(0,s.t)("Last 6 hours"),[a.XH.ONE_DAY]:(0,s.t)("Last 24 hours"),[a.XH.THREE_DAYS]:(0,s.t)("Last 3 days"),[a.XH.SEVEN_DAYS]:(0,s.t)("Last 7 days")},i="7d",o=[{label:(0,s.t)("Last 6 hours"),value:a.XH.SIX_HOURS},{label:(0,s.t)("Last 24 hours"),value:a.XH.ONE_DAY},{label:(0,s.t)("Last 3 days"),value:a.XH.THREE_DAYS},{label:(0,s.t)("Last 7 days"),value:a.XH.SEVEN_DAYS},{label:(0,s.t)("Last 14 days"),value:a.XH.FOURTEEN_DAYS}],l={[a.XH.SIX_HOURS]:6*a.Tb.ONE_HOUR*60*1e3,[a.XH.ONE_DAY]:60*a.Tb.ONE_DAY*1e3,[a.XH.THREE_DAYS]:3*a.Tb.ONE_DAY*60*1e3,[a.XH.SEVEN_DAYS]:7*a.Tb.ONE_DAY*60*1e3,[a.XH.FOURTEEN_DAYS]:14*a.Tb.ONE_DAY*60*1e3},d=(a.XH.FOURTEEN_DAYS,1e4),u=150},"./app/views/alerts/rules/metric/details/index.tsx":(e,t,r)=>{r.r(t),r.d(t,{default:()=>Yt});var s=r("../node_modules/@babel/runtime/helpers/esm/defineProperty.js"),a=(r("../node_modules/core-js/modules/web.dom-collections.iterator.js"),r("../node_modules/core-js/modules/es.array.includes.js"),r("../node_modules/react/index.js")),n=r("../node_modules/moment/moment.js"),i=r.n(n),o=r("./app/actionCreators/members.tsx"),l=r("./app/components/alert.tsx"),d=r("./app/components/dateTime.tsx"),u=r("./app/components/organizations/pageFilters/container.tsx"),c=r("./app/components/sentryDocumentTitle.tsx"),p=r("./app/locale.tsx"),m=r("./app/styles/organization.tsx"),h=r("./app/utils/analytics/trackAdvancedAnalyticsEvent.tsx"),g=r("./app/utils/dates.tsx"),v=r("./app/utils/withApi.tsx"),f=r("./app/utils/withProjects.tsx"),y=r("./app/views/alerts/rules/metric/details/constants.tsx"),x=r("./app/views/alerts/rules/metric/types.tsx"),S=r("./app/views/alerts/utils/apiCalls.tsx"),T=r("../node_modules/@emotion/styled/base/dist/emotion-styled-base.browser.esm.js"),Z=r("./app/components/charts/utils.tsx"),b=r("./app/components/duration.tsx"),R=r("./app/components/layouts/thirds.tsx"),E=r("./app/components/pageTimeRangeSelector.tsx"),w=r("./app/components/panels/index.tsx"),A=r("./app/components/placeholder.tsx"),N=r("./app/styles/space.tsx"),_=r("../node_modules/moment-timezone/index.js"),I=r.n(_),C=r("./app/components/collapsePanel.tsx"),O=r("./app/components/errorBoundary.tsx"),D=r("./app/components/links/link.tsx"),z=r("./app/components/panels/panelTable.tsx"),M=r("./app/components/tooltip.tsx"),j=r("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");function q(e){let{status:t,tooltipTitle:r}=e,s="error";return"muted"===t?s="muted":"info"===t?s="info":"warning"===t?s="warning":"success"!==t&&"resolved"!==t||(s="success"),(0,j.tZ)(M.Z,{title:r,skipWrapper:!0,children:(0,j.tZ)(F,{color:s})})}q.displayName="StatusIndicator";const L=q,F=(0,T.Z)("div",{target:"e1hixwjg0"})("position:absolute;left:-1px;width:9px;height:15px;border-radius:0 3px 3px 0;background-color:",(e=>e.theme.alert[e.color].background),";& span{display:block;width:9px;height:15px;}");var P=r("./app/utils/getDynamicText.tsx"),k=r("./app/views/alerts/types.tsx"),U=r("./app/views/alerts/utils/index.tsx"),B=r("./app/views/alerts/wizard/options.tsx"),H=r("./app/views/alerts/wizard/utils.tsx");function G(e){var t;let{organization:r,incident:s}=e;const a=(null!==(t=s.activities)&&void 0!==t?t:[]).filter((e=>e.type===k.lm.STATUS_CHANGE)),n=a.filter((e=>e.value===`${k.vt.CRITICAL}`)),i=a.filter((e=>e.value===`${k.vt.WARNING}`)),o=n.length?n[0]:i[0],l=(d=o.value)===`${k.vt.WARNING}`?(0,p.t)("Warning"):d===`${k.vt.CRITICAL}`?(0,p.t)("Critical"):"";var d;const u=a.find((e=>{let{previousValue:t}=e;return t===o.value})),c=(u?I()(u.dateCreated):I()()).diff(I()(o.dateCreated),"milliseconds"),m=null!==c&&(0,p._N)("[duration]",{duration:(0,j.tZ)(b.Z,{abbreviation:!0,seconds:c/1e3})}),h=s.alertRule.triggers.filter((e=>"warning"===e.label)).map((e=>e.alertThreshold)),g=s.alertRule.triggers.filter((e=>"critical"===e.label)).map((e=>e.alertThreshold));return(0,j.BX)(O.Z,{children:[(0,j.BX)(K,{"data-test-id":"alert-title",children:[(0,j.tZ)(L,{status:l.toLocaleLowerCase(),tooltipTitle:(0,p._N)("Status: [level]",{level:l})}),(0,j.tZ)(D.Z,{to:{pathname:(0,U.Gu)(r,s),query:{alert:s.identifier}},children:(0,p._N)("#[id]",{id:s.identifier})})]}),(0,j.tZ)(Q,{children:(0,p._N)("[title] [selector] [threshold]",{title:B.gb[(0,H.k)(s.alertRule)],selector:s.alertRule.thresholdType===x.lT.ABOVE?"above":"below",threshold:"Warning"===l?h:g})}),(0,j.tZ)(Q,{children:(0,P.Z)({value:m,fixed:"30s"})}),(0,j.tZ)(V,{date:(0,P.Z)({value:s.dateCreated,fixed:"Mar 4, 2022 10:44:13 AM UTC"})})]})}function W(e){let{organization:t,incidents:r}=e;const s=(null!=r?r:[]).length;return(0,j.tZ)(C.Z,{items:s,collapseCount:3,disableBorder:!1,buttonTitle:(0,p.tn)("Hidden Alert","Hidden Alerts",s-3),children:e=>{let{isExpanded:a,showMoreButton:n}=e;return(0,j.BX)("div",{children:[(0,j.tZ)(Y,{headers:[(0,p.t)("Alert"),(0,p.t)("Reason"),(0,p.t)("Duration"),(0,p.t)("Date Triggered")],isEmpty:!s,emptyMessage:(0,p.t)("No alerts triggered during this time."),expanded:s<=3||a,children:r&&r.map(((e,r)=>r>=3&&!a?null:(0,j.tZ)(G,{incident:e,organization:t},r)))}),n]})}})}G.displayName="MetricAlertActivity",W.displayName="MetricHistory";const X=W;var $={name:"ha13ji",styles:"margin-bottom:0px;border-bottom-left-radius:0px;border-bottom-right-radius:0px;border-bottom:none"};const Y=(0,T.Z)(z.Z,{target:"e1cnyss13"})("grid-template-columns:max-content 1fr repeat(2, max-content);&>div{padding:",(0,N.Z)(1)," ",(0,N.Z)(2),";}div:last-of-type{padding:",(e=>e.isEmpty&&`48px ${(0,N.Z)(1)}`),";}",(e=>!e.expanded&&$),";"),V=(0,T.Z)(d.Z,{target:"e1cnyss12"})("color:",(e=>e.theme.gray300),";font-size:",(e=>e.theme.fontSizeMedium),";display:flex;justify-content:flex-start;padding:",(0,N.Z)(1)," ",(0,N.Z)(2),"!important;"),K=(0,T.Z)("div",{target:"e1cnyss11"})("display:flex;align-items:center;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;width:100%;font-size:",(e=>e.theme.fontSizeMedium),";padding:",(0,N.Z)(1),";"),Q=(0,T.Z)("div",{target:"e1cnyss10"})("display:flex;align-items:center;white-space:nowrap;font-size:",(e=>e.theme.fontSizeMedium),";padding:",(0,N.Z)(1),";");var J=r("./app/views/alerts/rules/metric/utils/getEventTypeFilter.tsx"),ee=r("./app/views/alerts/rules/metric/utils/isCrashFreeAlert.tsx"),te=r("../node_modules/react-router/es/index.js"),re=r("../node_modules/color/index.js"),se=r.n(re),ae=r("../node_modules/lodash/capitalize.js"),ne=r.n(ae),ie=r("./app/components/acl/feature.tsx"),oe=r("./app/components/button.tsx"),le=r("./app/components/charts/areaChart.tsx"),de=r("./app/components/charts/chartZoom.tsx"),ue=r("./app/components/charts/components/markArea.tsx"),ce=r("./app/components/charts/components/markLine.tsx"),pe=r("./app/components/charts/eventsRequest.tsx"),me=r("./app/components/charts/series/lineSeries.tsx"),he=r("./app/components/charts/sessionsRequest.tsx"),ge=r("./app/components/charts/styles.tsx"),ve=r("./app/components/circleIndicator.tsx"),fe=r("./app/components/organizations/pageFilters/parse.tsx"),ye=r("./app/components/truncate.tsx"),xe=r("./app/icons/index.tsx"),Se=r("./app/stores/configStore.tsx"),Te=r("./app/utils/formatters.tsx"),Ze=r("./app/utils/sessions.tsx"),be=r("./app/utils/theme.tsx"),Re=r("./app/views/alerts/rules/metric/constants.tsx"),Ee=r("./app/utils/discover/types.tsx"),we=r("./app/utils/discover/eventView.tsx"),Ae=r("./app/utils/discover/fields.tsx");function Ne(e){var t;const{orgSlug:r,projects:s,rule:a,eventType:n,start:i,end:o,extraQueryParams:l,fields:d,environment:u}=e,c=n&&null!=a&&a.query?n:"";if(!s||!s.length||!a||!i&&!o)return"";const p=`${a.timeWindow}m`,m={id:void 0,name:a&&a.name||"",orderby:`-${(0,Ae.LY)(a.aggregate)}`,yAxis:a.aggregate?[a.aggregate]:void 0,query:null!==(t=c||(null==a?void 0:a.query)||n)&&void 0!==t?t:"",projects:s.filter((e=>{let{slug:t}=e;return a.projects.includes(t)})).map((e=>{let{id:t}=e;return Number(t)})),environment:u?[u]:void 0,version:2,fields:d||(a.dataset===x.qz.ERRORS?["issue","count()","count_unique(user)"]:["transaction",a.aggregate]),start:i,end:o,...l},h=we.ZP.fromSavedQuery(m),{query:g,...v}=h.getResultsViewUrlTarget(r);return{query:{...g,interval:p},...v}}function _e(e){let{orgSlug:t,projects:r,rule:s,eventType:a,start:n,end:i,fields:o}=e;if(!s)return{buttonText:(0,p.t)("Open in Discover"),to:""};const l={display:Ee.DC.TOP5};return{buttonText:(0,p.t)("Open in Discover"),to:Ne({orgSlug:t,projects:r,environment:s.environment,rule:s,eventType:a,start:n,end:i,extraQueryParams:l,fields:o})}}var Ie=r("./app/views/alerts/utils/getChangeStatus.tsx"),Ce=r("./app/constants/chartPalette.tsx");function Oe(e,t,r,s){return{seriesName:"",type:"line",markLine:(0,ce.Z)({silent:!0,lineStyle:{color:e,type:"solid",width:4},data:[[{coord:[t,s]},{coord:[r,s]}]]}),data:[]}}function De(e,t){return{seriesName:"Threshold Line",type:"line",markLine:(0,ce.Z)({silent:!0,lineStyle:{color:e,type:"dashed",width:1},data:[{yAxis:t}],label:{show:!1}}),data:[]}}function ze(e,t){const{options:{timezone:r}}=Se.Z.get("user");return I().tz(e,r).format(t)}function Me(e,t){const{dateModified:r}=e;if(!t.length||!t[0].data.length||!r)return[];const s=t[0].data,a=i()(s[0].name).valueOf(),n=i()(r).valueOf();return n<a?[]:[{type:"line",markLine:(0,ce.Z)({silent:!0,animation:!1,lineStyle:{color:be.ZP.gray200,type:"solid",width:1},data:[{xAxis:n}],label:{show:!1}}),markArea:(0,ue.Z)({silent:!0,itemStyle:{color:se()(be.ZP.gray100).alpha(.42).rgb().string()},data:[[{xAxis:a},{xAxis:n}]]}),data:[]}]}class je extends a.PureComponent{constructor(){super(...arguments),(0,s.Z)(this,"state",{width:-1,height:-1}),(0,s.Z)(this,"ref",null),(0,s.Z)(this,"updateDimensions",(()=>{var e,t;const r=null===(e=this.ref)||void 0===e||null===(t=e.getEchartsInstance)||void 0===t?void 0:t.call(e);if(!r)return;const s=r.getWidth(),a=r.getHeight();s===this.state.width&&a===this.state.height||this.setState({width:s,height:a})})),(0,s.Z)(this,"handleRef",(e=>{e&&!this.ref&&(this.ref=e,this.updateDimensions()),e||(this.ref=null)})),(0,s.Z)(this,"handleZoom",((e,t)=>{const{location:r}=this.props;te.browserHistory.push({pathname:r.pathname,query:{start:e,end:t}})}))}renderChartActions(e,t,r){const{rule:s,orgId:a,project:n,timePeriod:i,query:o}=this.props,l={orgSlug:a,projects:[n],rule:s,eventType:o,start:i.start,end:i.end,fields:"transactions"===s.dataset?["title","count()","count_unique(user)"]:["issue","title","count()","count_unique(user)"]},{buttonText:d,...u}=_e(l),c=100*Math.max(e-t-r,0)/e,m=100*Math.min(t/e,1),h=100*Math.min(r/e,1);return(0,j.BX)(Pe,{children:[(0,j.BX)(ke,{children:[(0,j.tZ)(ge.OT,{children:(0,p.t)("Summary")}),(0,j.BX)(Ge,{children:[(0,j.BX)(We,{children:[(0,j.tZ)(xe.DL,{color:"green300",isCircled:!0}),c?c.toFixed(2):0,"%"]}),(0,j.BX)(We,{children:[(0,j.tZ)(xe.FC,{color:"yellow300"}),h?h.toFixed(2):0,"%"]}),(0,j.BX)(We,{children:[(0,j.tZ)(xe.zC,{color:"red300"}),m?m.toFixed(2):0,"%"]})]})]}),!(0,U.Eb)(s.aggregate)&&(0,j.tZ)(ie.Z,{features:["discover-basic"],children:(0,j.tZ)(oe.ZP,{size:"small",...u,children:d})})]})}renderChart(e,t,r,s){var a;const{router:n,selectedIncident:o,interval:l,filter:d,incidents:u,rule:c,organization:m,timePeriod:{start:h,end:g}}=this.props,{width:v}=this.state,{dateModified:f,timeWindow:y}=c;if(e||!t)return this.renderEmpty();const{criticalDuration:S,warningDuration:T,totalDuration:Z,chartOption:b}=function(e){var t,r;let{timeseriesData:s,rule:a,incidents:n,selectedIncident:o,handleIncidentClick:l}=e;const d=a.triggers.find((e=>{let{label:t}=e;return t===x.F4.CRITICAL})),u=a.triggers.find((e=>{let{label:t}=e;return t===x.F4.WARNING})),c=[...s],m=[];c[0].z=1,c[0].color=Ce.Z[0][0];const h=s[0].data,g=h.reduce(((e,t)=>Math.max(e,t.value)),0),v=(0,U.QR)(a.aggregate)?Math.floor(Math.min(h.reduce(((e,t)=>Math.min(e,t.value)),1/0),"number"==typeof(null==u?void 0:u.alertThreshold)?u.alertThreshold:1/0,"number"==typeof(null==d?void 0:d.alertThreshold)?d.alertThreshold:1/0)/U.t3):0,f=i()(null===(t=h[0])||void 0===t?void 0:t.name).valueOf(),y=i()(null===(r=h[h.length-1])||void 0===r?void 0:r.name).valueOf(),S=y-f;let T=0,Z=0;if(c.push(Oe(be.Wb.green300,f,y,v)),n){const e=i().utc(f);n.filter((t=>!t.dateClosed||i()(t.dateClosed).isAfter(e))).forEach((e=>{var t,r;const s=null===(t=e.activities)||void 0===t?void 0:t.filter((e=>{let{type:t,value:r}=e;return t===k.lm.STATUS_CHANGE&&r&&[`${k.vt.WARNING}`,`${k.vt.CRITICAL}`].includes(r)})).sort(((e,t)=>i()(e.dateCreated).valueOf()-i()(t.dateCreated).valueOf())),n=null!==(r=e.dateClosed)&&void 0!==r?r:i()().valueOf(),d=60*a.timeWindow*1e3,g=u&&s&&!s.find((e=>{let{value:t}=e;return t===`${k.vt.CRITICAL}`}))?be.Wb.yellow300:be.Wb.red300,x=i()(e.dateStarted).valueOf(),S=e.dateClosed?i()(e.dateClosed).valueOf():y,b=h.find((e=>i()(e.name).valueOf()>=x));c.push(function(e,t,r,s,a,n,o){const l=t=>{let{value:r,marker:o}=t;const l=function(e,t){const{options:{timezone:r}}=Se.Z.get("user");return I().tz(e,r).format("MMM D, YYYY LT")}(i()(r));return['<div class="tooltip-series"><div>',`<span class="tooltip-label">${o} <strong>${(0,p.t)("Alert")} #${e.identifier}</strong></span>${null!=s&&s.value?`${a} ${(0,U.qn)(s.value,null!=a?a:"",null!=n?n:"")}`:""}`,"</div></div>",`<div class="tooltip-date">${l}</div>`,'<div class="tooltip-arrow"></div>'].join("")};return{seriesName:"Incident Line",type:"line",markLine:(0,ce.Z)({silent:!1,lineStyle:{color:t,type:"solid"},data:[{xAxis:r,onClick:()=>null==o?void 0:o(e)}],label:{silent:!0,show:!!e.identifier,position:"insideEndBottom",formatter:e.identifier,color:t,fontSize:10,fontFamily:"Rubik"},tooltip:{formatter:l}}),data:[],tooltip:{trigger:"item",alwaysShowContent:!0,formatter:l}}}(e,g,x,b,c[0].seriesName,a.aggregate,l));const R=Math.max(i()(e.dateStarted).valueOf(),f),E=Math.min(null!=s&&s.length&&s[0].dateCreated?i()(s[0].dateCreated).valueOf()-d:i()(n).valueOf(),y),w=u?be.Wb.yellow300:be.Wb.red300;if(E>R&&(c.push(Oe(w,R,E,v)),w===be.Wb.yellow300?Z+=Math.abs(E-R):T+=Math.abs(E-R)),null==s||s.forEach(((e,t)=>{const r=Math.max(i()(e.dateCreated).valueOf()-d,f),a=Math.min(t===s.length-1?i()(n).valueOf():i()(s[t+1].dateCreated).valueOf()-d,y),o=e.value===`${k.vt.CRITICAL}`?be.Wb.red300:be.Wb.yellow300;a>r&&(c.push(Oe(o,r,a,v)),o===be.Wb.yellow300?Z+=Math.abs(a-r):T+=Math.abs(a-r))})),o&&e.id===o.id){const e=g===be.Wb.yellow300?be.Wb.yellow100:be.Wb.red100;m.push({seriesName:"",type:"line",markArea:(0,ue.Z)({silent:!0,itemStyle:{color:se()(e).alpha(.42).rgb().string()},data:[[{xAxis:x},{xAxis:S}]]}),data:[]})}}))}let b=0;if(!a.comparisonDelta&&null!=u&&u.alertThreshold){const{alertThreshold:e}=u,t=De(be.Wb.yellow300,e);c.push(t),b=Math.max(b,e)}if(!a.comparisonDelta&&null!=d&&d.alertThreshold){const{alertThreshold:e}=d,t=De(be.Wb.red300,e);c.push(t),b=Math.max(b,e)}if(!a.comparisonDelta&&a.resolveThreshold){const e=De(be.Wb.green300,a.resolveThreshold);c.push(e),b=Math.max(b,a.resolveThreshold)}const R={axisLabel:{formatter:e=>(0,U.lR)(e,s[0].seriesName,a.aggregate)},max:(0,ee.I)(a.dataset)?100:b>g?b:void 0,min:v||void 0};return{criticalDuration:T,warningDuration:Z,totalDuration:S,chartOption:{isGroupedByDate:!0,yAxis:R,series:c,grid:{left:(0,N.Z)(.25),right:(0,N.Z)(2),top:(0,N.Z)(3),bottom:0}}}}({timeseriesData:t,rule:c,incidents:u,selectedIncident:o,handleIncidentClick:e=>{n.push({pathname:(0,U.Gu)(m,e),query:{alert:e.identifier}})}}),R=ne()((null===(a=Re.KP.find((e=>{let{value:t}=e;return t===c.comparisonDelta})))||void 0===a?void 0:a.label)||""),E=[...(s||[]).map((e=>{let{data:t,...r}=e;return(0,me.Z)({name:R,data:t.map((e=>{let{name:t,value:r}=e;return[t,r]})),lineStyle:{color:be.ZP.gray200,type:"dashed",width:1},itemStyle:{color:be.ZP.gray200},animation:!1,animationThreshold:1,animationDuration:0,...r})})),...Me(c,t)],w=(null==d?void 0:d.join(" "))+(0,p.t)(" over ")+(0,Te.g9)(60*c.timeWindow),_=(v>=1151?15:v<1151&&v>=700?14:v<700&&v>=515?13:v<515&&v>=300?12:8)/100*v;return(0,j.BX)(Le,{children:[(0,j.BX)(Xe,{withPadding:!0,children:[(0,j.tZ)(Fe,{children:(0,j.tZ)(ge.ws,{children:B.gb[(0,H.k)(c)]})}),(0,j.BX)(Be,{children:[(0,j.tZ)(Ue,{size:8}),(0,j.tZ)(He,{children:c.aggregate}),(0,j.tZ)(ye.Z,{value:null!=w?w:"",maxLength:_})]}),(0,P.Z)({value:(0,j.tZ)(de.Z,{router:n,start:h,end:g,onZoom:e=>this.handleZoom(e.start,e.end),onFinished:()=>{this.updateDimensions()},children:e=>(0,j.tZ)(le.T,{...e,...b,showTimeInTooltip:!0,minutesThresholdToDisplaySeconds:r,forwardedRef:this.handleRef,additionalSeries:E,tooltip:{formatter:e=>{var t;const r=Array.isArray(e)?e:[e],{marker:s,data:a,seriesName:n}=r[0],[o,d]=a,u=(0,U.qn)(d,null!=n?n:"",c.aggregate),m=f&&o<=new Date(f).getTime(),h=ze(i()(o),"MMM D LT"),{period:g,periodLength:v}=null!==(t=(0,fe.su)(l))&&void 0!==t?t:{periodLength:"m",period:`${y}`},S=ze(i()(o).add(parseInt(g,10),v),"MMM D LT"),T=r.length>1?r.find((e=>{let{seriesName:t}=e;return t===R})):void 0,Z=null==T?void 0:T.data[1],b=void 0!==Z?(0,U.qn)(Z,null!=n?n:"",c.aggregate):void 0,E=void 0===Z?NaN:100*(d-Z)/Z,w=(0,Ie.R)(E,c.thresholdType,c.triggers),A=w===x.F4.CRITICAL?be.ZP.red300:w===x.F4.WARNING?be.ZP.yellow300:be.ZP.green300;return['<div class="tooltip-series">',m&&`<div><span class="tooltip-label"><strong>${(0,p.t)("Alert Rule Modified")}</strong></span></div>`,`<div><span class="tooltip-label">${s} <strong>${n}</strong></span>${u}</div>`,T&&`<div><span class="tooltip-label">${T.marker} <strong>${R}</strong></span>${b}</div>`,"</div>",'<div class="tooltip-date">',`<span>${h} &mdash; ${S}</span>`,void 0!==Z&&Math.abs(E)!==1/0&&!isNaN(E)&&`<span style="color:${A};margin-left:10px;">${1===Math.sign(E)?"+":"-"}${Math.abs(E).toFixed(2)}%</span>`,"</div>",'<div class="tooltip-arrow"></div>'].filter((e=>e)).join("")}}})}),fixed:(0,j.tZ)(A.Z,{height:"200px",testId:"skeleton-ui"})})]}),this.renderChartActions(Z,S,T)]})}renderEmpty(){return(0,j.tZ)(Le,{children:(0,j.tZ)(w.N,{withPadding:!0,children:(0,j.tZ)(A.Z,{height:"200px"})})})}render(){const{api:e,rule:t,organization:r,timePeriod:s,project:a,interval:n,query:o}=this.props,{aggregate:l,timeWindow:d,environment:u,dataset:c}=t;s.usingPeriod&&s.period===x.XH.SEVEN_DAYS&&"1m"===n&&(s.start=(0,g.v5)(i()(i().utc(s.end).subtract(9995,"minutes"))));const p=(0,g.v5)(i().min(i().utc(s.start),i().utc(s.end).subtract(d,"minutes"))),m=(0,g.v5)(i().utc(s.end).add(d,"minutes"));return(0,ee.I)(c)?(0,j.tZ)(he.Z,{api:e,organization:r,project:a.id?[Number(a.id)]:[],environment:u?[u]:void 0,start:p,end:m,query:o,interval:n,field:U.Vc[l],groupBy:["session.status"],children:e=>{let{loading:r,response:s}=e;return this.renderChart(r,function(e,t){const{aggregate:r}=t;return[{seriesName:B.gb[(0,H.k)({aggregate:r,dataset:x.qz.SESSIONS})],data:(0,Ze.FS)(null==e?void 0:e.groups,null==e?void 0:e.intervals,U.Vc[r])}]}(s,t),Ze.VH)}}):(0,j.tZ)(pe.Z,{api:e,organization:r,query:o,environment:u?[u]:void 0,project:a.id?[Number(a.id)]:[],interval:n,comparisonDelta:t.comparisonDelta?60*t.comparisonDelta:void 0,start:p,end:m,yAxis:l,includePrevious:!1,currentSeriesNames:[l],partial:!1,referrer:"api.alerts.alert-rule-chart",children:e=>{let{loading:t,timeseriesData:r,comparisonTimeseriesData:s}=e;return this.renderChart(t,r,void 0,s)}})}}je.displayName="MetricChart";const qe=(0,te.withRouter)(je),Le=(0,T.Z)(w.s_,{target:"ezce5el9"})("margin-top:",(0,N.Z)(2),";"),Fe=(0,T.Z)("div",{target:"ezce5el8"})("margin-bottom:",(0,N.Z)(3),";"),Pe=(0,T.Z)(ge.xx,{target:"ezce5el7"})({name:"qgg235",styles:"display:flex;justify-content:space-between;flex-wrap:wrap"}),ke=(0,T.Z)(ge.m2,{target:"ezce5el6"})("grid-auto-flow:column;grid-column-gap:",(0,N.Z)(1),";"),Ue=(0,T.Z)(ve.Z,{target:"ezce5el5"})("background:",(e=>e.theme.formText),";height:",(0,N.Z)(1),";margin-right:",(0,N.Z)(.5),";"),Be=(0,T.Z)("div",{target:"ezce5el4"})("font-size:",(e=>e.theme.fontSizeSmall),";font-family:",(e=>e.theme.text.family),";color:",(e=>e.theme.textColor),";display:inline-grid;grid-template-columns:repeat(3, max-content);align-items:center;"),He=(0,T.Z)("span",{target:"ezce5el3"})("margin-right:",(0,N.Z)(1),";"),Ge=(0,T.Z)(ge.uN,{target:"ezce5el2"})("display:grid;grid-template-columns:repeat(3, auto);gap:",(0,N.Z)(1.5),";margin:0 0 0 ",(0,N.Z)(1.5),";"),We=(0,T.Z)("div",{target:"ezce5el1"})("display:grid;grid-template-columns:repeat(2, auto);gap:",(0,N.Z)(.5),";align-items:center;font-variant-numeric:tabular-nums;"),Xe=(0,T.Z)(w.N,{target:"ezce5el0"})({name:"sgs7ru",styles:"padding-right:6px"});var $e=r("./app/components/emptyStateWarning.tsx"),Ye=r("./app/components/issues/groupList.tsx"),Ve=r("./app/components/loadingError.tsx"),Ke=r("./app/views/alerts/rules/metric/details/relatedIssuesNotAvailable.tsx");function Qe(e){let{rule:t,organization:r,projects:s,query:n,timePeriod:i}=e;const{start:o,end:l}=i,d=`/organizations/${r.slug}/issues/`,u={start:o,end:l,groupStatsPeriod:"auto",limit:5,...t.environment?{environment:t.environment}:{},sort:"count_unique(user)"===t.aggregate?"user":"freq",query:n,project:s.map((e=>e.id))},c={pathname:`/organizations/${r.slug}/issues/`,query:u};return(0,j.BX)(a.Fragment,{children:[(0,j.BX)(et,{children:[(0,j.tZ)(Je,{children:(0,p.t)("Related Issues")}),(0,j.tZ)(oe.ZP,{"data-test-id":"issues-open",size:"xsmall",to:c,children:(0,p.t)("Open in Issues")})]}),(0,j.tZ)(tt,{children:(0,j.tZ)(Ye.Z,{orgId:r.slug,endpointPath:d,queryParams:u,query:`start=${o}&end=${l}&groupStatsPeriod=auto`,canSelectGroups:!1,renderEmptyMessage:function(){return(0,j.tZ)(w.s_,{children:(0,j.tZ)(w.N,{children:(0,j.tZ)($e.Z,{small:!0,withIcon:!1,children:(0,p.t)("No issues for this alert rule")})})})},renderErrorMessage:function(e,a){let{detail:o}=e;if(o===Ke.H&&!(0,U.Eb)(t.aggregate)){const e={orgSlug:r.slug,projects:s,rule:t,eventType:n,start:i.start,end:i.end},{buttonText:a,to:o}=_e(e);return(0,j.tZ)(Ke.z,{buttonTo:o,buttonText:a})}return(0,j.tZ)(Ve.Z,{onRetry:a})},withChart:!0,withPagination:!1,useFilteredStats:!0,customStatsPeriod:i,useTintRow:!1})})]})}Qe.displayName="RelatedIssues";const Je=(0,T.Z)(ge.OT,{target:"e8d5arw2"})({name:"s5xdrg",styles:"display:flex;align-items:center"}),et=(0,T.Z)("div",{target:"e8d5arw1"})("display:flex;align-items:center;justify-content:space-between;margin-bottom:",(0,N.Z)(1),";"),tt=(0,T.Z)("div",{target:"e8d5arw0"})("margin-bottom:",(0,N.Z)(4),";",w.s_,"{margin-bottom:-",(0,N.Z)(1),";}"),rt=Qe;var st=r("./app/components/gridEditable/index.tsx"),at=r("./app/utils/discover/discoverQuery.tsx"),nt=r("./app/utils/discover/fieldRenderers.tsx"),it=r("./app/views/performance/data.tsx"),ot=r("./app/views/performance/transactionSummary/utils.tsx");class lt extends a.Component{constructor(){super(...arguments),(0,s.Z)(this,"state",{widths:[]}),(0,s.Z)(this,"renderBodyCellWithData",(e=>(t,r)=>this.renderBodyCell(e,t,r))),(0,s.Z)(this,"renderHeadCellWithMeta",((e,t)=>{const r=["transactions","project",t,"users","user misery"];return(t,s)=>this.renderHeadCell(e,t,r[s])})),(0,s.Z)(this,"handleResizeColumn",((e,t)=>{const r=[...this.state.widths];r[e]=t.width?Number(t.width):st.z7,this.setState({widths:r})}))}renderBodyCell(e,t,r){const{eventView:s,organization:a,projects:n,location:i,summaryConditions:o}=this.props;if(!e||!e.meta)return r[t.key];const l=e.meta,d=String(t.key),u=(0,nt.Js)(d,l,!1)(r,{organization:a,location:i});if("transaction"===d){const e=function(e,t){const r=(null==e?void 0:e.project)||void 0;if(void 0===typeof r)return;const s=t.find((e=>e.slug===r));return s?s.id:void 0}(r,n),t=s.clone();t.query=o;const i=(0,ot.e1)({orgSlug:a.slug,transaction:String(r.transaction)||"",query:t.generateQueryStringObject(),projectID:e});return(0,j.tZ)(D.Z,{to:i,children:u})}return u}renderHeadCell(e,t,r){const s=(0,Ae.qG)(t.name,t.type,e),a={field:t.name,width:t.width};return(0,j.tZ)(ct,{align:s,children:r||a.field})}getSortedEventView(){const{eventView:e}=this.props;return e.withSorts([...e.sorts])}render(){const{eventView:e,organization:t,location:r}=this.props,{widths:s}=this.state,n=e.getColumns().map(((e,t)=>"number"==typeof s[t]?{...e,width:s[t]}:e)),i=this.getSortedEventView(),o=i.getSorts();return(0,j.tZ)(a.Fragment,{children:(0,j.tZ)(at.Z,{eventView:i,orgSlug:t.slug,location:r,useEvents:!0,children:e=>{let{isLoading:t,tableData:s}=e;return(0,j.tZ)(st.ZP,{isLoading:t,data:s?s.data.slice(0,5):[],columnOrder:n,columnSortBy:o,grid:{onResizeColumn:this.handleResizeColumn,renderHeadCell:this.renderHeadCellWithMeta(null==s?void 0:s.meta,n[2].name),renderBodyCell:this.renderBodyCellWithData(s)},location:r})}})})}}function dt(e){let{rule:t,projects:r,filter:s,location:a,organization:n,timePeriod:i}=e;const o=(0,Ae.LY)(t.aggregate),l=i.usingPeriod?{range:i.period}:{start:i.start,end:i.end};l.range&&l.range===x.XH.SEVEN_DAYS&&(l.range="7d");const d={id:void 0,name:"Transactions",fields:["transaction","project",`${t.aggregate}`,"count_unique(user)",`user_misery(${it.mW})`],orderby:`-${o}`,query:`${t.query}`,version:2,projects:r.map((e=>Number(e.id))),environment:t.environment?[t.environment]:void 0,...l},u=we.ZP.fromSavedQuery(d);return(0,j.tZ)(lt,{eventView:u,projects:r,organization:n,location:a,summaryConditions:`${t.query} ${s}`})}lt.displayName="Table",dt.displayName="RelatedTransactions";const ut=dt,ct=(0,T.Z)("div",{target:"eik8fiy0"})("display:block;width:100%;white-space:nowrap;",(e=>e.align?`text-align: ${e.align};`:""),";");var pt=r("./app/components/alertBadge.tsx"),mt=r("./app/components/avatar/actorAvatar.tsx"),ht=r("./app/components/keyValueTable.tsx"),gt=r("./app/components/timeSince.tsx");class vt extends a.PureComponent{getTimeWindow(){const{rule:e}=this.props;if(!e)return"";const{timeWindow:t}=e;return(0,p._N)("[window]",{window:(0,j.tZ)(b.Z,{seconds:60*t})})}renderTrigger(e,t,r){var s;const{rule:a}=this.props,n=e===x.F4.CRITICAL?(0,p.t)("Critical"):e===x.F4.WARNING?(0,p.t)("Warning"):(0,p.t)("Resolved"),i=e===x.F4.CRITICAL?"red300":e===x.F4.WARNING?"yellow300":"green300",o=(0,p.t)("Change alert status to %s",n),l=(e===x.F4.RESOLVE?a.thresholdType===x.lT.BELOW:a.thresholdType===x.lT.ABOVE)?a.comparisonDelta?(0,p.t)("higher"):(0,p.t)("above"):a.comparisonDelta?(0,p.t)("lower"):(0,p.t)("below"),d=a.comparisonDelta?(0,p._N)("[metric] is [threshold]% [comparisonType] in [timeWindow] compared to [comparisonDelta]",{metric:B.gb[(0,H.k)(a)],threshold:t,comparisonType:l,timeWindow:this.getTimeWindow(),comparisonDelta:(null!==(s=Re.KP.find((e=>{let{value:t}=e;return t===a.comparisonDelta})))&&void 0!==s?s:Re.KP[0]).label}):(0,p._N)("[metric] is [condition] in [timeWindow]",{metric:B.gb[(0,H.k)(a)],condition:`${l} ${t}`,timeWindow:this.getTimeWindow()});return(0,j.BX)(bt,{children:[(0,j.BX)(Rt,{children:[(0,j.tZ)(xe.Sq,{color:i,size:"xs"}),(0,j.tZ)(Et,{children:(0,p.t)("%s Conditions",n)})]}),(0,j.BX)(wt,{children:[(0,j.tZ)(Et,{children:"When"}),(0,j.tZ)(At,{children:(0,j.tZ)(Nt,{children:d})})]}),(0,j.BX)(wt,{children:[(0,j.tZ)(Et,{children:"Then"}),(0,j.BX)(At,{children:[r.map((e=>(0,j.tZ)(Nt,{children:e.desc},e.id))),(0,j.tZ)(Nt,{children:o})]})]})]})}render(){var e,t,r,s,n;const{rule:i}=this.props,o=i.latestIncident,l=o?o.status:k.vt.CLOSED,u=null!==(e=null!==(t=null==o?void 0:o.dateClosed)&&void 0!==t?t:null==o?void 0:o.dateStarted)&&void 0!==e?e:null,c=null==i?void 0:i.triggers.find((e=>{let{label:t}=e;return t===x.F4.CRITICAL})),m=null==i?void 0:i.triggers.find((e=>{let{label:t}=e;return t===x.F4.WARNING})),h=null===(r=i.owner)||void 0===r?void 0:r.split(":")[1],g=h&&{type:"team",id:h,name:""};return(0,j.BX)(a.Fragment,{children:[(0,j.BX)(St,{children:[(0,j.BX)(yt,{children:[(0,j.tZ)(Tt,{noMargin:!0,children:(0,p.t)("Alert Status")}),(0,j.tZ)(xt,{children:(0,j.tZ)(pt.Z,{status:l})})]}),(0,j.BX)(yt,{children:[(0,j.tZ)(Tt,{noMargin:!0,children:(0,p.t)("Last Triggered")}),(0,j.tZ)(xt,{children:u?(0,j.tZ)(gt.Z,{date:u}):(0,p.t)("No alerts triggered")})]})]}),(0,j.BX)(ft,{children:["number"==typeof(null==c?void 0:c.alertThreshold)&&this.renderTrigger(c.label,c.alertThreshold,c.actions),"number"==typeof(null==m?void 0:m.alertThreshold)&&this.renderTrigger(m.label,m.alertThreshold,m.actions),"number"==typeof i.resolveThreshold&&this.renderTrigger(x.F4.RESOLVE,i.resolveThreshold,[])]}),(0,j.BX)(ft,{children:[(0,j.tZ)(Tt,{children:(0,p.t)("Alert Rule Details")}),(0,j.BX)(ht.v,{children:[(0,j.tZ)(ht.G,{keyName:(0,p.t)("Environment"),value:(0,j.tZ)(Zt,{children:null!==(s=i.environment)&&void 0!==s?s:"-"})}),(0,j.tZ)(ht.G,{keyName:(0,p.t)("Date created"),value:(0,j.tZ)(d.Z,{date:(0,P.Z)({value:i.dateCreated,fixed:new Date("2021-04-20")}),format:"ll"})}),i.createdBy&&(0,j.tZ)(ht.G,{keyName:(0,p.t)("Created By"),value:(0,j.tZ)(Zt,{children:null!==(n=i.createdBy.name)&&void 0!==n?n:"-"})}),i.dateModified&&(0,j.tZ)(ht.G,{keyName:(0,p.t)("Last Modified"),value:(0,j.tZ)(gt.Z,{date:i.dateModified,suffix:(0,p.t)("ago")})}),(0,j.tZ)(ht.G,{keyName:(0,p.t)("Team"),value:g?(0,j.tZ)(mt.Z,{actor:g,size:24}):(0,p.t)("Unassigned")})]})]})]})}}vt.displayName="Sidebar";const ft=(0,T.Z)("div",{target:"ewgxzax11"})("margin-bottom:",(0,N.Z)(3),";"),yt=(0,T.Z)("div",{target:"ewgxzax10"})({name:"10sya4f",styles:"flex:1;display:flex;flex-direction:column;>*:nth-child(2){flex:1;display:flex;align-items:center;}"}),xt=(0,T.Z)("div",{target:"ewgxzax9"})("position:relative;display:grid;grid-template-columns:auto auto auto;gap:",(0,N.Z)(.5),";font-size:",(e=>e.theme.fontSizeLarge),";"),St=(0,T.Z)("div",{target:"ewgxzax8"})("height:60px;display:flex;margin-bottom:",(0,N.Z)(1),";"),Tt=(0,T.Z)(ge.OT,{target:"ewgxzax7"})("margin-top:",(e=>e.noMargin?0:(0,N.Z)(2)),";margin-bottom:",(e=>e.noMargin?0:(0,N.Z)(1)),";"),Zt=(0,T.Z)("div",{target:"ewgxzax6"})((e=>e.theme.overflowEllipsis),";"),bt=(0,T.Z)("div",{target:"ewgxzax5"})("display:grid;grid-template-rows:auto auto auto;gap:",(0,N.Z)(1),";margin-top:",(0,N.Z)(4),";"),Rt=(0,T.Z)("div",{target:"ewgxzax4"})({name:"z76o0d",styles:"display:grid;grid-template-columns:20px 1fr;align-items:center"}),Et=(0,T.Z)("h4",{target:"ewgxzax3"})("color:",(e=>e.theme.subText),";font-size:",(e=>e.theme.fontSizeMedium),";margin:0;line-height:24px;min-width:40px;"),wt=(0,T.Z)("div",{target:"ewgxzax2"})({name:"12nc7rf",styles:"display:grid;grid-template-columns:40px 1fr;align-items:flex-start"}),At=(0,T.Z)("div",{target:"ewgxzax1"})("display:grid;grid-template-columns:repeat(1fr);gap:",(0,N.Z)(.25),";"),Nt=(0,T.Z)("span",{target:"ewgxzax0"})("display:block;background-color:",(e=>e.theme.surface100),";padding:0 ",(0,N.Z)(.75),";border-radius:",(e=>e.theme.borderRadius),";color:",(e=>e.theme.textColor),";font-size:",(e=>e.theme.fontSizeSmall),";width:100%;font-weight:400;");class _t extends a.Component{constructor(){super(...arguments),(0,s.Z)(this,"handleTimePeriodChange",(e=>{const{start:t,end:r,relative:s}=e;return t&&r?this.props.router.push({...this.props.location,query:{start:i()(t).utc().format(),end:i()(r).utc().format()}}):this.props.router.push({...this.props.location,query:{period:s}})}))}getTimeWindow(){const{rule:e}=this.props;if(!e)return"";const{timeWindow:t}=e;return(0,p._N)("[window]",{window:(0,j.tZ)(b.Z,{seconds:60*t})})}getInterval(){const{timePeriod:{start:e,end:t},rule:r}=this.props,s=i().utc(e),a=i().utc(t),n=null==r?void 0:r.timeWindow,o=a.diff(s);return n&&(o<y.UC*n*60*1e3||o===y.e2[x.XH.SEVEN_DAYS])?`${n}m`:(0,Z.ZS)({start:e,end:t},"high")}getFilter(){const{rule:e}=this.props,{dataset:t,query:r}=null!=e?e:{};return e?[(0,ee.I)(t)?null:(0,J.r)(e),r].join(" ").split(" "):null}renderLoading(){return(0,j.BX)(R.uT,{children:[(0,j.BX)(R.or,{children:[(0,j.tZ)(A.Z,{height:"38px"}),(0,j.tZ)(zt,{children:(0,j.tZ)(w.N,{withPadding:!0,children:(0,j.tZ)(A.Z,{height:"200px"})})})]}),(0,j.tZ)(R.MF,{children:(0,j.tZ)(A.Z,{height:"200px"})})]})}render(){var e;const{api:t,project:r,rule:s,incidents:n,location:i,organization:o,timePeriod:l,selectedIncident:d,params:{orgId:u}}=this.props;if(!s||!r)return this.renderLoading();const{query:c,dataset:m}=s,h=`${c} ${(0,J.r)(s)}`.trim(),g={...y.ud,...s.timeWindow>1?{[x.XH.FOURTEEN_DAYS]:(0,p.t)("Last 14 days")}:{}};return(0,j.BX)(a.Fragment,{children:[d&&d.alertRule.status===k.Gb.SNAPSHOT&&(0,j.tZ)(Ct,{children:(0,j.tZ)(Ot,{type:"warning",showIcon:!0,children:(0,p.t)("Alert Rule settings have been updated since this alert was triggered.")})}),(0,j.BX)(R.uT,{children:[(0,j.BX)(R.or,{children:[(0,j.tZ)(Mt,{organization:o,relative:null!==(e=l.period)&&void 0!==e?e:"",start:l.custom&&l.start||null,end:l.custom&&l.end||null,utc:null,onUpdate:this.handleTimePeriodChange,relativeOptions:g,showAbsolute:!1}),(0,j.tZ)(qe,{api:t,rule:s,incidents:n,timePeriod:l,selectedIncident:d,organization:o,project:r,interval:this.getInterval(),query:(0,ee.I)(m)?c:h,filter:this.getFilter(),orgId:u}),(0,j.tZ)(It,{children:(0,j.BX)(Dt,{children:[(0,j.tZ)(X,{organization:o,incidents:n}),[x.qz.METRICS,x.qz.SESSIONS,x.qz.ERRORS].includes(m)&&(0,j.tZ)(rt,{organization:o,rule:s,projects:[r],timePeriod:l,query:m===x.qz.ERRORS?h:(0,ee.I)(m)?`${c} error.unhandled:true`:void 0}),m===x.qz.TRANSACTIONS&&(0,j.tZ)(ut,{organization:o,location:i,rule:s,projects:[r],timePeriod:l,filter:(0,J.r)(s)})]})})]}),(0,j.tZ)(R.MF,{children:(0,j.tZ)(vt,{rule:s})})]})]})}}_t.displayName="DetailsBody";const It=(0,T.Z)("div",{target:"e1avmeho5"})("display:flex;flex:1;@media (max-width: ",(e=>e.theme.breakpoints.small),"){flex-direction:column-reverse;}"),Ct=(0,T.Z)(R.uT,{target:"e1avmeho4"})("flex-grow:0;padding-bottom:0!important;@media (min-width: ",(e=>e.theme.breakpoints.medium),"){grid-template-columns:auto;}"),Ot=(0,T.Z)(l.Z,{target:"e1avmeho3"})({name:"ti75j2",styles:"margin:0"}),Dt=(0,T.Z)("div",{target:"e1avmeho2"})({name:"qu1srz",styles:"display:flex;flex:1;flex-direction:column;width:100%"}),zt=(0,T.Z)(w.s_,{target:"e1avmeho1"})("margin-top:",(0,N.Z)(2),";"),Mt=(0,T.Z)(E.Z,{target:"e1avmeho0"})("margin-bottom:",(0,N.Z)(2),";");var jt=r("../node_modules/@emotion/is-prop-valid/dist/is-prop-valid.browser.esm.js"),qt=r("./app/components/breadcrumbs.tsx"),Lt=r("./app/components/idBadge/index.tsx"),Ft=r("./app/components/pageHeading.tsx");function Pt(e){var t,r;let{hasMetricRuleDetailsError:s,rule:a,params:n,project:i}=e;const o=!!a&&!s,l=a&&!s?a.name:"",d=a&&`/organizations/${n.orgId}/alerts/${(0,U.Gm)(a)?"rules":"metric-rules"}/${null!==(t=null==i?void 0:i.slug)&&void 0!==t?t:null==a||null===(r=a.projects)||void 0===r?void 0:r[0]}/${a.id}/`;return(0,j.BX)(Ut,{children:[(0,j.BX)(Bt,{children:[(0,j.tZ)(Ht,{crumbs:[{label:(0,p.t)("Alerts"),to:`/organizations/${n.orgId}/alerts/rules/`},{label:l}]}),(0,j.tZ)(Gt,{children:(0,j.tZ)(oe.ZP,{icon:(0,j.tZ)(xe.yl,{}),to:d,children:(0,p.t)("Edit Rule")})})]}),(0,j.tZ)(Wt,{children:(0,j.BX)(Xt,{"data-test-id":"incident-rule-title",loading:!o,children:[i&&(0,j.tZ)(Lt.Z,{project:i,avatarSize:28,hideName:!0,avatarProps:{hasTooltip:!0,tooltip:i.slug}}),l]})})]})}Pt.displayName="DetailsHeader";const kt=Pt,Ut=(0,T.Z)("div",{target:"epymnhm5"})("background-color:",(e=>e.theme.backgroundSecondary),";border-bottom:1px solid ",(e=>e.theme.border),";"),Bt=(0,T.Z)("div",{target:"epymnhm4"})("display:flex;margin-bottom:0;padding:",(0,N.Z)(2)," ",(0,N.Z)(4)," ",(0,N.Z)(1),";"),Ht=(0,T.Z)(qt.Z,{target:"epymnhm3"})("flex-grow:1;font-size:",(e=>e.theme.fontSizeExtraLarge),";padding:0;"),Gt=(0,T.Z)("div",{target:"epymnhm2"})("display:grid;grid-auto-flow:column;gap:",(0,N.Z)(1),";"),Wt=(0,T.Z)(m.mr,{target:"epymnhm1"})("margin-bottom:0;padding:",(0,N.Z)(1.5)," ",(0,N.Z)(4)," ",(0,N.Z)(2),";grid-template-columns:max-content auto;display:grid;gap:",(0,N.Z)(3),";grid-auto-flow:column;@media (max-width: ",(e=>e.theme.breakpoints.medium),"){grid-template-columns:auto;grid-auto-flow:row;}"),Xt=(0,T.Z)(Ft.Z,{shouldForwardProp:e=>"string"==typeof e&&(0,jt.Z)(e)&&"loading"!==e,target:"epymnhm0"})((e=>e.loading&&"opacity: 0"),";line-height:1.5;display:grid;grid-template-columns:max-content 1fr;grid-column-gap:",(0,N.Z)(1),";align-items:center;");class $t extends a.Component{constructor(){super(...arguments),(0,s.Z)(this,"state",{isLoading:!1,hasError:!1,error:null,selectedIncident:null}),(0,s.Z)(this,"fetchData",(async()=>{var e;const{api:t,params:{orgId:r,ruleId:s},location:a}=this.props;this.setState({isLoading:!0,hasError:!1});const n=s===(null===(e=this.state.rule)||void 0===e?void 0:e.id)?Promise.resolve(this.state.rule):(0,S.dX)(r,s,{expand:"latestIncident"});let i=null;if(a.query.alert)try{i=await(0,S.yN)(t,r,a.query.alert)}catch{}const o=this.getTimePeriod(i),{start:l,end:d}=o;try{const[e,t]=await Promise.all([(0,S.hl)(r,s,l,d),n]);this.setState({incidents:e,rule:t,selectedIncident:i,isLoading:!1,hasError:!1})}catch(e){this.setState({selectedIncident:i,isLoading:!1,hasError:!0,error:e})}}))}componentDidMount(){const{api:e,params:t}=this.props;(0,o.MA)(e,t.orgId),this.fetchData(),this.trackView()}componentDidUpdate(e){e.location.search===this.props.location.search&&e.params.orgId===this.props.params.orgId&&e.params.ruleId===this.props.params.ruleId||(this.fetchData(),this.trackView())}trackView(){var e;const{params:t,organization:r,location:s}=this.props;(0,h.Z)("alert_rule_details.viewed",{organization:r,rule_id:parseInt(t.ruleId,10),alert:null!==(e=s.query.alert)&&void 0!==e?e:"",has_chartcuterie:r.features.includes("metric-alert-chartcuterie").toString()})}getTimePeriod(e){var t,r;const{location:s}=this.props,n=null!==(t=s.query.period)&&void 0!==t?t:x.XH.SEVEN_DAYS;if(s.query.start&&s.query.end)return{start:s.query.start,end:s.query.end,period:n,usingPeriod:!1,label:(0,p.t)("Custom time"),display:(0,j.BX)(a.Fragment,{children:[(0,j.tZ)(d.Z,{date:i().utc(s.query.start),timeAndDate:!0})," â€” ",(0,j.tZ)(d.Z,{date:i().utc(s.query.end),timeAndDate:!0})]}),custom:!0};if(s.query.alert&&e){const{start:t,end:r}=function(e){const t=60*e.alertRule.timeWindow*1e3,r=t*y.U2,s=t*y.UC,a=i().utc(),n=i().utc(e.dateStarted),o=e.dateClosed?i().utc(e.dateClosed):i()(a),l=Math.max(o.diff(n),3*t),d=Math.min(s,Math.max(r,l)),u=i().duration(d/2);return{start:(0,g.v5)(n.subtract(u)),end:(0,g.v5)(i().min(o.add(u),a))}}(e);return{start:t,end:r,period:n,usingPeriod:!1,label:(0,p.t)("Custom time"),display:(0,j.BX)(a.Fragment,{children:[(0,j.tZ)(d.Z,{date:i().utc(t),timeAndDate:!0})," â€” ",(0,j.tZ)(d.Z,{date:i().utc(r),timeAndDate:!0})]}),custom:!0}}const o=null!==(r=y.v3.find((e=>e.value===n)))&&void 0!==r?r:y.v3[1];return{start:(0,g.v5)(i()(i().utc().diff(y.e2[o.value]))),end:(0,g.v5)(i().utc()),period:n,usingPeriod:!0,label:o.label,display:o.label}}renderError(){const{error:e}=this.state;return(0,j.tZ)(m.JH,{children:(0,j.tZ)(l.Z,{type:"error",showIcon:!0,children:404===(null==e?void 0:e.status)?(0,p.t)("This alert rule could not be found."):(0,p.t)("An error occurred while fetching the alert rule.")})})}render(){var e,t;const{rule:r,incidents:s,hasError:a,selectedIncident:n}=this.state,{params:i,projects:o,loadingProjects:l}=this.props,d=this.getTimePeriod(n);if(a)return this.renderError();const m=o.find((e=>{let{slug:t}=e;return t===(null==r?void 0:r.projects[0])})),h=void 0!==m&&!l;return(0,j.BX)(u.Z,{skipLoadLastUsed:!0,skipInitializeUrlParams:!0,isGlobalSelectionReady:h,shouldForceProject:h,forceProject:m,forceEnvironment:null!==(e=null==r?void 0:r.environment)&&void 0!==e?e:"",lockedMessageSubject:(0,p.t)("alert rule"),showDateSelector:!1,hideGlobalHeader:!0,children:[(0,j.tZ)(c.Z,{title:null!==(t=null==r?void 0:r.name)&&void 0!==t?t:""}),(0,j.tZ)(kt,{hasMetricRuleDetailsError:a,params:i,rule:r,project:m}),(0,j.tZ)(_t,{...this.props,rule:r,project:m,incidents:s,timePeriod:d,selectedIncident:n})]})}}$t.displayName="MetricAlertDetails";const Yt=(0,v.Z)((0,f.Z)($t))},"./app/views/alerts/rules/metric/types.tsx":(e,t,r)=>{r.d(t,{F4:()=>n,GM:()=>l,LO:()=>h,Lm:()=>g,Tb:()=>p,Us:()=>m,XH:()=>c,Yh:()=>d,hd:()=>v,lK:()=>u,lT:()=>a,qz:()=>o,t6:()=>i});var s=r("./app/locale.tsx");let a,n,i,o,l,d,u,c,p,m;!function(e){e[e.ABOVE=0]="ABOVE",e[e.BELOW=1]="BELOW"}(a||(a={})),function(e){e.CRITICAL="critical",e.WARNING="warning",e.RESOLVE="resolve"}(n||(n={})),function(e){e.COUNT="count",e.CHANGE="change"}(i||(i={})),function(e){e.ERRORS="events",e.TRANSACTIONS="transactions",e.SESSIONS="sessions",e.METRICS="metrics"}(o||(o={})),function(e){e.DEFAULT="default",e.ERROR="error",e.TRANSACTION="transaction",e.USER="user",e.SESSION="session"}(l||(l={})),function(e){e.ERROR_DEFAULT="error_default",e.DEFAULT="default",e.ERROR="error",e.TRANSACTION="transaction"}(d||(d={})),function(e){e.CRASH_FREE_SESSIONS="percentage(sessions_crashed, sessions) AS _crash_rate_alert_aggregate",e.CRASH_FREE_USERS="percentage(users_crashed, users) AS _crash_rate_alert_aggregate"}(u||(u={})),function(e){e.SIX_HOURS="6h",e.ONE_DAY="1d",e.THREE_DAYS="3d",e.SEVEN_DAYS="10000m",e.FOURTEEN_DAYS="14d",e.THIRTY_DAYS="30d"}(c||(c={})),function(e){e[e.ONE_MINUTE=1]="ONE_MINUTE",e[e.FIVE_MINUTES=5]="FIVE_MINUTES",e[e.TEN_MINUTES=10]="TEN_MINUTES",e[e.FIFTEEN_MINUTES=15]="FIFTEEN_MINUTES",e[e.THIRTY_MINUTES=30]="THIRTY_MINUTES",e[e.ONE_HOUR=60]="ONE_HOUR",e[e.TWO_HOURS=120]="TWO_HOURS",e[e.FOUR_HOURS=240]="FOUR_HOURS",e[e.ONE_DAY=1440]="ONE_DAY"}(p||(p={})),function(e){e.EMAIL="email",e.SLACK="slack",e.PAGERDUTY="pagerduty",e.MSTEAMS="msteams",e.SENTRY_APP="sentry_app"}(m||(m={}));const h={[m.EMAIL]:(0,s.t)("Emaiâ€‹l"),[m.SLACK]:(0,s.t)("Slack"),[m.PAGERDUTY]:(0,s.t)("Pagerduty"),[m.MSTEAMS]:(0,s.t)("MS Teams"),[m.SENTRY_APP]:(0,s.t)("Notification")};let g;!function(e){e.SPECIFIC="specific",e.USER="user",e.TEAM="team",e.SENTRY_APP="sentry_app"}(g||(g={}));const v={[g.USER]:(0,s.t)("Member"),[g.TEAM]:(0,s.t)("Team")}},"./app/views/alerts/rules/metric/utils/getEventTypeFilter.tsx":(e,t,r)=>{r.d(t,{m:()=>o,r:()=>i});var s=r("./app/views/alerts/utils/index.tsx"),a=r("./app/views/alerts/rules/metric/constants.tsx"),n=r("./app/views/alerts/rules/metric/types.tsx");function i(e){const{dataset:t,eventTypes:r}=e;return o(t,r)}function o(e,t){var r;return t?a.P1[null!==(r=(0,s.KC)(e,t))&&void 0!==r?r:n.Yh.ERROR]:a.hh[null!=e?e:n.qz.ERRORS]}},"./app/views/alerts/rules/metric/utils/isCrashFreeAlert.tsx":(e,t,r)=>{r.d(t,{I:()=>a}),r("../node_modules/core-js/modules/es.array.includes.js");var s=r("./app/views/alerts/rules/metric/types.tsx");function a(e){return void 0!==e&&[s.qz.SESSIONS,s.qz.METRICS].includes(e)}},"./app/views/alerts/types.tsx":(e,t,r)=>{let s,a,n,i,o,l;r.d(t,{Gb:()=>o,XO:()=>l,lm:()=>a,ok:()=>s,vt:()=>n}),function(e){e.METRIC="metric",e.ISSUE="issue"}(s||(s={})),function(e){e[e.CREATED=0]="CREATED",e[e.DETECTED=1]="DETECTED",e[e.STATUS_CHANGE=2]="STATUS_CHANGE",e[e.COMMENT=3]="COMMENT",e[e.STARTED=4]="STARTED"}(a||(a={})),function(e){e[e.OPENED=1]="OPENED",e[e.CLOSED=2]="CLOSED",e[e.WARNING=10]="WARNING",e[e.CRITICAL=20]="CRITICAL"}(n||(n={})),function(e){e[e.MANUAL=1]="MANUAL",e[e.RULE_UPDATED=2]="RULE_UPDATED",e[e.RULE_TRIGGERED=3]="RULE_TRIGGERED"}(i||(i={})),function(e){e[e.PENDING=0]="PENDING",e[e.SNAPSHOT=4]="SNAPSHOT",e[e.DISABLED=5]="DISABLED"}(o||(o={})),function(e){e.METRIC="alert_rule",e.ISSUE="rule"}(l||(l={}))},"./app/views/alerts/utils/apiCalls.tsx":(e,t,r)=>{r.d(t,{dX:()=>a,hl:()=>n,yN:()=>i});const s=new(r("./app/api.tsx").KU);function a(e,t,r){return s.requestPromise(`/organizations/${e}/alert-rules/${t}/`,{query:r})}function n(e,t,r,a){return s.requestPromise(`/organizations/${e}/incidents/`,{query:{project:"-1",alertRule:t,includeSnapshots:!0,start:r,end:a,expand:["activities","seen_by","original_alert_rule"]}})}function i(e,t,r){return e.requestPromise(`/organizations/${t}/incidents/${r}/`)}},"./app/views/alerts/utils/getChangeStatus.tsx":(e,t,r)=>{r.d(t,{R:()=>a});var s=r("./app/views/alerts/rules/metric/types.tsx");const a=(e,t,r)=>{const a=null==r?void 0:r.find((e=>e.label===s.F4.CRITICAL)),n=null==r?void 0:r.find((e=>e.label===s.F4.WARNING)),i="number"==typeof(null==a?void 0:a.alertThreshold)?a.alertThreshold:void 0,o="number"==typeof(null==n?void 0:n.alertThreshold)?n.alertThreshold:void 0;return t===s.lT.ABOVE&&i&&e>=i?s.F4.CRITICAL:t===s.lT.ABOVE&&o&&e>=o?s.F4.WARNING:t===s.lT.BELOW&&i&&-1*e>=i?s.F4.CRITICAL:t===s.lT.BELOW&&o&&-1*e>=o?s.F4.WARNING:""}},"./app/views/alerts/utils/index.tsx":(e,t,r)=>{r.d(t,{A4:()=>f,CM:()=>h,Eb:()=>y,Eq:()=>p,Ey:()=>g,Gm:()=>m,Gu:()=>R,KC:()=>v,LI:()=>A,QR:()=>b,Vc:()=>x,g2:()=>E,lR:()=>S,qn:()=>T,t3:()=>Z}),r("../node_modules/core-js/modules/es.array.includes.js"),r("../node_modules/core-js/modules/es.string.replace.js");var s=r("../node_modules/lodash/round.js"),a=r.n(s),n=r("./app/locale.tsx"),i=r("./app/types/index.tsx"),o=r("./app/utils.tsx"),l=r("./app/utils/dates.tsx"),d=r("./app/utils/discover/charts.tsx"),u=r("./app/views/alerts/rules/metric/types.tsx"),c=r("./app/views/alerts/types.tsx");function p(e){return{start:(0,l.v5)(1e3*e.eventStats.data[0][0]),end:(0,l.v5)(1e3*e.eventStats.data[e.eventStats.data.length-1][0])}}function m(e){return!e.hasOwnProperty("triggers")}const h={[u.qz.ERRORS]:(0,n.t)("Errors"),[u.qz.TRANSACTIONS]:(0,n.t)("Transactions"),[u.Yh.ERROR_DEFAULT]:"event.type:error OR event.type:default",[u.Yh.ERROR]:"event.type:error",[u.Yh.DEFAULT]:"event.type:default",[u.Yh.TRANSACTION]:"event.type:transaction"},g={[u.Yh.ERROR_DEFAULT]:{dataset:u.qz.ERRORS,eventTypes:[u.GM.ERROR,u.GM.DEFAULT]},[u.Yh.ERROR]:{dataset:u.qz.ERRORS,eventTypes:[u.GM.ERROR]},[u.Yh.DEFAULT]:{dataset:u.qz.ERRORS,eventTypes:[u.GM.DEFAULT]},[u.Yh.TRANSACTION]:{dataset:u.qz.TRANSACTIONS,eventTypes:[u.GM.TRANSACTION]}};function v(e,t){return e===u.qz.TRANSACTIONS?u.Yh.TRANSACTION:t?t.includes(u.GM.DEFAULT)&&t.includes(u.GM.ERROR)?u.Yh.ERROR_DEFAULT:t.includes(u.GM.DEFAULT)?u.Yh.DEFAULT:u.Yh.ERROR:u.Yh.ERROR}function f(e){let t=e.match(/\(?\bevent\.type:(error|default|transaction)\)?\WOR\W\(?event\.type:(error|default|transaction)\)?/i);return t?"default,error"!==t.slice(1,3).sort().join(",")?null:{source:u.Yh.ERROR_DEFAULT,query:e.replace(t[0],"").trim()}:(t=e.match(/(^|\s)event\.type:(error|default|transaction)/i),t&&u.Yh[t[2].toUpperCase()]?{source:u.Yh[t[2].toUpperCase()],query:e.replace(t[0],"").trim()}:null)}function y(e){return Object.values(u.lK).includes(e)}const x={[u.lK.CRASH_FREE_SESSIONS]:i.kI.SESSIONS,[u.lK.CRASH_FREE_USERS]:i.kI.USERS};function S(e,t,r){return y(r)?(0,o.ri)(e)?`${a()(e,2)}%`:"â€•":(0,d.gu)(e,t)}function T(e,t,r){return y(r)?(0,o.ri)(e)?`${e}%`:"â€•":(0,d.CX)(e,t)}const Z=1.03;function b(e){return y(e)}function R(e,t){return`/organizations/${e.slug}/alerts/rules/details/${t.alertRule.status===c.Gb.SNAPSHOT&&t.alertRule.originalAlertRuleId?t.alertRule.originalAlertRuleId:t.alertRule.id}/`}function E(e){return Array.isArray(e)||""===e?"all":["open","closed"].includes(e)?e:"all"}const w=["myteams","unassigned"];function A(e){return void 0===e?w:""===e?[]:Array.isArray(e)?e:[e]}},"./app/views/alerts/wizard/options.tsx":(e,t,r)=>{r.d(t,{A_:()=>i,F4:()=>l,F7:()=>d,FZ:()=>o,LH:()=>u,gb:()=>n,mp:()=>c}),r("../node_modules/core-js/modules/web.dom-collections.iterator.js"),r("../node_modules/core-js/modules/es.array.includes.js");var s=r("./app/locale.tsx"),a=r("./app/views/alerts/rules/metric/types.tsx");const n={issues:(0,s.t)("Issues"),num_errors:(0,s.t)("Number of Errors"),users_experiencing_errors:(0,s.t)("Users Experiencing Errors"),throughput:(0,s.t)("Throughput"),trans_duration:(0,s.t)("Transaction Duration"),apdex:(0,s.t)("Apdex"),failure_rate:(0,s.t)("Failure Rate"),lcp:(0,s.t)("Largest Contentful Paint"),fid:(0,s.t)("First Input Delay"),cls:(0,s.t)("Cumulative Layout Shift"),custom:(0,s.t)("Custom Metric"),crash_free_sessions:(0,s.t)("Crash Free Session Rate"),crash_free_users:(0,s.t)("Crash Free User Rate")},i=e=>[{categoryHeading:(0,s.t)("Errors"),options:["issues","num_errors","users_experiencing_errors"]},...e.features.includes("crash-rate-alerts")?[{categoryHeading:(0,s.t)("Sessions"),options:["crash_free_sessions","crash_free_users"]}]:[],{categoryHeading:(0,s.t)("Performance"),options:["throughput","trans_duration","apdex","failure_rate","lcp","fid","cls"]},{categoryHeading:(0,s.t)("Other"),options:["custom"]}],o={num_errors:{aggregate:"count()",dataset:a.qz.ERRORS,eventTypes:a.GM.ERROR},users_experiencing_errors:{aggregate:"count_unique(user)",dataset:a.qz.ERRORS,eventTypes:a.GM.ERROR},throughput:{aggregate:"count()",dataset:a.qz.TRANSACTIONS,eventTypes:a.GM.TRANSACTION},trans_duration:{aggregate:"p95(transaction.duration)",dataset:a.qz.TRANSACTIONS,eventTypes:a.GM.TRANSACTION},apdex:{aggregate:"apdex(300)",dataset:a.qz.TRANSACTIONS,eventTypes:a.GM.TRANSACTION},failure_rate:{aggregate:"failure_rate()",dataset:a.qz.TRANSACTIONS,eventTypes:a.GM.TRANSACTION},lcp:{aggregate:"p95(measurements.lcp)",dataset:a.qz.TRANSACTIONS,eventTypes:a.GM.TRANSACTION},fid:{aggregate:"p95(measurements.fid)",dataset:a.qz.TRANSACTIONS,eventTypes:a.GM.TRANSACTION},cls:{aggregate:"p95(measurements.cls)",dataset:a.qz.TRANSACTIONS,eventTypes:a.GM.TRANSACTION},custom:{aggregate:"p95(measurements.fp)",dataset:a.qz.TRANSACTIONS,eventTypes:a.GM.TRANSACTION},crash_free_sessions:{aggregate:a.lK.CRASH_FREE_SESSIONS,dataset:a.qz.SESSIONS,eventTypes:a.GM.SESSION},crash_free_users:{aggregate:a.lK.CRASH_FREE_USERS,dataset:a.qz.SESSIONS,eventTypes:a.GM.USER}},l=o.num_errors,d=new Set(["num_errors","users_experiencing_errors","throughput","apdex","failure_rate","crash_free_sessions","crash_free_users"]),u=new Set(["trans_duration","lcp","fid","cls"]);function c(e){const t=(0,s.t)("over");return"apdex"===e?{labelText:(0,s.t)("Select apdex threshold and time interval"),timeWindowText:t}:d.has(e)?{labelText:(0,s.t)("Select time interval")}:{labelText:(0,s.t)("Select function and time interval"),timeWindowText:t}}},"./app/views/alerts/wizard/utils.tsx":(e,t,r)=>{r.d(t,{k:()=>n}),r("../node_modules/core-js/modules/web.dom-collections.iterator.js"),r("../node_modules/core-js/modules/es.array.includes.js");var s=r("./app/views/alerts/rules/metric/types.tsx");const a={[s.qz.ERRORS]:{num_errors:"count()",users_experiencing_errors:"count_unique(user)"},[s.qz.TRANSACTIONS]:{throughput:"count()",trans_duration:"transaction.duration",apdex:"apdex",failure_rate:"failure_rate()",lcp:"measurements.lcp",fid:"measurements.fid",cls:"measurements.cls"},[s.qz.SESSIONS]:{crash_free_sessions:s.lK.CRASH_FREE_SESSIONS,crash_free_users:s.lK.CRASH_FREE_USERS},[s.qz.METRICS]:{crash_free_sessions:s.lK.CRASH_FREE_SESSIONS,crash_free_users:s.lK.CRASH_FREE_USERS}};function n(e){let{aggregate:t,dataset:r}=e;const s=a[r],n=Object.entries(s).find((e=>{let[r,s]=e;return s&&t.includes(s)}));return n&&n[0]||"custom"}},"./app/views/performance/transactionSummary/utils.tsx":(e,t,r)=>{r.d(t,{K0:()=>d,PU:()=>c,Z6:()=>m,e1:()=>p,uI:()=>g,vd:()=>h,xf:()=>u});var s=r("../node_modules/@emotion/styled/base/dist/emotion-styled-base.browser.esm.js"),a=r("./app/styles/space.tsx"),n=r("./app/utils/discover/urls.tsx"),i=r("./app/utils/performance/urls.ts"),o=r("./app/utils/tokenizeSearch.tsx"),l=r("./app/views/performance/traceDetails/utils.tsx");let d;function u(e){const t=c(e);return t.removeFilter("transaction"),t}function c(e){const t=new o.MY(e);return t.removeFilter("event.type"),t}function p(e){let{orgSlug:t,transaction:r,projectID:s,query:a,unselectedSeries:n="p100()",display:i,trendFunction:o,trendColumn:l,showTransactions:d,additionalQuery:c}=e;const p=function(e){let{orgSlug:t}=e;return`/organizations/${t}/performance/summary/`}({orgSlug:t});let m;return m="string"==typeof a.query?u(a.query).formatString():a.query,{pathname:p,query:{transaction:r,project:s,environment:a.environment,statsPeriod:a.statsPeriod,start:a.start,end:a.end,query:m,unselectedSeries:n,showTransactions:d,display:i,trendFunction:o,trendColumn:l,...c}}}function m(e){return(t,r,s)=>{const a=`${r.trace}`;return a?(0,l.YA)(t,a,e,{}):{}}}function h(e){return(t,r,s,a)=>{const o=(0,n.JE)(r);return(0,i.D)(t.slug,o,e,s,a)}}!function(e){e.FASTEST="fastest",e.SLOW="slow",e.OUTLIER="outlier",e.RECENT="recent"}(d||(d={}));const g=(0,s.Z)("div",{target:"e1radvp0"})("margin-top:",(0,a.Z)(3),";")},"../node_modules/echarts/lib/component/markArea.js":(e,t,r)=>{var s=r("../node_modules/echarts/lib/extension.js"),a=r("../node_modules/echarts/lib/component/marker/checkMarkerInSeries.js"),n=r("../node_modules/echarts/node_modules/tslib/tslib.es6.js"),i=r("../node_modules/echarts/lib/component/marker/MarkerModel.js");const o=function(e){function t(){var r=null!==e&&e.apply(this,arguments)||this;return r.type=t.type,r}return(0,n.ZT)(t,e),t.prototype.createMarkerModelFromSeries=function(e,r,s){return new t(e,r,s)},t.type="markArea",t.defaultOption={z:1,tooltip:{trigger:"item"},animation:!1,label:{show:!0,position:"top"},itemStyle:{borderWidth:0},emphasis:{label:{show:!0,position:"top"}}},t}(i.Z);var l=r("../node_modules/zrender/lib/tool/color.js"),d=r("../node_modules/echarts/lib/data/SeriesData.js"),u=r("../node_modules/echarts/lib/util/number.js"),c=r("../node_modules/zrender/lib/graphic/Group.js"),p=r("../node_modules/zrender/lib/graphic/shape/Polygon.js"),m=r("../node_modules/echarts/lib/animation/basicTrasition.js"),h=r("../node_modules/echarts/lib/util/states.js"),g=r("../node_modules/echarts/lib/component/marker/markerHelper.js"),v=r("../node_modules/echarts/lib/component/marker/MarkerView.js"),f=r("../node_modules/zrender/lib/core/util.js"),y=r("../node_modules/echarts/lib/coord/CoordinateSystem.js"),x=r("../node_modules/echarts/lib/util/model.js"),S=r("../node_modules/echarts/lib/visual/helper.js"),T=r("../node_modules/echarts/lib/label/labelStyle.js"),Z=r("../node_modules/echarts/lib/util/innerStore.js"),b=r("../node_modules/echarts/lib/data/helper/dataValueHelper.js"),R=(0,x.Yf)(),E=function(e,t,r,s){var a=g.Z3(e,s[0]),n=g.Z3(e,s[1]),i=a.coord,o=n.coord;i[0]=(0,f.retrieve)(i[0],-1/0),i[1]=(0,f.retrieve)(i[1],-1/0),o[0]=(0,f.retrieve)(o[0],1/0),o[1]=(0,f.retrieve)(o[1],1/0);var l=(0,f.mergeAll)([{},a,n]);return l.coord=[a.coord,n.coord],l.x0=a.x,l.y0=a.y,l.x1=n.x,l.y1=n.y,l};function w(e){return!isNaN(e)&&!isFinite(e)}function A(e,t,r,s){var a=1-e;return w(t[a])&&w(r[a])}function N(e,t){var r=t.coord[0],s=t.coord[1],a={coord:r,x:t.x0,y:t.y0},n={coord:s,x:t.x1,y:t.y1};return(0,y.H)(e,"cartesian2d")?!(!r||!s||!A(1,r,s)&&!A(0,r,s))||g.i6(e,a,n):g.mQ(e,a)||g.mQ(e,n)}function _(e,t,r,s,a){var n,i=s.coordinateSystem,o=e.getItemModel(t),l=u.GM(o.get(r[0]),a.getWidth()),d=u.GM(o.get(r[1]),a.getHeight());if(isNaN(l)||isNaN(d)){if(s.getMarkerPosition)n=s.getMarkerPosition(e.getValues(r,t));else{var c=[h=e.get(r[0],t),g=e.get(r[1],t)];i.clampData&&i.clampData(c,c),n=i.dataToPoint(c,!0)}if((0,y.H)(i,"cartesian2d")){var p=i.getAxis("x"),m=i.getAxis("y"),h=e.get(r[0],t),g=e.get(r[1],t);w(h)?n[0]=p.toGlobalCoord(p.getExtent()["x0"===r[0]?0:1]):w(g)&&(n[1]=m.toGlobalCoord(m.getExtent()["y0"===r[1]?0:1]))}isNaN(l)||(n[0]=l),isNaN(d)||(n[1]=d)}else n=[l,d];return n}var I=[["x0","y0"],["x1","y0"],["x1","y1"],["x0","y1"]];const C=function(e){function t(){var r=null!==e&&e.apply(this,arguments)||this;return r.type=t.type,r}return(0,n.ZT)(t,e),t.prototype.updateTransform=function(e,t,r){t.eachSeries((function(e){var t=i.Z.getMarkerModelFromSeries(e,"markArea");if(t){var s=t.getData();s.each((function(t){var a=(0,f.map)(I,(function(a){return _(s,t,a,e,r)}));s.setItemLayout(t,a),s.getItemGraphicEl(t).setShape("points",a)}))}}),this)},t.prototype.renderSeries=function(e,t,r,s){var a=e.coordinateSystem,n=e.id,i=e.getData(),o=this.markerGroupMap,g=o.get(n)||o.set(n,{group:new c.Z});this.group.add(g.group),this.markKeep(g);var v=function(e,t,r){var s,a;if(e){var n=(0,f.map)(e&&e.dimensions,(function(e){var r=t.getData(),s=r.getDimensionInfo(r.mapDimension(e))||{};return(0,f.extend)((0,f.extend)({},s),{name:e,ordinalMeta:null})}));a=(0,f.map)(["x0","y0","x1","y1"],(function(e,t){return{name:e,type:n[t%2].type}})),s=new d.Z(a,r)}else a=[{name:"value",type:"float"}],s=new d.Z(a,r);var i=(0,f.map)(r.get("data"),(0,f.curry)(E,t,e,r));e&&(i=(0,f.filter)(i,(0,f.curry)(N,e)));var o=e?function(e,t,r,s){var n=e.coord[Math.floor(s/2)][s%2];return(0,b.yQ)(n,a[s])}:function(e,t,r,s){return(0,b.yQ)(e.value,a[s])};return s.initData(i,null,o),s.hasItemOption=!0,s}(a,e,t);t.setData(v),v.each((function(t){var r=(0,f.map)(I,(function(r){return _(v,t,r,e,s)})),n=a.getAxis("x").scale,o=a.getAxis("y").scale,d=n.getExtent(),c=o.getExtent(),p=[n.parse(v.get("x0",t)),n.parse(v.get("x1",t))],m=[o.parse(v.get("y0",t)),o.parse(v.get("y1",t))];u.dt(p),u.dt(m);var h=!!(d[0]>p[1]||d[1]<p[0]||c[0]>m[1]||c[1]<m[0]);v.setItemLayout(t,{points:r,allClipped:h});var g=v.getItemModel(t).getModel("itemStyle").getItemStyle(),y=(0,S.UL)(i,"color");g.fill||(g.fill=y,(0,f.isString)(g.fill)&&(g.fill=l.modifyAlpha(g.fill,.4))),g.stroke||(g.stroke=y),v.setItemVisual(t,"style",g)})),v.diff(R(g).data).add((function(e){var t=v.getItemLayout(e);if(!t.allClipped){var r=new p.Z({shape:{points:t.points}});v.setItemGraphicEl(e,r),g.group.add(r)}})).update((function(e,r){var s=R(g).data.getItemGraphicEl(r),a=v.getItemLayout(e);a.allClipped?s&&g.group.remove(s):(s?m.D(s,{shape:{points:a.points}},t,e):s=new p.Z({shape:{points:a.points}}),v.setItemGraphicEl(e,s),g.group.add(s))})).remove((function(e){var t=R(g).data.getItemGraphicEl(e);g.group.remove(t)})).execute(),v.eachItemGraphicEl((function(e,r){var s=v.getItemModel(r),a=v.getItemVisual(r,"style");e.useStyle(v.getItemVisual(r,"style")),(0,T.ni)(e,(0,T.k3)(s),{labelFetcher:t,labelDataIndex:r,defaultText:v.getName(r)||"",inheritColor:(0,f.isString)(a.fill)?l.modifyAlpha(a.fill,1):"#000"}),(0,h.WO)(e,s),(0,h.k5)(e,null,null,s.get(["emphasis","disabled"])),(0,Z.A)(e).dataModel=t})),R(g).data=v,g.group.silent=t.get("silent")||e.get("silent")},t.type="markArea",t}(v.Z);(0,s.D)((function(e){e.registerComponentModel(o),e.registerComponentView(C),e.registerPreprocessor((function(e){(0,a.Z)(e.series,"markArea")&&(e.markArea=e.markArea||{})}))}))}}]);
//# sourceMappingURL=../sourcemaps/app_views_alerts_rules_metric_details_index_tsx.6a800caf8fad2240cab919c50e6549dd.js.map