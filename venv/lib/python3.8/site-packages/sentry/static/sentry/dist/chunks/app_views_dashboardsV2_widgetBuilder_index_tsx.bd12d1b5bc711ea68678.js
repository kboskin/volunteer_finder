"use strict";(globalThis.webpackChunk=globalThis.webpackChunk||[]).push([["app_views_dashboardsV2_widgetBuilder_index_tsx"],{"./app/components/featureFeedback/index.tsx":(e,t,i)=>{i.d(t,{z:()=>d}),i("../node_modules/core-js/modules/web.dom-collections.iterator.js");var s=i("./app/actionCreators/modal.tsx"),r=i("./app/components/button.tsx"),a=i("./app/icons/index.tsx"),n=i("./app/locale.tsx"),o=i("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");function d(e){let{feedbackTypes:t,featureName:d,buttonProps:l={}}=e;return(0,o.tZ)(r.ZP,{icon:(0,o.tZ)(a.I8,{}),onClick:async function(){const e=await i.e("app_components_featureFeedback_feedbackModal_tsx").then(i.bind(i,"./app/components/featureFeedback/feedbackModal.tsx")),{FeedbackModal:r,modalCss:a}=e;(0,s.openModal)((e=>(0,o.tZ)(r,{...e,featureName:d,feedbackTypes:t})),{modalCss:a})},...l,children:(0,n.t)("Give Feedback")})}d.displayName="FeatureFeedback"},"./app/utils/usePrevious.tsx":(e,t,i)=>{i.d(t,{Z:()=>r});var s=i("../node_modules/react/index.js");const r=function(e){const t=(0,s.useRef)(e);return(0,s.useEffect)((()=>{t.current=e}),[e]),t.current}},"./app/views/dashboardsV2/widgetBuilder/buildSteps/filterResultsStep/issuesSearchBar.tsx":(e,t,i)=>{i.d(t,{i:()=>y});var s=i("../node_modules/@emotion/styled/base/dist/emotion-styled-base.browser.esm.js"),r=i("../node_modules/@emotion/react/dist/emotion-react.browser.esm.js"),a=i("./app/actionCreators/tags.tsx"),n=i("./app/locale.tsx"),o=i("./app/types/index.tsx"),d=i("./app/utils/dates.tsx"),l=i("./app/utils/useApi.tsx"),u=i("./app/utils/withIssueTags.tsx"),c=i("./app/views/dashboardsV2/widgetBuilder/utils.tsx"),p=i("./app/views/issueList/searchBar.tsx"),g=i("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");function m(e){let{tags:t,onSearch:i,onBlur:s,organization:u,query:p,selection:m,searchSource:y}=e;const f=(0,l.Z)();function b(e,t){const i=u.slug,s=m.projects.map((e=>e.toString())),r={start:(0,d.v5)(m.datetime.start),end:(0,d.v5)(m.datetime.end),statsPeriod:m.datetime.period};return(0,a.Fo)(f,i,e,t,s,r)}return(0,g.tZ)(r.ms,{children:e=>{let{css:r}=e;return(0,g.tZ)(h,{searchSource:y,organization:u,query:p.conditions||"",sort:"",onSearch:i,onBlur:s,excludeEnvironment:!0,supportedTags:t,placeholder:(0,n.t)("Search for issues, status, assigned, and more"),tagValueLoader:b,onSidebarToggle:()=>{},maxSearchItems:c.yM,savedSearchType:o.L4.ISSUE,dropdownClassName:r`
            max-height: ${c.CD}px;
            overflow-y: auto;
          `})}})}m.displayName="IssuesSearchBarContainer";const y=(0,u.Z)(m),h=(0,s.Z)(p.Z,{target:"ewve4jj0"})({name:"1hoyb5r",styles:"flex-grow:1;button:not([aria-label='Clear search']){display:none;}"})},"./app/views/dashboardsV2/widgetBuilder/index.tsx":(e,t,i)=>{i.r(t),i.d(t,{default:()=>Kt});var s=i("./app/components/acl/feature.tsx"),r=i("./app/components/alert.tsx"),a=i("./app/locale.tsx"),n=i("./app/styles/organization.tsx"),o=i("./app/utils/useOrganization.tsx"),d=i("../node_modules/@emotion/styled/base/dist/emotion-styled-base.browser.esm.js"),l=(i("../node_modules/core-js/modules/es.array.includes.js"),i("../node_modules/core-js/modules/web.dom-collections.iterator.js"),i("../node_modules/react/index.js")),u=i("../node_modules/lodash/cloneDeep.js"),c=i.n(u),p=i("../node_modules/lodash/isEmpty.js"),g=i.n(p),m=i("../node_modules/lodash/omit.js"),y=i.n(m),h=i("../node_modules/lodash/set.js"),f=i.n(h),b=i("../node_modules/lodash/trimStart.js"),v=i.n(b),w=i("./app/actionCreators/dashboards.tsx"),Z=i("./app/actionCreators/indicator.tsx"),S=i("./app/actionCreators/members.tsx"),T=i("./app/actionCreators/tags.tsx"),x=i("./app/components/dashboards/widgetQueriesForm.tsx"),E=i("./app/components/datePageFilter.tsx"),O=i("./app/components/environmentPageFilter.tsx"),q=i("./app/components/layouts/thirds.tsx"),C=i("./app/components/list/index.tsx"),B=i("./app/components/list/listItem.tsx"),F=i("./app/components/loadingError.tsx"),A=i("./app/components/organizations/pageFilterBar.tsx"),k=i("./app/components/organizations/pageFilters/container.tsx"),L=i("./app/components/projectPageFilter.tsx"),_=i("./app/components/sentryDocumentTitle.tsx"),N=i("./app/styles/space.tsx"),D=i("./app/types/index.tsx"),R=i("./app/utils.tsx"),I=i("./app/utils/analytics/trackAdvancedAnalyticsEvent.tsx"),z=i("./app/utils/discover/fields.tsx"),j=i("./app/utils/handleXhrErrorResponse.tsx"),V=i("./app/utils/useApi.tsx"),P=i("./app/utils/withPageFilters.tsx"),M=i("./app/utils/withTags.tsx"),U=i("./app/views/dashboardsV2/layoutUtils.tsx"),W=i("./app/views/dashboardsV2/types.tsx"),H=i("./app/views/dashboardsV2/data.tsx"),$=i("./app/views/dashboardsV2/datasetConfig/base.tsx"),X=i("./app/views/dashboardsV2/utils.tsx"),G=i("./app/components/links/externalLink.tsx"),Q=i("./app/views/dashboardsV2/widgetBuilder/utils.tsx"),Y=i("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");function J(e){let{title:t,description:i,required:s=!1,children:r}=e;return(0,Y.BX)(K,{children:[(0,Y.BX)(ee,{children:[t,s&&(0,Y.tZ)(se,{})]}),(0,Y.tZ)(te,{children:i}),(0,Y.tZ)(ie,{children:r})]})}J.displayName="BuildStep";const K=(0,d.Z)(B.Z,{target:"ecpormx4"})({name:"vetbs0",styles:"display:grid"}),ee=(0,d.Z)("h5",{target:"ecpormx3"})("margin-bottom:0;color:",(e=>e.theme.gray500),";"),te=(0,d.Z)("small",{target:"ecpormx2"})("color:",(e=>e.theme.gray300),";padding:",(0,N.Z)(.25)," ",(0,N.Z)(2)," ",(0,N.Z)(2)," 0;@media (max-width: ",(e=>e.theme.breakpoints.small),"){padding-top:",(0,N.Z)(1),";margin-left:-",(0,N.Z)(4),";}"),ie=(0,d.Z)("div",{target:"ecpormx1"})("display:grid;@media (max-width: ",(e=>e.theme.breakpoints.small),"){margin-left:-",(0,N.Z)(4),";}"),se=(0,d.Z)("div",{target:"ecpormx0"})("background:",(e=>e.theme.red300),";opacity:0.6;width:5px;height:5px;border-radius:5px;margin-left:",(0,N.Z)(.5),";display:inline-block;vertical-align:super;");var re=i("./app/components/forms/field/index.tsx"),ae=i("./app/views/eventsV2/table/columnEditCollection.tsx");function ne(e){var t;let{displayType:i,fieldOptions:s,widgetType:r,fields:a,organization:n,errors:o,onChange:d,filterAggregateParameters:l,filterPrimaryOptions:u,noFieldsMessage:c}=e;return(0,Y.tZ)(re.Z,{inline:!1,error:null==o||null===(t=o.find((e=>null==e?void 0:e.fields)))||void 0===t?void 0:t.fields,flexibleControlStateSize:!0,stacked:!0,children:i===W.FO.TABLE?(0,Y.tZ)(oe,{columns:a,onChange:d,fieldOptions:s,organization:n,source:r,showAliasField:n.features.includes("new-widget-builder-experience-design"),filterAggregateParameters:l,filterPrimaryOptions:u,noFieldsMessage:c}):(0,Y.tZ)(oe,{columns:a.slice(0,a.length-1),onChange:e=>{d([...e,a[a.length-1]])},fieldOptions:s,organization:n,source:r,filterPrimaryOptions:u,noFieldsMessage:c})})}ne.displayName="ColumnFields";const oe=(0,d.Z)(ae.Z,{target:"e2w4m990"})("margin-top:",(0,N.Z)(1),";");var de=i("./app/views/eventsV2/table/types.tsx");function le(e){let{displayType:t,organization:i,widgetType:s,explodedFields:r,queryErrors:a,onYAxisOrColumnFieldChange:n}=e;const o=(0,$.v)(W.l9.RELEASE);return(0,Y.tZ)(ne,{displayType:t,organization:i,widgetType:s,fields:r,errors:null!=a&&a[0]?[null==a?void 0:a[0]]:void 0,fieldOptions:o.getTableFieldOptions(),filterAggregateParameters:e=>e.value.kind===de.L.METRICS,filterPrimaryOptions:e=>(0,Q.wy)({option:e,widgetType:s,displayType:t}),onChange:n})}function ue(e){let{dataSet:t,displayType:i,onQueryChange:s,organization:r,queries:n,widgetType:o,onYAxisOrColumnFieldChange:d,queryErrors:l,explodedFields:u,tags:p}=e;const g=(0,$.v)(o);return(0,Y.tZ)(J,{title:(0,a.t)("Choose your columns"),description:t===Q.qg.ISSUES?(0,a._N)("[fieldTagLink: Field and tag] columns will help you view more details about the issues (e.g., title).",{fieldTagLink:(0,Y.tZ)(G.Z,{href:"https://docs.sentry.io/product/sentry-basics/search/searchable-properties/#event-properties"})}):t===Q.qg.RELEASES?(0,a._N)("To stack sessions, add [functionLink: functions] f(x) that may take in additional parameters. [fieldTagLink: Field and tag] columns will help you view more details about the sessions (e.g., releases).",{functionLink:(0,Y.tZ)(G.Z,{href:"https://docs.sentry.io/product/discover-queries/query-builder/#filter-by-table-columns"}),fieldTagLink:(0,Y.tZ)(G.Z,{href:"https://docs.sentry.io/product/sentry-basics/search/searchable-properties/#release-properties"})}):(0,a._N)("To stack events, add [functionLink: functions] f(x) that may take in additional parameters. [fieldTagLink: Field and tag] columns will help you view more details about the events (e.g., title).",{functionLink:(0,Y.tZ)(G.Z,{href:"https://docs.sentry.io/product/discover-queries/query-builder/#filter-by-table-columns"}),fieldTagLink:(0,Y.tZ)(G.Z,{href:"https://docs.sentry.io/product/sentry-basics/search/searchable-properties/#event-properties"})}),children:t===Q.qg.EVENTS?(0,Y.tZ)(ne,{displayType:i,organization:r,widgetType:o,fields:u,errors:l,fieldOptions:g.getTableFieldOptions({organization:r},p),onChange:d}):t===Q.qg.ISSUES?(0,Y.tZ)(ne,{displayType:i,organization:r,widgetType:o,fields:u,errors:null!=l&&l[0]?[null==l?void 0:l[0]]:void 0,fieldOptions:g.getTableFieldOptions({organization:r},p),onChange:e=>{const t=e.map(z.sN),i=(0,z.KZ)(e),r=c()(n[0]);r.fields=t,r.aggregates=i.aggregates,r.columns=i.columns,r.fieldAliases=i.fieldAliases,s(0,r)}}):(0,Y.tZ)(le,{displayType:i,organization:r,widgetType:o,explodedFields:u,queryErrors:l,onYAxisOrColumnFieldChange:d})})}le.displayName="ReleaseColumnFields",ue.displayName="ColumnsStep";var ce=i("./app/components/featureBadge.tsx"),pe=i("./app/components/forms/controls/radioGroup.tsx");const ge=[[Q.qg.EVENTS,(0,a.t)("Errors and Transactions")],[Q.qg.ISSUES,(0,a.t)("Issues (States, Assignment, Time, etc.)")]];function me(e){let{dataSet:t,onChange:i,hasReleaseHealthFeature:s,displayType:r}=e;const n=[];return r!==W.FO.TABLE&&(n.push([Q.qg.ISSUES,(0,a.t)("This dataset is restricted to tabular visualization.")]),r===W.FO.WORLD_MAP&&n.push([Q.qg.RELEASES,(0,a.t)("This dataset is restricted to big number, tabular and time series visualizations.")])),(0,Y.tZ)(J,{title:(0,a.t)("Choose your dataset"),description:(0,a._N)("This reflects the type of information you want to use. To learn more, [link: read the docs].",{link:(0,Y.tZ)(G.Z,{href:"https://docs.sentry.io/product/dashboards/custom-dashboards/#data-set-selection"})}),children:(0,Y.tZ)(ye,{label:"dataSet",value:t,choices:s?[...ge,[Q.qg.RELEASES,(0,Y.BX)(l.Fragment,{children:[(0,a.t)("Releases (sessions, crash rates)")," ",(0,Y.tZ)(ce.Z,{type:"beta"})]},"releases-dataset")]]:ge,disabledChoices:n,onChange:e=>{i(e)}})})}me.displayName="DataSetStep";const ye=(0,d.Z)(pe.Z,{target:"e1eujfdx0"})("display:flex;flex-wrap:wrap;gap:",(0,N.Z)(2),";");var he=i("./app/components/button.tsx"),fe=i("./app/components/forms/controls/input.tsx"),be=i("./app/icons/index.tsx"),ve=i("./app/components/events/searchBar.tsx"),we=i("./app/constants/index.tsx");function Ze(e){let{projectIds:t,onSearch:i,onBlur:s,organization:r,query:a}=e;return(0,Y.tZ)(Se,{searchSource:"widget_builder",organization:r,projectIds:t,query:a.conditions,fields:[],onSearch:i,onBlur:s,useFormWrapper:!1,maxQueryLength:we.dI,maxSearchItems:Q.yM,maxMenuHeight:Q.CD,savedSearchType:D.L4.EVENT})}Ze.displayName="EventsSearchBar";const Se=(0,d.Z)(ve.Z,{target:"e1pc9id60"})({name:"1ff36h2",styles:"flex-grow:1"});var Te=i("./app/views/dashboardsV2/widgetBuilder/buildSteps/filterResultsStep/issuesSearchBar.tsx"),xe=i("./app/views/dashboardsV2/widgetBuilder/buildSteps/filterResultsStep/releaseSearchBar.tsx");function Ee(e){let{canAddSearchConditions:t,queries:i,onQueryRemove:s,onAddSearchConditions:r,onQueryChange:n,organization:o,hideLegendAlias:d,projectIds:u,queryErrors:c,widgetType:p,selection:g}=e;const m=(0,l.useRef)(void 0);(0,l.useEffect)((()=>()=>{window.clearTimeout(m.current)}),[]);const y=(0,l.useCallback)((e=>t=>{window.clearTimeout(m.current),m.current=window.setTimeout((()=>{m.current=void 0}),200);const s={...i[e],conditions:t};n(e,s)}),[i]),h=(0,l.useCallback)((e=>t=>{if(!m.current){const s={...i[e],conditions:t};n(e,s)}}),[i]);return(0,Y.tZ)(J,{title:(0,a.t)("Filter your results"),description:t?(0,a.t)("This is how you filter down your search. You can add multiple queries to compare data for each overlay."):(0,a.t)("This is how you filter down your search."),children:(0,Y.BX)("div",{children:[i.map(((e,t)=>{var r;return(0,Y.tZ)(qe,{inline:!1,flexibleControlStateSize:!0,stacked:!0,error:null==c||null===(r=c[t])||void 0===r?void 0:r.conditions,children:(0,Y.BX)(Ce,{children:[p===W.l9.ISSUE?(0,Y.tZ)(Te.i,{searchSource:"widget_builder",organization:o,query:e,onBlur:h(t),onSearch:y(t),selection:g}):p===W.l9.DISCOVER?(0,Y.tZ)(Ze,{organization:o,query:e,projectIds:u,onBlur:h(t),onSearch:y(t)}):(0,Y.tZ)(xe.D,{orgSlug:o.slug,query:e,projectIds:u,onBlur:h(t),onSearch:y(t)}),!d&&(0,Y.tZ)(Oe,{type:"text",name:"name",value:e.name,placeholder:(0,a.t)("Legend Alias"),onChange:e=>{const s={...i[t],name:e.target.value};n(t,s)}}),i.length>1&&(0,Y.tZ)(he.ZP,{size:"zero",borderless:!0,onClick:()=>s(t),icon:(0,Y.tZ)(be.Fz,{}),title:(0,a.t)("Remove query"),"aria-label":(0,a.t)("Remove query")})]})},t)})),t&&(0,Y.tZ)(he.ZP,{size:"small",icon:(0,Y.tZ)(be.N_,{isCircled:!0}),onClick:r,children:(0,a.t)("Add Query")})]})})}Ee.displayName="FilterResultsStep";const Oe=(0,d.Z)(fe.Z,{target:"e12061i92"})({name:"1f6lq61",styles:"width:33%"}),qe=(0,d.Z)(re.Z,{target:"e12061i91"})("padding-bottom:",(0,N.Z)(1),";"),Ce=(0,d.Z)("div",{target:"e12061i90"})("display:flex;align-items:center;>*+*{margin-left:",(0,N.Z)(1),";}");var Be=i("./app/utils/measurements/measurements.tsx"),Fe=i("./app/views/dashboardsV2/widgetBuilder/releaseWidget/fields.tsx"),Ae=i("../node_modules/@dnd-kit/core/dist/core.esm.js"),ke=i("../node_modules/@dnd-kit/sortable/dist/sortable.esm.js"),Le=i("./app/views/eventsV2/table/queryField.tsx");function _e(e){let{onDelete:t,onChange:i,fieldOptions:s,value:r,forwardRef:n,listeners:o,attributes:d,canDelete:u,canDrag:c,style:p,isDragging:g}=e;return(0,Y.tZ)(De,{ref:n,style:p,children:g?null:(0,Y.BX)(l.Fragment,{children:[c&&(0,Y.tZ)(Ne,{...o,...d,"aria-label":(0,a.t)("Drag to reorder"),icon:(0,Y.tZ)(be.LS,{size:"xs"}),size:"zero",borderless:!0}),(0,Y.tZ)(Le.q,{placeholder:(0,a.t)("Select group"),fieldValue:r,fieldOptions:s,onChange:i,filterPrimaryOptions:e=>e.value.kind!==de.L.FUNCTION}),u&&(0,Y.tZ)(he.ZP,{size:"zero",borderless:!0,onClick:t,icon:(0,Y.tZ)(be.Fz,{}),title:(0,a.t)("Remove group"),"aria-label":(0,a.t)("Remove group")})]})})}_e.displayName="QueryField";const Ne=(0,d.Z)(he.ZP,{target:"epp8h3j1"})({name:"1k18kha",styles:"height:40px"}),De=(0,d.Z)("div",{target:"epp8h3j0"})("display:flex;align-items:center;justify-content:space-between;width:100%;>*+*{margin-left:",(0,N.Z)(1),";}");var Re=i("../node_modules/@dnd-kit/utilities/dist/utilities.esm.js"),Ie=i("../node_modules/@emotion/react/dist/emotion-element-cbed451f.browser.esm.js");function ze(e){let{dragId:t,...i}=e;const s=(0,Ie.a)(),{listeners:r,setNodeRef:a,transform:n,transition:o,attributes:d,isDragging:l}=(0,ke.nB)({id:t,transition:null});let u={transform:Re.ux.Transform.toString(n),transition:o,zIndex:"auto"};return l&&(u={...u,zIndex:100,height:"40px",border:`2px dashed ${s.border}`,borderRadius:s.borderRadius}),(0,Y.tZ)(_e,{forwardRef:a,listeners:r,attributes:d,isDragging:l,style:u,...i})}ze.displayName="SortableQueryField";const je={kind:de.L.FIELD,field:""};function Ve(e){var t;let{fieldOptions:i,columns:s=[],onChange:r}=e;const[n,o]=(0,l.useState)(null);function d(e,t){const i=[...s];0===s.length?i.push(e):(0,R.ri)(t)&&(i[t]=e),r(i)}const u=1===s.length&&s[0].kind===de.L.FIELD&&""!==(null===(t=s[0])||void 0===t?void 0:t.field),c=s.length>1,p=c||u,g=s.map(z.sN),{filteredFieldOptions:m,columnsAsFieldOptions:y}=(0,l.useMemo)((()=>Object.keys(i).reduce(((e,t)=>{const s=i[t],r=g.findIndex((e=>e===s.value.meta.name));return-1===r?(e.filteredFieldOptions[t]=s,e):(e.columnsAsFieldOptions[r]={[t]:s},e)}),{filteredFieldOptions:{},columnsAsFieldOptions:[]})),[i,s]),h=(0,l.useMemo)((()=>s.reduce(((e,t,i)=>(e.push(String(i)),e)),[])),[s]);return(0,Y.BX)(l.Fragment,{children:[(0,Y.tZ)(Pe,{inline:!1,flexibleControlStateSize:!0,stacked:!0,children:0===s.length?(0,Y.tZ)(_e,{value:je,fieldOptions:m,onChange:e=>d(e,0),canDelete:p}):(0,Y.BX)(Ae.LB,{collisionDetection:Ae.pE,onDragStart:e=>{let{active:t}=e;o(t.id)},onDragEnd:e=>{let{over:t,active:i}=e;if(o(null),t){const e=h.indexOf.bind(h),a=e(i.id),n=e(t.id);a!==n&&r((0,ke.Rp)(s,a,n))}},onDragCancel:()=>{o(null)},children:[(0,Y.tZ)(ke.Fo,{items:h,strategy:ke.qw,children:(0,Y.tZ)(Ue,{children:s.map(((e,t)=>(0,Y.tZ)(ze,{dragId:h[t],value:e,fieldOptions:{...m,...y[t]},onChange:e=>d(e,t),onDelete:()=>function(e){const t=[...s];t.splice(e,1),r(t)}(t),canDrag:c,canDelete:p},h[t])))})}),(0,Y.tZ)(Ae.y9,{dropAnimation:null,children:n?(0,Y.tZ)(We,{children:(0,Y.tZ)(_e,{value:s[Number(n)],fieldOptions:{...m,...y[Number(n)]},onChange:e=>d(e,Number(n)),canDrag:c,canDelete:p})}):null})]})}),s.length<20&&(0,Y.tZ)(Me,{size:"small",icon:(0,Y.tZ)(be.N_,{isCircled:!0}),onClick:function(){const e=0===s.length?[{...je},{...je}]:[...s,{...je}];r(e)},children:(0,a.t)("Add Group")})]})}Ve.displayName="GroupBySelector";const Pe=(0,d.Z)(re.Z,{target:"esrd23w3"})("padding-bottom:",(0,N.Z)(1),";"),Me=(0,d.Z)(he.ZP,{target:"esrd23w2"})({name:"b9l38d",styles:"width:min-content"}),Ue=(0,d.Z)("div",{target:"esrd23w1"})("display:grid;grid-auto-flow:row;gap:",(0,N.Z)(1),";"),We=(0,d.Z)("div",{target:"esrd23w0"})("position:absolute;background:",(e=>e.theme.background),";padding:",(0,N.Z)(.5),";border-radius:",(e=>e.theme.borderRadius),";box-shadow:0 0 15px rgba(0, 0, 0, 0.15);opacity:0.8;cursor:grabbing;padding-right:",(0,N.Z)(2),";width:100%;button{cursor:grabbing;}@media (min-width: ",(e=>e.theme.breakpoints.small),"){width:710px;}");function He(e){let{dataSet:t,columns:i,onGroupByChange:s,organization:r,tags:n}=e;return(0,Y.tZ)(J,{title:(0,a.t)("Group your results"),description:(0,a.t)("This is how you can group your data result by field or tag."),children:t===Q.qg.RELEASES?(0,Y.tZ)(Ve,{columns:i,fieldOptions:(0,Fe.e1)([],Fe.ve),onChange:s}):(0,Y.tZ)(Be.Z,{children:e=>{let{measurements:t}=e;return(0,Y.tZ)(Ve,{columns:i,fieldOptions:(0,Q.jd)({measurements:t,tags:n,organization:r}),onChange:s})}})})}He.displayName="GroupByStep";var $e=i("./app/components/forms/selectControl.tsx"),Xe=i("./app/views/dashboardsV2/widgetBuilder/issueWidget/utils.tsx"),Ge=i("./app/views/issueList/utils.tsx"),Qe=i("../node_modules/lodash/uniqBy.js"),Ye=i.n(Qe),Je=i("./app/components/tooltip.tsx"),Ke=i("./app/views/eventsV2/table/arithmeticInput.tsx");function et(e){let{values:t,sortByOptions:i,widgetType:s,onChange:r,disabledReason:n,disabledSort:d,disabledSortDirection:u,hasGroupBy:c,tags:p,filterPrimaryOptions:g,displayType:m}=e;const y=(0,o.Z)(),[h,f]=(0,l.useState)(!1),[b,w]=(0,l.useState)({sortBy:`${z.qe}`,sortDirection:t.sortDirection});return(0,l.useEffect)((()=>{const e=(0,z.GO)(v()(t.sortBy,"-"));e&&w({sortBy:v()(t.sortBy,"-"),sortDirection:t.sortDirection}),f(e)}),[t.sortBy,t.sortDirection]),(0,Y.tZ)(Je.Z,{title:n,disabled:!(u&&d),children:(0,Y.BX)(tt,{children:[(0,Y.tZ)(Je.Z,{title:n,disabled:!u||u&&d,children:(0,Y.tZ)($e.Z,{name:"sortDirection","aria-label":"Sort direction",menuPlacement:"auto",disabled:u,options:Object.keys(Q.Qj).map((e=>({label:Q.Qj[e],value:e}))),value:t.sortDirection,onChange:e=>{r({sortBy:t.sortBy,sortDirection:e.value})}})}),s!==W.l9.DISCOVER||[W.FO.TABLE,W.FO.TOP_N].includes(m)?s!==W.l9.RELEASE||[W.FO.TABLE,W.FO.TOP_N].includes(m)?(0,Y.tZ)(Je.Z,{title:n,disabled:!d||u&&d,children:(0,Y.tZ)($e.Z,{name:"sortBy","aria-label":"Sort by",menuPlacement:"auto",disabled:d,placeholder:`${(0,a.t)("Select a column")}â€¦`,value:t.sortBy,options:Ye()(i,(e=>{let{value:t}=e;return t})),onChange:e=>{r({sortBy:e.value,sortDirection:t.sortDirection})}})}):(0,Y.tZ)(Je.Z,{title:n,disabled:!d||u&&d,children:(0,Y.tZ)(Le.q,{disabled:d,fieldValue:(0,z.HM)({field:t.sortBy}),fieldOptions:(0,Fe.e1)(Object.values(Fe.Jo),Fe.ve),onChange:e=>{const i=(0,z.sN)(e);r({sortBy:i,sortDirection:t.sortDirection})},filterPrimaryOptions:g})}):(0,Y.tZ)(Be.Z,{children:e=>{let{measurements:s}=e;return(0,Y.tZ)(Le.q,{fieldValue:h?(0,z.HM)({field:st}):(0,z.HM)({field:t.sortBy}),fieldOptions:{...c?{[`field:${st}`]:{label:"Custom Equation",value:{kind:de.L.EQUATION,meta:{name:st}}}}:{},...(a=i,a.reduce(((e,t)=>(t.value.startsWith("equation")&&(e[`equation:${t.value}`]={label:t.label,value:{kind:de.L.EQUATION,meta:{name:t.value}}}),e)),{})),...(0,Q.jd)({measurements:s,organization:y,tags:p})},onChange:e=>{if(e.alias&&(0,z.uI)(e.alias))return void r({sortBy:e.alias,sortDirection:t.sortDirection});const i=(0,z.sN)(e),s=(0,z.GO)(i);f(s),r(s?b:{sortBy:i,sortDirection:t.sortDirection})},filterPrimaryOptions:g});var a}}),h&&(0,Y.tZ)(it,{children:(0,Y.tZ)(Ke.Z,{name:"arithmetic",type:"text",required:!0,placeholder:(0,a.t)("Enter Equation"),value:(0,z.vp)(b.sortBy),onUpdate:e=>{const i={sortBy:`${z.qe}${e}`,sortDirection:t.sortDirection};r(i),w(i)},hideFieldOptions:!0})})]})})}et.displayName="SortBySelectors";const tt=(0,d.Z)("div",{target:"e1grfh1l1"})("display:grid;gap:",(0,N.Z)(1),";@media (min-width: ",(e=>e.theme.breakpoints.small),"){grid-template-columns:200px 1fr;}"),it=(0,d.Z)("div",{target:"e1grfh1l0"})({name:"18iuzk9",styles:"grid-column:1/-1"}),st="custom-equation";function rt(e){let{displayType:t,onSortByChange:i,queries:s,dataSet:r,widgetBuilderNewDesign:n,widgetType:o,organization:d,error:u,limit:c,onLimitChange:p,tags:g}=e;const m=s[0].columns;let y,h=!1,f=!1;o===W.l9.RELEASE&&m.includes("session.status")&&(h=!0,f=!0,y=(0,a.t)("Sorting currently not supported with session.status")),o===W.l9.ISSUE&&(f=!0,y=(0,a.t)("Issues dataset does not yet support descending order"));const b=s[0].orderby,w=v()(b,"-"),Z=(0,Q.oA)(s.length,s[0].aggregates.length),S=[W.FO.LINE,W.FO.BAR,W.FO.AREA].includes(t);(0,l.useEffect)((()=>{c&&c>Z&&p(Z)}),[c,Z]);const T=new Set(s[0].columns);return n?(0,Y.tZ)(J,{title:t===W.FO.TABLE?(0,a.t)("Sort by a column"):(0,a.t)("Sort by a y-axis"),description:t===W.FO.TABLE?(0,a.t)("Choose one of the columns you've created to sort by."):(0,a.t)("Choose one of the y-axis you've created to sort by."),children:(0,Y.BX)(re.Z,{inline:!1,error:u,flexibleControlStateSize:!0,stacked:!0,children:[[W.FO.AREA,W.FO.BAR,W.FO.LINE].includes(t)&&c&&(0,Y.tZ)(at,{name:"resultsLimit",menuPlacement:"auto",options:[...Array(Z).keys()].map((e=>{const t=e+1;return{label:(0,a.tn)("Limit to %s result","Limit to %s results",t),value:t}})),value:c,onChange:e=>{p(e.value)}}),(0,Y.tZ)(et,{displayType:t,widgetType:o,hasGroupBy:S&&!!s[0].columns.length,disabledReason:y,disabledSort:h,disabledSortDirection:f,sortByOptions:r===Q.qg.ISSUES?(0,Xe.W)(d.features.includes("issue-list-trend-sort")):(0,x._4)({widgetType:o,widgetBuilderNewDesign:!0,columns:s[0].columns,aggregates:s[0].aggregates}),values:{sortDirection:"-"===b[0]?Q.Sr.HIGH_TO_LOW:Q.Sr.LOW_TO_HIGH,sortBy:w},onChange:e=>{let{sortDirection:t,sortBy:s}=e;const r=t===Q.Sr.HIGH_TO_LOW?`-${s}`:s;i(r)},tags:g,filterPrimaryOptions:r===Q.qg.RELEASES?e=>!["count_healthy","count_errored"].includes(e.value.meta.name)&&(e.value.kind===de.L.TAG?T.has(e.value.meta.name)&&"release"===e.value.meta.name:(0,Q.wy)({option:e,widgetType:o,displayType:W.FO.TABLE})):e=>e.value.kind===de.L.FUNCTION||e.value.kind===de.L.EQUATION||T.has(e.value.meta.name)||e.value.meta.name===st})]})}):(0,Y.tZ)(J,{title:(0,a.t)("Sort by a column"),description:(0,a.t)("Choose one of the columns you've created to sort by."),children:(0,Y.tZ)(re.Z,{inline:!1,error:u,flexibleControlStateSize:!0,stacked:!0,children:(0,Y.tZ)($e.Z,{menuPlacement:"auto",value:r===Q.qg.EVENTS?s[0].orderby:s[0].orderby||Ge.qh.DATE,name:"orderby",options:r===Q.qg.EVENTS?(0,x._4)({widgetType:o,columns:s[0].columns,aggregates:s[0].aggregates}):(0,Xe.W)(d.features.includes("issue-list-trend-sort")),onChange:e=>{i(e.value)}})})})}rt.displayName="SortByStep";const at=(0,d.Z)($e.Z,{target:"e14t0x3e0"})("margin-bottom:",(0,N.Z)(1),";");var nt=i("../node_modules/@emotion/react/dist/emotion-react.browser.esm.js"),ot=i("../node_modules/lodash/debounce.js"),dt=i.n(ot),lt=i("../node_modules/lodash/isEqual.js"),ut=i.n(lt),ct=i("./app/components/charts/simpleTableChart.tsx"),pt=i("./app/components/panels/index.tsx"),gt=i("./app/utils/usePrevious.tsx"),mt=i("./app/views/dashboardsV2/widgetCard/index.tsx");function yt(e){let{organization:t,pageFilters:i,displayType:s,error:r,onChange:n,widget:o}=e;const[d,u]=(0,l.useState)(o),c=(0,gt.Z)(o),p=(0,l.useCallback)(dt()(((e,t)=>{t||u(e)}),we.Dk),[]);(0,l.useEffect)((()=>{let e=!1;return ut()(c,o)||p(o,e),()=>{e=!0}}),[o,c,p]);const g=Object.keys(Q.hV).map((e=>({label:Q.hV[e],value:e})));return(0,Y.BX)(J,{title:(0,a.t)("Choose your visualization"),description:(0,a.t)("This is a preview of how your widget will appear in the dashboard."),children:[(0,Y.tZ)(re.Z,{error:r,inline:!1,flexibleControlStateSize:!0,stacked:!0,children:(0,Y.tZ)($e.Z,{name:"displayType",options:g,value:s,onChange:e=>{n(e.value)},styles:{singleValue:e=>({...e,width:`calc(100% - ${(0,N.Z)(1)})`})}})}),(0,Y.tZ)(ht,{displayType:s,children:(0,Y.tZ)(mt.Z,{organization:t,selection:i,widget:d,isEditing:!1,widgetLimitReached:!1,renderErrorMessage:e=>"string"==typeof e&&(0,Y.tZ)(pt.aU,{type:"error",children:e}),isSorting:!1,currentWidgetDragging:!1,noLazyLoad:!0,showStoredAlert:!0})})]})}yt.displayName="VisualizationStep";const ht=(0,d.Z)("div",{target:"e1huhsf60"})("padding-right:",(0,N.Z)(2),";",mt._,"{height:initial;}",(e=>e.displayType===W.FO.TABLE&&(0,nt.iv)("overflow:hidden;",ct.p,"{height:41px;}",mt._,"{height:301px;}","")),";");var ft=i("./app/components/buttonBar.tsx"),bt=i("./app/views/eventsV2/utils.tsx");function vt(e){let{title:t,onAdd:i}=e;return(0,Y.tZ)(he.ZP,{size:"small",onClick:i,icon:(0,Y.tZ)(be.N_,{isCircled:!0}),children:t})}function wt(e){let{onDelete:t}=e;return(0,Y.tZ)(he.ZP,{size:"zero",borderless:!0,onClick:t,icon:(0,Y.tZ)(be.Fz,{}),title:(0,a.t)("Remove this Y-Axis"),"aria-label":(0,a.t)("Remove this Y-Axis")})}function Zt(e){var t;let{displayType:i,widgetType:s,aggregates:r,fieldOptions:n,onChange:d,errors:l,noFieldsMessage:u}=e;const c=(0,o.Z)(),p=s===W.l9.RELEASE;function g(e){return t=>{if(p)return t.value.kind===de.L.METRICS;if((0,Q.sv)(i))return!0;if(e.kind!==de.L.FUNCTION)return!0;const s=e.function[0],r=(0,z._4)(s,t.value.meta.name);return r?(0,z.HW)(r):t.value.kind!==de.L.FUNCTION&&t.value.kind!==de.L.EQUATION&&(0,z.HW)(t.value.meta.dataType)}}const m=null==l||null===(t=l.find((e=>null==e?void 0:e.aggregates)))||void 0===t?void 0:t.aggregates;if(i===W.FO.TOP_N){const e=r[r.length-1];return(0,Y.tZ)(re.Z,{inline:!1,flexibleControlStateSize:!0,error:m,stacked:!0,children:(0,Y.tZ)(St,{children:(0,Y.tZ)(Le.q,{fieldValue:e,fieldOptions:(0,bt.R0)({organization:c}),onChange:function(e){d([e])},filterPrimaryOptions:e=>(0,Q.wy)({option:e,widgetType:s,displayType:i}),filterAggregateParameters:g(e)})})})}const y=r.length>1,h=[W.FO.WORLD_MAP,W.FO.BIG_NUMBER].includes(i)&&1===r.length||[W.FO.LINE,W.FO.AREA,W.FO.BAR].includes(i)&&3===r.length;return(0,Y.BX)(re.Z,{inline:!1,flexibleControlStateSize:!0,error:m,stacked:!0,children:[r.map(((e,t)=>(0,Y.BX)(St,{children:[(0,Y.tZ)(Le.q,{fieldValue:e,fieldOptions:n,onChange:e=>function(e,t){const i=[...r];i[t]=e,d(i)}(e,t),filterPrimaryOptions:e=>(0,Q.wy)({option:e,widgetType:s,displayType:i}),filterAggregateParameters:g(e),otherColumns:r,noFieldsMessage:u}),r.length>1&&(y||e.kind===de.L.EQUATION)&&(0,Y.tZ)(wt,{onDelete:e=>function(e,t){e.preventDefault();const i=[...r];i.splice(t,1),d(i)}(e,t)})]},`${e}:${t}`))),!h&&(0,Y.BX)(Tt,{gap:1,children:[(0,Y.tZ)(vt,{title:(0,a.t)("Add Overlay"),onAdd:function(e){e.preventDefault();const t=[...r,{kind:de.L.FIELD,field:""}];d(t)}}),!p&&(0,Y.tZ)(vt,{title:(0,a.t)("Add an Equation"),onAdd:function(e){e.preventDefault();const t=[...r,{kind:de.L.EQUATION,field:""}];d(t)}})]})]})}vt.displayName="AddButton",wt.displayName="DeleteButton",Zt.displayName="YAxisSelector";const St=(0,d.Z)("div",{target:"ew36myz1"})("display:flex;align-items:center;justify-content:space-between;:not(:last-child){margin-bottom:",(0,N.Z)(1),";}>*+*{margin-left:",(0,N.Z)(1),";}"),Tt=(0,d.Z)(ft.ZP,{target:"ew36myz0"})({name:"11g6mpt",styles:"justify-content:flex-start"});function xt(e){let{aggregates:t,displayType:i,widgetType:s,onChange:r,errors:a}=e;return(0,Y.tZ)(Zt,{widgetType:s,displayType:i,aggregates:t,onChange:r,errors:a,fieldOptions:(0,Fe.e1)(Object.values(Fe.Jo),Fe.ve)})}function Et(e){let{displayType:t,dataSet:i,queryErrors:s,aggregates:r,onYAxisChange:n,organization:o,tags:d,widgetType:l}=e;return(0,Y.tZ)(J,{title:t===W.FO.BIG_NUMBER?(0,a.t)("Choose what to plot"):(0,a.t)("Choose what to plot in the y-axis"),description:[W.FO.AREA,W.FO.BAR,W.FO.LINE].includes(t)?(0,a.t)("This is the data you'd be visualizing in the display. If the overlay units conflict, the charts will always base it off of the first line."):(0,a.t)("This is the data you'd be visualizing in the display."),children:i===Q.qg.RELEASES?(0,Y.tZ)(xt,{widgetType:l,displayType:t,aggregates:r,onChange:n,errors:s}):(0,Y.tZ)(Be.Z,{children:e=>{let{measurements:i}=e;return(0,Y.tZ)(Zt,{widgetType:l,displayType:t,aggregates:r,fieldOptions:(0,Q.jd)({measurements:i,organization:o,tags:d}),onChange:n,errors:s})}})})}xt.displayName="ReleaseYAxisSelector",Et.displayName="YAxisStep";var Ot=i("./app/components/confirm.tsx");function qt(e){let{goBackLocation:t,onSave:i,onDelete:s,invalidForm:r,isEditing:n}=e;return(0,Y.tZ)(Bt,{children:(0,Y.BX)(Ct,{gap:1,children:[(0,Y.tZ)(he.ZP,{to:t,children:(0,a.t)("Cancel")}),n&&s&&(0,Y.tZ)(Ot.Z,{priority:"danger",message:(0,a.t)("Are you sure you want to delete this widget?"),onConfirm:s,children:(0,Y.tZ)(he.ZP,{priority:"danger",children:(0,a.t)("Delete")})}),(0,Y.tZ)(he.ZP,{priority:"primary",onClick:i,disabled:r,title:r?(0,a.t)("Required fields must be filled out"):void 0,children:n?(0,a.t)("Update Widget"):(0,a.t)("Add Widget")})]})})}qt.displayName="Footer";const Ct=(0,d.Z)(ft.ZP,{target:"e1golk021"})("justify-content:flex-end;max-width:1000px;padding:",(0,N.Z)(4)," ",(0,N.Z)(2),";padding-right:calc(",(0,N.Z)(2)," + ",(0,N.Z)(2),");@media (min-width: ",(e=>e.theme.breakpoints.medium),"){padding:",(0,N.Z)(4),";padding-right:calc(",(0,N.Z)(4)," + ",(0,N.Z)(2),");}"),Bt=(0,d.Z)("div",{target:"e1golk020"})("background:",(e=>e.theme.background),";border-top:1px solid ",(e=>e.theme.gray200),";");var Ft=i("./app/components/breadcrumbs.tsx"),At=i("./app/components/editableText.tsx"),kt=i("./app/components/featureFeedback/index.tsx");function Lt(e){let{title:t,orgSlug:i,goBackLocation:s,dashboardTitle:r,onChangeTitle:n}=e;return(0,Y.BX)(q.h4,{children:[(0,Y.BX)(q.oB,{children:[(0,Y.tZ)(Ft.Z,{crumbs:[{to:`/organizations/${i}/dashboards/`,label:(0,a.t)("Dashboards")},{to:s,label:r},{label:(0,a.t)("Widget Builder")}]}),(0,Y.tZ)(q.Dx,{children:(0,Y.tZ)(At.Z,{"aria-label":(0,a.t)("Widget title"),value:t,onChange:n,errorMessage:(0,a.t)("Widget title is required"),maxLength:255})})]}),(0,Y.tZ)(q.kP,{children:(0,Y.BX)(ft.ZP,{gap:1,children:[(0,Y.tZ)(kt.z,{featureName:"widget-builder"}),(0,Y.tZ)(he.ZP,{external:!0,href:"https://docs.sentry.io/product/dashboards/custom-dashboards/#widget-builder",children:(0,a.t)("Read the docs")})]})})]})}Lt.displayName="Header";var _t=i("./app/actionCreators/modal.tsx"),Nt=i("./app/views/dashboardsV2/widgetLibrary/data.tsx"),Dt=i("./app/views/dashboardsV2/widgetBuilder/widgetLibrary/card.tsx");function Rt(e){let{bypassOverwriteModal:t,onWidgetSelect:i,widgetBuilderNewDesign:s,organization:r}=e;const n=(0,Ie.a)();let o=(0,Nt.P)();function d(e,s){return function(){t?i(e):(0,_t.openWidgetBuilderOverwriteModal)({onConfirm:()=>i(e),widget:e,iconColor:s})}}return r.features.includes("dashboards-releases")||(o=o.filter((e=>!(e.widgetType===W.l9.RELEASE)))),(0,Y.BX)(l.Fragment,{children:[(0,Y.tZ)(zt,{children:(0,a.t)("Widget Library")}),(0,Y.tZ)(It,{children:o.map(((e,t)=>{const i=n.charts.getColorPalette(o.length-2)[t],r=s&&e.displayType===W.FO.TOP_N?W.FO.TABLE:e.displayType,a=(0,Q.Zi)({displayType:r,queries:e.queries,widgetBuilderNewDesign:s,widgetType:e.widgetType}),l={...e,displayType:r,queries:a};return(0,Y.tZ)(jt,{onClick:d(l,i),children:(0,Y.tZ)(Dt.Z,{widget:l,iconColor:i})},e.title)}))})]})}Rt.displayName="WidgetLibrary";const It=(0,d.Z)("div",{target:"ess72gf2"})({name:"1fttcpj",styles:"display:flex;flex-direction:column"}),zt=(0,d.Z)("h5",{target:"ess72gf1"})("padding-left:calc(",(0,N.Z)(2)," - ",(0,N.Z)(.25),");"),jt=(0,d.Z)("div",{target:"ess72gf0"})("padding:calc(",(0,N.Z)(2)," - 3px);border:1px solid transparent;border-radius:",(e=>e.theme.borderRadius),";transition:border-color 0.3s ease;cursor:pointer;&:hover{border-color:",(e=>e.theme.gray100),";}"),Vt={[W.l9.DISCOVER]:Q.qg.EVENTS,[W.l9.ISSUE]:Q.qg.ISSUES,[W.l9.RELEASE]:Q.qg.RELEASES},Pt={[Q.qg.EVENTS]:W.l9.DISCOVER,[Q.qg.ISSUES]:W.l9.ISSUE,[Q.qg.RELEASES]:W.l9.RELEASE};function Mt(e){var t,i,s,r,o,d,u;let{dashboard:p,params:m,location:h,organization:b,selection:q,start:C,end:B,statsPeriod:A,onSave:N,route:P,router:M,tags:G}=e;const{widgetIndex:J,orgId:K,dashboardId:ee}=m,{source:te,displayType:ie,defaultTitle:se,defaultTableColumns:re,limit:ae}=h.query,ne=(0,Q.eQ)(h.query.defaultWidgetQuery),oe=b.features.includes("new-widget-builder-experience-design"),de=b.features.includes("dashboards-releases"),le=p.widgets.filter((e=>{let{widgetType:t}=e;return t!==W.l9.RELEASE||de})),ce=(0,R.ri)(J),pe=Number(J),ge=pe>=0&&pe<le.length&&Number.isInteger(pe),ye=b.slug,he=A?{...q,datetime:{start:null,end:null,period:A,utc:null}}:C&&B?{...q,datetime:{start:C,end:B,period:null,utc:null}}:q,fe=[W.EN.DISCOVERV2,W.EN.ISSUE_DETAILS].includes(te),be=(0,V.Z)(),[ve,we]=(0,l.useState)(!1),[Ze,Se]=(0,l.useState)((0,$.v)(W.l9.DISCOVER)),[Te,xe]=(0,l.useState)((()=>{var e;const t={title:null!=se?se:(0,a.t)("Custom Widget"),displayType:null!==(e=oe&&ie===W.FO.TOP_N?W.FO.AREA:ie)&&void 0!==e?e:W.FO.TABLE,interval:"5m",queries:[],limit:ae?Number(ae):void 0,errors:void 0,loading:!!fe,dashboards:[],userHasModified:!1,dataSet:Q.qg.EVENTS};return ne?(t.queries=oe?[{...ne,orderby:ne.orderby||(0,x._4)({widgetType:W.l9.DISCOVER,widgetBuilderNewDesign:oe,columns:ne.columns,aggregates:ne.aggregates})[0].value}]:[{...ne}],[W.FO.TABLE,W.FO.TOP_N].includes(t.displayType)||(0,Q.V0)(t.displayType)&&t.queries[0].columns.length||(t.queries[0].orderby="")):t.queries=[{...Ze.defaultWidgetQuery}],t})),[Oe,qe]=(0,l.useState)(null),[Ce,Be]=(0,l.useState)(null);(0,l.useEffect)((()=>{if((0,I.Z)("dashboards_views.widget_builder.opened",{organization:b,new_widget:!ce}),(0,R.z)(G)&&(0,T.QK)(be,b.slug,q),ce&&ge){const i=le[pe];let s,r=i.displayType,a=i.limit;var e,t;i.displayType===W.FO.TOP_N?(a=Q._k,r=W.FO.AREA,s=(0,Q.Zi)({displayType:r,queries:i.queries,widgetType:null!==(e=i.widgetType)&&void 0!==e?e:W.l9.DISCOVER,widgetBuilderNewDesign:oe}).map((e=>({...e,aggregates:e.aggregates.length?[e.aggregates[e.aggregates.length-1]]:[]})))):s=(0,Q.Zi)({displayType:r,queries:i.queries,widgetType:null!==(t=i.widgetType)&&void 0!==t?t:W.l9.DISCOVER,widgetBuilderNewDesign:oe}),xe({title:i.title,displayType:r,interval:i.interval,queries:s,errors:void 0,loading:!1,dashboards:[],userHasModified:!1,dataSet:i.widgetType?Vt[i.widgetType]:Q.qg.EVENTS,limit:a}),Se((0,$.v)(i.widgetType)),qe(i)}}),[]),(0,l.useEffect)((()=>{fe&&async function(){const e=be.requestPromise(`/organizations/${b.slug}/dashboards/`,{method:"GET",query:{sort:"myDashboardsAndRecentlyViewed"}});try{const t=await e;xe((e=>({...e,dashboards:t,loading:!1})))}catch(e){const t=(0,a.t)("Unable to fetch dashboards");(0,Z.Iw)(t),(0,j.Z)(t)(e),xe((e=>({...e,loading:!1})))}}(),oe&&xe((e=>({...e,selectedDashboard:{label:p.title,value:p.id||Q.i0}})))}),[be,p.id,p.title,fe,b.slug,te,oe]),(0,l.useEffect)((()=>{var e;(0,S.MA)(be,b.slug,null===(e=q.projects)||void 0===e?void 0:e.map(String))}),[q.projects,be,b.slug]),(0,l.useEffect)((()=>{M.setRouteLeaveHook(P,(()=>{if(!ve&&Te.userHasModified)return(0,a.t)("You have unsaved changes, are you sure you want to leave?")}))}),[ve,Te.userHasModified,P,M]);const Fe=Te.dataSet===Q.qg.EVENTS?W.l9.DISCOVER:Te.dataSet===Q.qg.ISSUES?W.l9.ISSUE:W.l9.RELEASE,Ae={title:Te.title,displayType:Te.displayType,interval:Te.interval,queries:Te.queries,limit:Te.limit,widgetType:Fe},ke=null!==(t=null===(i=Te.selectedDashboard)||void 0===i?void 0:i.value)&&void 0!==t?t:ee,Le=y()(h.query,"source"),_e={pathname:(0,R.ri)(ke)&&ke!==Q.i0?`/organizations/${K}/dashboard/${ke}/`:`/organizations/${K}/dashboards/${Q.i0}/`,query:g()(Le)?void 0:Le},Ne=(0,Q.V0)(Te.displayType),De=[W.FO.TABLE,W.FO.TOP_N].includes(Te.displayType);function Re(){return Oe?p.widgets.findIndex((e=>(0,R.ri)(e.id)?e.id===Oe.id:!!(0,R.ri)(e.tempId)&&e.tempId===Oe.tempId)):-1}function Ie(e,t){var i;(0,I.Z)("dashboards_views.widget_builder.change",{from:te,field:e,value:t,widget_type:Fe,organization:b,new_widget:!ce}),xe((i=>{const s=c()(i);return f()(s,e,t),"title"===e&&f()(s,"userHasModified",!0),{...s,errors:void 0}})),"displayType"===e&&t!==Te.displayType&&(i=t,xe((e=>{const t=c()(e);if(!Ze.supportedDisplayTypes.includes(i))return f()(t,"queries",(0,Q.Zi)({displayType:i,queries:[{...(0,$.v)(W.l9.DISCOVER).defaultWidgetQuery}],widgetType:W.l9.DISCOVER,widgetBuilderNewDesign:oe})),f()(t,"dataSet",Q.qg.EVENTS),Se((0,$.v)(W.l9.DISCOVER)),{...t,errors:void 0};const s=(0,Q.Zi)({displayType:i,queries:e.queries,widgetType:Pt[e.dataSet],widgetBuilderNewDesign:oe});var r;return i===W.FO.TOP_N&&s.splice(1),e.userHasModified||ne&&re&&(i===W.FO.TABLE?s.forEach((e=>{var t;const i=(0,z.n0)(re);e.columns=[...i.columns],e.aggregates=[...i.aggregates],e.fields=[...re],e.orderby=null!==(t=ne.orderby)&&void 0!==t?t:e.fields.length?`${e.fields[0]}`:"-"})):i===ie&&s.forEach((e=>{e.fields=[...ne.columns,...ne.aggregates],e.aggregates=[...ne.aggregates],e.columns=[...ne.columns],ne.orderby&&(ie===W.FO.TOP_N||ne.columns.length)&&(e.orderby=ne.orderby)}))),f()(t,"queries",s),oe&&((0,Q.V0)(i)&&s[0].columns.filter((e=>!!e)).length?t.limit=null!==(r=e.limit)&&void 0!==r?r:Math.min((0,Q.oA)(s.length,s[0].columns.length),Q._k):t.limit=void 0),f()(t,"userHasModified",!0),{...t,errors:void 0}})))}function ze(e,t){xe((i=>{const s=c()(i);return f()(s,`queries.${e}`,t),f()(s,"userHasModified",!0),{...s,errors:void 0}}))}function je(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const i=e.map(z.sN).map((e=>Te.dataSet===Q.qg.RELEASES?(0,z.hr)(e):e)),s=t?(0,z.KZ)(e):void 0,r=c()(Te),a=Fe===W.l9.RELEASE&&i.includes("session.status"),n=Te.queries.map((r=>{const n=r.orderby.startsWith("-")?"-":"",o=v()(r.orderby,"-"),d=r.aggregates.map((e=>Te.dataSet===Q.qg.RELEASES?(0,z.hr)(e):e)),l=c()(r);var u,p,g;if(a&&(l.orderby=""),t){if(l.fields=i,l.aggregates=null!==(u=null==s?void 0:s.aggregates)&&void 0!==u?u:[],Te.dataSet===Q.qg.RELEASES&&0===l.aggregates.length){const e=`crash_free_rate(${D.r2.SESSION})`;l.aggregates=[e],l.fields=[...l.fields,e]}}else if(Te.displayType===W.FO.TOP_N){var m,y;l.fields=[...null!==(m=null===(y=l.fields)||void 0===y?void 0:y.slice(0,l.fields.length-1))&&void 0!==m?m:[],...i],l.aggregates=[...l.aggregates.slice(0,l.aggregates.length-1),...i]}else l.fields=[...l.columns,...i],l.aggregates=i;if(oe&&Ne||!t||(l.columns=null!==(p=null==s?void 0:s.columns)&&void 0!==p?p:[]),!i.includes(o)&&""!==r.orderby)if(!oe&&d.length===e.length&&d.includes(o)){var h;let e=i[d.indexOf(o)];(0,z.bQ)(null!==(h=e)&&void 0!==h?h:"")||(e=""),l.orderby=`${n}${e}`}else{var f;const e=l.aggregates.includes(o),t=(0,z.GO)(o),s=l.columns.includes(o),r=e||t||s,a=(0,z.GO)(null!==(f=l.aggregates[0])&&void 0!==f?f:"")?`equation[${(0,X.yd)(l.aggregates)-1}]`:i[0];l.orderby=oe?r&&l.orderby||`${n}${a}`:""}return oe&&(l.fieldAliases=null!==(g=null==s?void 0:s.fieldAliases)&&void 0!==g?g:[]),l}));if(f()(r,"queries",n),f()(r,"userHasModified",!0),oe&&Ne){const e=r.queries[0].columns.filter((e=>!("equation|"===e)));var o;0===e.length?f()(r,"limit",void 0):f()(r,"limit",Math.min(null!==(o=r.limit)&&void 0!==o?o:Q._k,(0,Q.oA)(n.length,n[0].aggregates.length)))}xe(r)}function Ve(e,t){const i=!g()(Le)||t?{...Le,...t}:void 0;e!==Q.i0?M.push({pathname:`/organizations/${b.slug}/dashboard/${e}/`,query:i}):M.push({pathname:`/organizations/${b.slug}/dashboards/new/`,query:i})}const Pe=[W.FO.LINE,W.FO.AREA,W.FO.BAR].includes(Te.displayType)&&Te.queries.length<3,Me=[W.FO.TABLE,W.FO.WORLD_MAP,W.FO.BIG_NUMBER].includes(Te.displayType),{columns:Ue,aggregates:We,fields:$e,fieldAliases:Xe=[]}=Te.queries[0],Ge=(0,l.useMemo)((()=>Ue.map(((e,t)=>(0,z.HM)({field:e,alias:Xe[t]})))),[Ue,Xe]),Qe=(0,l.useMemo)((()=>We.map(((e,t)=>(0,z.HM)({field:e,alias:Xe[t]})))),[We,Xe]),Ye=(0,R.ri)($e)?$e.map(((e,t)=>(0,z.HM)({field:e,alias:Xe[t]}))):[...Ge,...Qe],Je=Ae.queries.some((e=>e.columns.filter((e=>!!e)).length>0)),Ke=oe&&Ne&&Je||De;return ce&&!ge?(0,Y.tZ)(_.Z,{title:p.title,orgSlug:ye,children:(0,Y.tZ)(n.JH,{children:(0,Y.tZ)(F.Z,{message:(0,a.t)("The widget you want to edit was not found.")})})}):(0,Y.tZ)(_.Z,{title:p.title,orgSlug:ye,children:(0,Y.tZ)(k.Z,{defaultSelection:{datetime:{start:null,end:null,utc:!1,period:H.GY}},hideGlobalHeader:!0,children:(0,Y.BX)(Wt,{children:[(0,Y.tZ)(Lt,{orgSlug:ye,title:Te.title,dashboardTitle:p.title,goBackLocation:_e,onChangeTitle:e=>{Ie("title",e)}}),(0,Y.BX)(Xt,{children:[(0,Y.BX)(Yt,{children:[(0,Y.BX)(Gt,{children:[(0,Y.BX)(Ht,{condensed:!0,children:[(0,Y.tZ)(L.Z,{}),(0,Y.tZ)(O.Z,{}),(0,Y.tZ)(E.Z,{alignDropdown:"left"})]}),(0,Y.BX)($t,{symbol:"colored-numeric",children:[(0,Y.tZ)(yt,{widget:Ae,organization:b,pageFilters:he,displayType:Te.displayType,error:null===(s=Te.errors)||void 0===s?void 0:s.displayType,onChange:e=>{Ie("displayType",e)}}),(0,Y.tZ)(me,{dataSet:Te.dataSet,displayType:Te.displayType,onChange:function(e){xe((t=>{const i=c()(t);i.queries.splice(0,i.queries.length),f()(i,"dataSet",e),e===Q.qg.ISSUES&&f()(i,"displayType",W.FO.TABLE);const s=(0,$.v)(Pt[e]);return Se(s),i.queries.push(...null!=Oe&&Oe.widgetType&&Vt[Oe.widgetType]===e?Oe.queries:[{...s.defaultWidgetQuery}]),f()(i,"userHasModified",!0),{...i,errors:void 0}}))},hasReleaseHealthFeature:de}),De&&(0,Y.tZ)(ue,{dataSet:Te.dataSet,queries:Te.queries,displayType:Te.displayType,widgetType:Fe,queryErrors:null===(r=Te.errors)||void 0===r?void 0:r.queries,onQueryChange:ze,onYAxisOrColumnFieldChange:e=>{je(e,!0)},explodedFields:Ye,tags:G,organization:b}),![W.FO.TABLE].includes(Te.displayType)&&(0,Y.tZ)(Et,{dataSet:Te.dataSet,displayType:Te.displayType,widgetType:Fe,queryErrors:null===(o=Te.errors)||void 0===o?void 0:o.queries,onYAxisChange:e=>{je(e)},aggregates:Qe,tags:G,organization:b}),(0,Y.tZ)(Ee,{queries:Te.queries,hideLegendAlias:Me,canAddSearchConditions:Pe,organization:b,queryErrors:null===(d=Te.errors)||void 0===d?void 0:d.queries,onAddSearchConditions:function(){xe((e=>{const t=c()(e),i=(0,$.v)(Pt[e.dataSet]),s=c()(i.defaultWidgetQuery);return s.fields=e.queries[0].fields,s.aggregates=e.queries[0].aggregates,s.columns=e.queries[0].columns,s.orderby=e.queries[0].orderby,t.queries.push(s),t}))},onQueryChange:ze,onQueryRemove:function(e){xe((t=>{const i=c()(t);return i.queries.splice(e,1),{...i,errors:void 0}}))},selection:he,widgetType:Fe}),oe&&Ne&&(0,Y.tZ)(He,{columns:Ue.filter((e=>!("equation|"===e))).map(((e,t)=>(0,z.HM)({field:e,alias:Xe[t]}))),onGroupByChange:function(e){const t=e.map(z.sN),i=c()(Te),s=Te.queries.map((e=>{const i=c()(e);i.columns=t;const s=v()(i.orderby,"-"),r=i.aggregates.map(z.LY);if(t.length){if(oe&&!i.orderby){const t=(0,x._4)({widgetType:null!=Fe?Fe:W.l9.DISCOVER,widgetBuilderNewDesign:oe,columns:e.columns,aggregates:e.aggregates});let s;t.length||Te.dataSet!==Q.qg.RELEASES?(s=t[0].value,i.orderby=`-${s}`):i.orderby=""}else if(!oe&&r.length&&!r.includes(s)&&!i.columns.includes(s)&&!(0,z.GO)(s)){const e=i.orderby.startsWith("-"),t=s&&!e?"":"-",a=(0,z.GO)(r[0])?`equation[${(0,X.yd)(r)-1}]`:r[0];i.orderby=`${t}${a}`}}else i.orderby="";return i}));f()(i,"userHasModified",!0),f()(i,"queries",s);const r=i.queries[0].columns.filter((e=>!("equation|"===e)));var a;0===r.length?f()(i,"limit",void 0):f()(i,"limit",Math.min(null!==(a=i.limit)&&void 0!==a?a:Q._k,(0,Q.oA)(s.length,s[0].aggregates.length))),xe(i)},organization:b,tags:G,dataSet:Te.dataSet}),Ke&&(0,Y.tZ)(rt,{limit:Te.limit,displayType:Te.displayType,queries:Te.queries,dataSet:Te.dataSet,widgetBuilderNewDesign:oe,error:null===(u=Te.errors)||void 0===u?void 0:u.orderby,onSortByChange:function(e){const t=c()(Te);Te.queries.forEach(((i,s)=>{const r=c()(i);r.orderby=e,f()(t,`queries.${s}`,r)})),f()(t,"userHasModified",!0),xe(t)},onLimitChange:function(e){xe((t=>({...t,limit:e})))},organization:b,widgetType:Fe,tags:G})]})]}),(0,Y.tZ)(qt,{goBackLocation:_e,isEditing:ce,onSave:async function(){var e;const t=(0,U.TE)(Ae);if(Oe&&(t.layout=null==Oe?void 0:Oe.layout),oe||De||t.queries.forEach((e=>{e.orderby=""})),oe||t.queries.forEach((e=>y()(e,"fieldAliases"))),oe&&!Ne&&(t.limit=void 0),await async function(e){if(fe&&(!Te.selectedDashboard||!Te.dashboards.find((e=>{var t,i;let{title:s,id:r}=e;return s===(null===(t=Te.selectedDashboard)||void 0===t?void 0:t.label)&&r===(null===(i=Te.selectedDashboard)||void 0===i?void 0:i.value)}))&&Te.selectedDashboard.value!==Q.i0))return xe({...Te,errors:{...Te.errors,dashboard:(0,a.t)("This field may not be blank")}}),!1;xe({...Te,loading:!0});try{return await(0,w.QL)(be,b.slug,e),!0}catch(e){var t;return xe({...Te,loading:!1,errors:{...Te.errors,...(0,Q.wc)(null!==(t=null==e?void 0:e.responseJSON)&&void 0!==t?t:{},{})}}),!1}}(t))if(Ce&&(0,I.Z)("dashboards_views.widget_library.add_widget",{organization:b,title:Ce}),we(!0),fe)!function(e){var t;if(!Te.selectedDashboard)return;const i={queryNames:[],queryConditions:[],queryFields:[...e.queries[0].columns,...e.queries[0].aggregates],queryOrderby:e.queries[0].orderby};e.queries.forEach((e=>{i.queryNames.push(e.name),i.queryConditions.push(e.conditions)}));const s={displayType:e.displayType,interval:e.interval,title:e.title,...i,project:he.projects,environment:he.environments,...y()(he.datetime,"period"),statsPeriod:null===(t=he.datetime)||void 0===t?void 0:t.period};(0,Z.S9)((0,a.t)("Added widget.")),Ve(Te.selectedDashboard.value,s)}(t);else{if(Oe){var i;let e=[...p.widgets];const s=Re(),r={...t,id:Oe.id};return(0,U.I_)(Oe.displayType)!==(0,U.I_)(t.displayType)?(e[s]=(0,U.W8)(r),e=(0,U.Bb)(e)):e[s]=r,N(e),(0,Z.S9)((0,a.t)("Updated widget.")),Ve(null!=ee?ee:Q.i0),void(0,I.Z)("dashboards_views.widget_builder.save",{organization:b,data_set:null!==(i=t.widgetType)&&void 0!==i?i:W.l9.DISCOVER,new_widget:!1})}N([...p.widgets,t]),(0,Z.S9)((0,a.t)("Added widget.")),Ve(null!=ee?ee:Q.i0),(0,I.Z)("dashboards_views.widget_builder.save",{organization:b,data_set:null!==(e=t.widgetType)&&void 0!==e?e:W.l9.DISCOVER,new_widget:!0})}},onDelete:function(){if(!ce)return;we(!0);let e=[...p.widgets];const t=Re();e.splice(t,1),e=(0,U.Bb)(e),N(e),M.push(_e)},invalidForm:!(!fe||Te.selectedDashboard)})]}),(0,Y.tZ)(Qt,{children:(0,Y.tZ)(Rt,{organization:b,widgetBuilderNewDesign:oe,onWidgetSelect:e=>{Be(e.title),Se((0,$.v)(e.widgetType||W.l9.DISCOVER)),xe({...Te,...e,dataSet:e.widgetType?Vt[e.widgetType]:Q.qg.EVENTS,userHasModified:!1})},bypassOverwriteModal:!Te.userHasModified})})]})]})})})}Mt.displayName="WidgetBuilder";const Ut=(0,P.Z)((0,M.Z)(Mt)),Wt=(0,d.Z)(n.JH,{target:"e1rwomk16"})({name:"1hcx8jb",styles:"padding:0"}),Ht=(0,d.Z)(A.Z,{target:"e1rwomk15"})("margin-bottom:",(0,N.Z)(2),";"),$t=(0,d.Z)(C.Z,{target:"e1rwomk14"})("gap:",(0,N.Z)(4),";max-width:100%;"),Xt=(0,d.Z)(q.uT,{target:"e1rwomk13"})("&&{gap:0;padding:0;}grid-template-rows:1fr;@media (min-width: ",(e=>e.theme.breakpoints.large),"){grid-template-columns:minmax(100px, auto) 400px;}@media (min-width: ",(e=>e.theme.breakpoints.xlarge),"){grid-template-columns:1fr;}"),Gt=(0,d.Z)(q.or,{target:"e1rwomk12"})("max-width:1000px;flex:1;padding:",(0,N.Z)(4)," ",(0,N.Z)(2),";@media (min-width: ",(e=>e.theme.breakpoints.medium),"){padding:",(0,N.Z)(4),";}@media (max-width: calc(",(e=>e.theme.breakpoints.large)," + ",(0,N.Z)(4),")){",B.Z,"{width:calc(100% - ",(0,N.Z)(4),");}}"),Qt=(0,d.Z)(q.MF,{target:"e1rwomk11"})("padding:",(0,N.Z)(4)," ",(0,N.Z)(2),";@media (max-width: ",(e=>e.theme.breakpoints.large),"){border-top:1px solid ",(e=>e.theme.gray200),";grid-row:2/2;grid-column:1/-1;max-width:100%;}@media (min-width: ",(e=>e.theme.breakpoints.large),"){border-left:1px solid ",(e=>e.theme.gray200),";padding-right:",(0,N.Z)(4),";max-width:400px;}"),Yt=(0,d.Z)("div",{target:"e1rwomk10"})("display:flex;flex-direction:column;@media (max-width: ",(e=>e.theme.breakpoints.large),"){grid-column:1/-1;}");function Jt(e){const t=(0,o.Z)();return(0,Y.tZ)(s.Z,{features:["new-widget-builder-experience-design","dashboards-edit"],organization:t,renderDisabled:()=>(0,Y.tZ)(n.JH,{children:(0,Y.tZ)(r.Z,{type:"warning",children:(0,a.t)("You don't have access to this feature")})}),children:(0,Y.tZ)(Ut,{...e,organization:t})})}Jt.displayName="WidgetBuilderContainer";const Kt=Jt},"./app/views/dashboardsV2/widgetBuilder/widgetLibrary/card.tsx":(e,t,i)=>{i.d(t,{Z:()=>o});var s=i("../node_modules/@emotion/styled/base/dist/emotion-styled-base.browser.esm.js"),r=i("./app/styles/space.tsx"),a=i("./app/views/dashboardsV2/widgetLibrary/widgetCard.tsx"),n=i("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");function o(e){let{widget:t,iconColor:i}=e;const{title:s,description:r,displayType:o}=t,g=(0,a.T)(o);return(0,n.BX)(d,{children:[(0,n.tZ)(p,{backgroundColor:i,children:(0,n.tZ)(g,{color:"white"})}),(0,n.BX)(l,{children:[(0,n.tZ)(u,{children:s}),(0,n.tZ)(c,{children:r})]})]})}o.displayName="Card";const d=(0,s.Z)("div",{target:"e1kr3ej04"})("display:flex;flex-direction:row;gap:",(0,r.Z)(1),";"),l=(0,s.Z)("div",{target:"e1kr3ej03"})({name:"1fttcpj",styles:"display:flex;flex-direction:column"}),u=(0,s.Z)("div",{target:"e1kr3ej02"})("font-size:",(e=>e.theme.fontSizeLarge),";font-weight:500;margin-bottom:0;color:",(e=>e.theme.gray500),";"),c=(0,s.Z)("small",{target:"e1kr3ej01"})("color:",(e=>e.theme.gray300),";"),p=(0,s.Z)("div",{target:"e1kr3ej00"})("display:flex;justify-content:center;align-items:center;padding:",(0,r.Z)(1),";min-width:40px;height:40px;border-radius:",(e=>e.theme.borderRadius),";background:",(e=>e.backgroundColor),";")},"./app/views/dashboardsV2/widgetLibrary/data.tsx":(e,t,i)=>{i.d(t,{P:()=>o,c:()=>n});var s=i("./app/locale.tsx"),r=i("./app/utils/discover/types.tsx"),a=i("./app/views/dashboardsV2/types.tsx");const n=[{id:void 0,title:(0,s.t)("Duration Distribution"),description:(0,s.t)("Compare transaction durations across different percentiles."),displayType:a.FO.LINE,widgetType:a.l9.DISCOVER,interval:"5m",queries:[{name:"",conditions:"event.type:transaction",fields:["p50(transaction.duration)","p75(transaction.duration)","p95(transaction.duration)"],aggregates:["p50(transaction.duration)","p75(transaction.duration)","p95(transaction.duration)"],columns:[],orderby:""}]},{id:void 0,title:(0,s.t)("High Throughput Transactions"),description:(0,s.t)("Top 5 transactions with the largest volume."),displayType:a.FO.TOP_N,widgetType:a.l9.DISCOVER,interval:"5m",queries:[{name:"",conditions:"event.type:transaction",fields:["transaction","count()"],aggregates:["count()"],columns:["transaction"],orderby:"-count()"}]},{id:void 0,title:(0,s.t)("Crash Rates for Recent Releases"),description:(0,s.t)("Percentage of crashed sessions for latest releases."),displayType:a.FO.LINE,widgetType:a.l9.RELEASE,interval:"5m",limit:8,queries:[{name:"",conditions:"",fields:["crash_rate(session)","release"],aggregates:["crash_rate(session)"],columns:["release"],orderby:"-release"}]},{id:void 0,title:(0,s.t)("Session Health"),description:(0,s.t)("Number of abnormal,crashed, errored and healthy sessions."),displayType:a.FO.TABLE,widgetType:a.l9.RELEASE,interval:"5m",queries:[{name:"",conditions:"",fields:["session.status","sum(session)"],aggregates:["sum(session)"],columns:["session.status"],orderby:""}]},{id:void 0,title:(0,s.t)("LCP by Country"),description:(0,s.t)("Density map showing page load times by country."),displayType:a.FO.WORLD_MAP,widgetType:a.l9.DISCOVER,interval:"5m",queries:[{name:"",conditions:"has:geo.country_code",fields:["p75(measurements.lcp)"],aggregates:["p75(measurements.lcp)"],columns:[],orderby:""}]},{id:void 0,title:(0,s.t)("Miserable Users"),description:(0,s.t)("Unique users who have experienced slow load times."),displayType:a.FO.BIG_NUMBER,widgetType:a.l9.DISCOVER,interval:"5m",queries:[{name:"",conditions:"",fields:["count_miserable(user,300)"],aggregates:["count_miserable(user,300)"],columns:[],orderby:""}]},{id:void 0,title:(0,s.t)("Slow vs. Fast Transactions"),description:(0,s.t)("Percentage breakdown of transaction durations over and under 300ms."),displayType:a.FO.BAR,widgetType:a.l9.DISCOVER,interval:"5m",queries:[{name:"",conditions:"event.type:transaction",fields:["equation|(count_if(transaction.duration,greater,300) / count()) * 100","equation|(count_if(transaction.duration,lessOrEquals,300) / count()) * 100"],aggregates:["equation|(count_if(transaction.duration,greater,300) / count()) * 100","equation|(count_if(transaction.duration,lessOrEquals,300) / count()) * 100"],columns:[],orderby:""}]},{id:void 0,title:(0,s.t)("Issues For Review"),description:(0,s.t)("Most recently seen unresolved issues for review."),displayType:a.FO.TABLE,widgetType:a.l9.ISSUE,interval:"5m",queries:[{name:"",conditions:"is:unresolved is:for_review",fields:["issue","assignee","events","title"],aggregates:[],columns:["issue","assignee","events","title"],orderby:"date"}]},{id:void 0,title:(0,s.t)("Top Unhandled Error Types"),description:(0,s.t)("Most frequently encountered unhandled errors."),displayType:a.FO.TOP_N,widgetType:a.l9.DISCOVER,interval:"5m",queries:[{name:"",conditions:"error.unhandled:true",fields:["error.type","count()"],aggregates:["count()"],columns:["error.type"],orderby:"-count()"}]},{id:void 0,title:(0,s.t)("Users Affected by Errors"),description:(0,s.t)("Footprint of unique users affected by errors."),displayType:a.FO.LINE,widgetType:a.l9.DISCOVER,interval:"5m",queries:[{name:"",conditions:"event.type:error",fields:["count_unique(user)","count()"],aggregates:["count_unique(user)","count()"],columns:[],orderby:""}]}];function o(){return n.map((e=>e.displayType===a.FO.TOP_N?{...e,displayType:a.FO.AREA,limit:r.hY}:e))}},"./app/views/dashboardsV2/widgetLibrary/widgetCard.tsx":(e,t,i)=>{i.d(t,{T:()=>p,Z:()=>b});var s=i("../node_modules/@emotion/styled/base/dist/emotion-styled-base.browser.esm.js"),r=(i("../node_modules/core-js/modules/web.dom-collections.iterator.js"),i("../node_modules/core-js/modules/es.array.includes.js"),i("../node_modules/react/index.js")),a=i("./app/components/panels/index.tsx"),n=i("./app/icons/index.tsx"),o=i("./app/icons/iconGraphArea.tsx"),d=i("./app/icons/iconGraphBar.tsx"),l=i("./app/styles/space.tsx"),u=i("./app/views/dashboardsV2/types.tsx"),c=i("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");function p(e){switch(e){case u.FO.TABLE:return n.dc;case u.FO.WORLD_MAP:return n.vc;case u.FO.BIG_NUMBER:return n.A8;case u.FO.BAR:return d.U;case u.FO.TOP_N:return n.CC;case u.FO.AREA:return o.g;case u.FO.LINE:default:return n.TX}}function g(e){let{selectedWidgets:t,widget:i,setSelectedWidgets:s,"data-test-id":n}=e;const[o,d]=(0,r.useState)(t.includes(i)),l=p(i.displayType);return(0,c.tZ)(f,{"data-test-id":n,selected:o,onClick:()=>{if(o){const e=t.filter((e=>i!==e));s(e)}else{const e=t.slice().concat(i);s(e)}d(!o)},children:(0,c.BX)(a.N,{children:[(0,c.BX)(y,{children:[(0,c.tZ)(l,{size:"xs"}),(0,c.tZ)(m,{children:i.title})]}),(0,c.tZ)(h,{children:i.description})]})})}g.displayName="WidgetLibraryCard";const m=(0,s.Z)("div",{target:"e11j9f793"})("padding-left:",(0,l.Z)(1),";font-size:16px;line-height:140%;color:",(e=>e.theme.gray500),";"),y=(0,s.Z)("div",{target:"e11j9f792"})("padding:",(0,l.Z)(1.5)," ",(0,l.Z)(2),";padding-bottom:",(0,l.Z)(.5),";display:flex;align-items:center;"),h=(0,s.Z)("div",{target:"e11j9f791"})("padding:0 ",(0,l.Z)(1)," ",(0,l.Z)(1.5)," 36px;font-size:14px;line-height:21px;color:",(e=>e.theme.gray300),";"),f=(0,s.Z)(a.s_,{target:"e11j9f790"})("border:",(e=>e.selected?`2px solid ${e.theme.active}`:`1px solid ${e.theme.border}`),";margin:",(e=>e.selected?"-1px":0),";box-sizing:border-box;box-shadow:0px 2px 1px rgba(0, 0, 0, 0.08);cursor:pointer;"),b=g}}]);
//# sourceMappingURL=../sourcemaps/app_views_dashboardsV2_widgetBuilder_index_tsx.7e32f875e690450b9a6e2cf75569a2f8.js.map