"use strict";(globalThis.webpackChunk=globalThis.webpackChunk||[]).push([["app_views_eventsV2_results_tsx"],{"./app/components/charts/eventsChart.tsx":(e,t,s)=>{s.d(t,{Z:()=>q});var r=s("../node_modules/@babel/runtime/helpers/esm/defineProperty.js"),n=(s("../node_modules/core-js/modules/web.dom-collections.iterator.js"),s("../node_modules/core-js/modules/es.array.includes.js"),s("../node_modules/core-js/modules/es.error.cause.js"),s("../node_modules/react/index.js")),o=s("../node_modules/@emotion/react/dist/emotion-element-cbed451f.browser.esm.js"),i=s("../node_modules/lodash/isEqual.js"),a=s.n(i),l=s("./app/components/charts/areaChart.tsx"),d=s("./app/components/charts/barChart.tsx"),c=s("./app/components/charts/chartZoom.tsx"),p=s("./app/components/charts/errorPanel.tsx"),u=s("./app/components/charts/lineChart.tsx"),h=s("./app/components/charts/releaseSeries.tsx"),m=s("./app/components/charts/transitionChart.tsx"),g=s("./app/components/charts/transparentLoadingMask.tsx"),v=s("./app/components/charts/utils.tsx"),y=s("./app/components/charts/worldMapChart.tsx"),f=s("./app/icons/index.tsx"),x=s("./app/locale.tsx"),Z=s("./app/utils.tsx"),w=s("./app/utils/discover/charts.tsx"),b=s("./app/utils/discover/fields.tsx"),C=s("./app/utils/queryString.tsx"),S=s("./app/components/charts/eventsGeoRequest.tsx"),D=s("./app/components/charts/eventsRequest.tsx"),A=s("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");class P extends n.Component{constructor(){super(...arguments),(0,r.Z)(this,"state",{seriesSelection:{},forceUpdate:!1}),(0,r.Z)(this,"handleLegendSelectChanged",(e=>{const{disableableSeries:t=[]}=this.props,{selected:s}=e,r=Object.keys(s).reduce(((e,r)=>{const n=["Releases","Other"].includes(r)||t.includes(r);return e[r]=!n||s[r],e}),{});this.setState({seriesSelection:r,forceUpdate:!0},(()=>this.setState({forceUpdate:!1})))}))}shouldComponentUpdate(e,t){return!(!t.forceUpdate&&a()(this.state.seriesSelection,t.seriesSelection)&&(e.reloading||!e.timeseriesData||a()(this.props.timeseriesData,e.timeseriesData)&&a()(this.props.releaseSeries,e.releaseSeries)&&a()(this.props.previousTimeseriesData,e.previousTimeseriesData)&&a()(this.props.tableData,e.tableData)))}getChartComponent(){const{showDaily:e,timeseriesData:t,yAxis:s,chartComponent:r}=this.props;if((0,Z.ri)(r))return r;if(e)return d.v;if(t.length>1)switch((0,b.fD)(s)){case"line":return u.w;case"area":return l.T;default:throw new Error(`Unknown multi plot type for ${s}`)}return l.T}render(){var e,t;const{theme:s,loading:r,reloading:n,yAxis:o,releaseSeries:i,zoomRenderProps:a,timeseriesData:l,previousTimeseriesData:c,showLegend:p,legendOptions:u,chartOptions:h,currentSeriesNames:m,previousSeriesNames:g,seriesTransformer:f,previousSeriesTransformer:Z,colors:b,height:C,timeframe:S,topEvents:D,tableData:P,fromDiscover:E,...j}=this.props,{seriesSelection:q}=this.state;let z=this.getChartComponent();if(z===y.y){const{data:e,title:t}=(0,v.JT)(P),s=[{seriesName:t,data:e}];return(0,A.tZ)(y.y,{series:s,fromDiscover:E})}z=z;const T=[...m.length>0?m:[(0,x.t)("Current")],...g.length>0?g:[(0,x.t)("Previous")]],_=(0,x.t)("Releases"),N=D&&D+1===l.length;N&&T.push("Other"),Array.isArray(i)&&T.push(_);const V=i&&i[0],R=Array.isArray(i)&&(null==V||null===(e=V.markLine)||void 0===e?void 0:e.data)&&V.markLine.data.length>=v.XO,k=Array.isArray(i)&&0===Object.keys(q).length&&R?{[_]:!1}:q,O=p?{right:16,top:12,data:T,selected:k,...null!=u?u:{}}:void 0;let L=Array.isArray(i)?[...l,...i]:l,Q=c;var F;f&&(L=f(L)),Z&&(Q=null===(F=Q)||void 0===F?void 0:F.map((e=>Z(e))));const I=l.length?null!==(t=null==b?void 0:b.slice(0,L.length))&&void 0!==t?t:[...s.charts.getColorPalette(l.length-2-(N?1:0))]:void 0;I&&I.length&&N&&I.push(s.chartOther);const B={colors:I,grid:{left:"24px",right:"24px",top:"32px",bottom:"12px"},seriesOptions:{showSymbol:!1},tooltip:{trigger:"axis",truncate:80,valueFormatter:e=>(0,w.CX)(e,o)},xAxis:S?{min:S.start,max:S.end}:void 0,yAxis:{axisLabel:{color:s.chartLabel,formatter:e=>(0,w.gu)(e,o)}},...null!=h?h:{},animation:typeof z!=typeof d.v&&void 0};return(0,A.tZ)(z,{...j,...a,...B,legend:O,onLegendSelectChanged:this.handleLegendSelectChanged,series:L,previousPeriod:Q||void 0,height:C})}}P.displayName="Chart";const E=(0,o.d)(P);class j extends n.Component{isStacked(){const{topEvents:e,yAxis:t}=this.props;return"number"==typeof e&&e>0||Array.isArray(t)&&t.length>1}render(){const{api:e,organization:t,period:s,utc:r,query:o,router:i,start:a,end:l,projects:d,environments:u,showLegend:Z,minutesThresholdToDisplaySeconds:w,yAxis:P,disablePrevious:j,disableReleases:q,emphasizeReleases:z,currentSeriesName:T,previousSeriesName:_,seriesTransformer:N,previousSeriesTransformer:V,field:R,interval:k,showDaily:O,topEvents:L,orderby:Q,confirmedQuery:F,colors:I,chartHeader:B,legendOptions:M,chartOptions:U,preserveReleaseQueryParams:Y,releaseQueryExtra:K,disableableSeries:H,chartComponent:X,usePageZoom:$,height:G,withoutZerofill:W,fromDiscover:J,...ee}=this.props,te=!j&&!a&&!l,se=(0,C.qP)(P),re=se.map((e=>{let t=e&&(0,b.GO)(e)?(0,b.vp)(e):e;return t&&t.length>60&&(t=t.substr(0,60)+"..."),t})),ne=_?[_]:re.map((e=>(0,x.t)("previous %s",e))),oe=T?[T]:re,ie=O?"1d":k||(0,v.ZS)(this.props,"high");let ae=e=>{let{zoomRenderProps:t,releaseSeries:s,errored:r,loading:o,reloading:i,results:a,timeseriesData:l,previousTimeseriesData:d,timeframe:c,tableData:u}=e;if(r)return(0,A.tZ)(p.Z,{children:(0,A.tZ)(f.FC,{color:"gray300",size:"lg"})});const h=a||l;return(0,A.BX)(m.Z,{loading:o,reloading:i,height:G?`${G}px`:void 0,children:[(0,A.tZ)(g.Z,{visible:i}),n.isValidElement(B)&&B,(0,A.tZ)(E,{zoomRenderProps:t,loading:o,reloading:i,showLegend:Z,minutesThresholdToDisplaySeconds:w,releaseSeries:s||[],timeseriesData:null!=h?h:[],previousTimeseriesData:d,currentSeriesNames:oe,previousSeriesNames:ne,seriesTransformer:N,previousSeriesTransformer:V,stacked:this.isStacked(),yAxis:se[0],showDaily:O,colors:I,legendOptions:M,chartOptions:U,disableableSeries:H,chartComponent:X,height:G,timeframe:c,topEvents:L,tableData:null!=u?u:[],fromDiscover:J})]})};if(!q){const e=ae;ae=t=>(0,A.tZ)(h.Z,{utc:r,period:s,start:a,end:l,projects:d,environments:u,emphasizeReleases:z,preserveQueryParams:Y,queryExtra:K,children:s=>{let{releaseSeries:r}=s;return e({...t,releaseSeries:r})}})}return(0,A.tZ)(c.Z,{router:i,period:s,start:a,end:l,utc:r,usePageDate:$,...ee,children:r=>X===y.y?(0,A.tZ)(S.Z,{api:e,organization:t,yAxis:P,query:o,orderby:Q,projects:d,period:s,start:a,end:l,environments:u,referrer:ee.referrer,children:e=>{let{errored:t,loading:s,reloading:n,tableData:o}=e;return ae({errored:t,loading:s,reloading:n,zoomRenderProps:r,tableData:o})}}):(0,A.tZ)(D.Z,{...ee,api:e,organization:t,period:s,project:d,environment:u,start:a,end:l,interval:ie,query:o,includePrevious:te,currentSeriesNames:oe,previousSeriesNames:ne,yAxis:P,field:R,orderby:Q,topEvents:L,confirmedQuery:F,partial:!0,withoutZerofill:W&&!this.isStacked(),userModified:(0,C.ro)(i.location.query.userModified),children:e=>ae({...e,zoomRenderProps:r})})})}}j.displayName="EventsChart";const q=j},"./app/components/charts/optionSelector.tsx":(e,t,s)=>{s.d(t,{Z:()=>u});var r=s("../node_modules/@emotion/styled/base/dist/emotion-styled-base.browser.esm.js"),n=(s("../node_modules/core-js/modules/es.array.includes.js"),s("../node_modules/react/index.js")),o=s("./app/components/featureBadge.tsx"),i=s("./app/components/forms/compactSelect.tsx"),a=s("./app/components/truncate.tsx"),l=s("./app/utils.tsx"),d=s("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");function c(e){let{options:t,onChange:s,selected:r,title:o,featureType:c,multiple:u,...h}=e;const m=(0,n.useMemo)((()=>t.map((e=>({...e,label:(0,d.tZ)(a.Z,{value:String(e.label),maxLength:60,expandDirection:"left"})})))),[t]);return(0,d.tZ)(i.Z,{options:m,value:r,onChange:function(e){s(u?e.map((e=>e.value)):e.value)},isOptionDisabled:function(e){return e.disabled||u&&3===r.length&&!r.includes(e.value)},multiple:u,triggerProps:{size:"small",borderless:!0,prefix:(0,d.BX)(n.Fragment,{children:[o,(0,l.ri)(c)?(0,d.tZ)(p,{type:c}):null]})},placement:"bottom right",...h})}c.displayName="OptionSelector";const p=(0,r.Z)(o.Z,{target:"e1a4edto0"})({name:"6og82r",styles:"margin-left:0px"}),u=c},"./app/components/charts/releaseSeries.tsx":(e,t,s)=>{s.d(t,{Z:()=>S});var r=s("../node_modules/@babel/runtime/helpers/esm/defineProperty.js"),n=(s("../node_modules/core-js/modules/web.dom-collections.iterator.js"),s("../node_modules/core-js/modules/es.array.includes.js"),s("../node_modules/react/index.js")),o=s("../node_modules/react-router/es/index.js"),i=s("../node_modules/@emotion/react/dist/emotion-element-cbed451f.browser.esm.js"),a=s("../node_modules/lodash/isEqual.js"),l=s.n(a),d=s("../node_modules/lodash/memoize.js"),c=s.n(d),p=s("../node_modules/lodash/partition.js"),u=s.n(p),h=s("./app/actionCreators/indicator.tsx"),m=s("./app/components/charts/components/markLine.tsx"),g=s("./app/locale.tsx"),v=s("./app/utils.tsx"),y=s("./app/utils/dates.tsx"),f=s("./app/utils/formatters.tsx"),x=s("./app/utils/parseLinkHeader.tsx"),Z=s("./app/utils/withApi.tsx"),w=s("./app/utils/withOrganization.tsx");function b(e,t,s){const r={};return Object.keys(s).forEach((e=>{let t=s[e];!t||"start"!==e&&"end"!==e||(t=(0,y.v5)(t)),t&&(r[e]=t)})),e.clear(),e.requestPromise(`/organizations/${t.slug}/releases/stats/`,{includeAllArgs:!0,method:"GET",query:r})}class C extends n.Component{constructor(){var e;super(...arguments),e=this,(0,r.Z)(this,"state",{releases:null,releaseSeries:[]}),(0,r.Z)(this,"_isMounted",!1),(0,r.Z)(this,"getOrganizationReleasesMemoized",c()(((e,t,s)=>b(e,t,s)),((e,t,s)=>Object.values(s).map((e=>JSON.stringify(e))).join("-")))),(0,r.Z)(this,"getReleaseSeries",(function(t){let s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const{organization:r,router:n,tooltip:o,environments:i,start:a,end:l,period:d,preserveQueryParams:c,queryExtra:p,theme:u}=e.props,h={...p};r.features.includes("global-views")&&(h.project=n.location.query.project),c&&(h.environment=[...i],h.start=a?(0,y.v5)(a):void 0,h.end=l?(0,y.v5)(l):void 0,h.statsPeriod=d||void 0);const x=(0,m.Z)({animation:!1,lineStyle:{color:u.purple300,opacity:.3,type:"solid",...s},label:{show:!1},data:t.map((e=>({xAxis:+new Date(e.date),name:(0,f.ko)(e.version,!0),value:(0,f.ko)(e.version,!0),onClick:()=>{n.push({pathname:`/organizations/${r.slug}/releases/${e.version}/`,query:h})},label:{formatter:()=>(0,f.ko)(e.version,!0)}}))),tooltip:o||{trigger:"item",formatter:t=>{let{data:s}=t;const r=(0,y.L0)(s.value,"MMM D, YYYY LT",{local:!e.props.utc}),n=(0,v.YU)((0,f.ko)(s.name,!0));return['<div class="tooltip-series">',`<div><span class="tooltip-label"><strong>${(0,g.t)("Release")}</strong></span> ${n}</div>`,"</div>",'<div class="tooltip-date">',r,"</div>","</div>",'<div class="tooltip-arrow"></div>'].join("")}}});return{seriesName:"Releases",color:u.purple200,data:[],markLine:x}}))}componentDidMount(){this._isMounted=!0;const{releases:e}=this.props;e?this.setReleasesWithSeries(e):this.fetchData()}componentDidUpdate(e){l()(e.projects,this.props.projects)&&l()(e.environments,this.props.environments)&&l()(e.start,this.props.start)&&l()(e.end,this.props.end)&&l()(e.period,this.props.period)&&l()(e.query,this.props.query)?l()(e.emphasizeReleases,this.props.emphasizeReleases)||this.setReleasesWithSeries(this.state.releases):this.fetchData()}componentWillUnmount(){this._isMounted=!1,this.props.api.clear()}async fetchData(){const{api:e,organization:t,projects:s,environments:r,period:n,start:o,end:i,memoized:a,query:l}=this.props,d={start:o,end:i,project:s,environment:r,statsPeriod:n,query:l};let c=!0;const p=[];for(;c;)try{const s=a?this.getOrganizationReleasesMemoized:b,[r,,n]=await s(e,t,d);p.push(...r),this._isMounted&&this.setReleasesWithSeries(p);const o=null==n?void 0:n.getResponseHeader("Link");if(o){var u,m;const e=(0,x.Z)(o);c=null!==(u=null==e||null===(m=e.next)||void 0===m?void 0:m.results)&&void 0!==u&&u,d.cursor=e.next.cursor}else c=!1}catch{(0,h.Iw)((0,g.t)("Error fetching releases")),c=!1}}setReleasesWithSeries(e){const{emphasizeReleases:t=[]}=this.props,s=[];if(t.length){const[r,n]=u()(e,(e=>!t.includes(e.version)));r.length&&s.push(this.getReleaseSeries(r,{type:"dotted"})),n.length&&s.push(this.getReleaseSeries(n,{opacity:.8}))}else s.push(this.getReleaseSeries(e));this.setState({releases:e,releaseSeries:s})}render(){const{children:e}=this.props;return e({releases:this.state.releases,releaseSeries:this.state.releaseSeries})}}C.displayName="ReleaseSeries";const S=(0,o.withRouter)((0,w.Z)((0,Z.Z)((0,i.d)(C))))},"./app/components/dataExport.tsx":(e,t,s)=>{s.d(t,{ZP:()=>g,tD:()=>h}),s("../node_modules/core-js/modules/web.dom-collections.iterator.js");var r=s("../node_modules/react/index.js"),n=s("../node_modules/lodash/debounce.js"),o=s.n(n),i=s("./app/actionCreators/indicator.tsx"),a=s("./app/components/acl/feature.tsx"),l=s("./app/components/button.tsx"),d=s("./app/locale.tsx"),c=s("./app/utils/withApi.tsx"),p=s("./app/utils/withOrganization.tsx"),u=s("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");let h;function m(e){let{api:t,children:s,disabled:n,organization:c,payload:p,icon:h}=e;const[m,g]=(0,r.useState)(!1);(0,r.useEffect)((()=>{m&&g(!1)}),[p.queryType,p.queryInfo]);const v=(0,r.useCallback)((()=>{g(!0),t.requestPromise(`/organizations/${c.slug}/data-export/`,{includeAllArgs:!0,method:"POST",data:{query_type:p.queryType,query_info:p.queryInfo}}).then((e=>{let[t,s,r]=e;(0,i.S9)(201===(null==r?void 0:r.status)?(0,d.t)("Sit tight. We'll shoot you an email when your data is ready for download."):(0,d.t)("It looks like we're already working on it. Sit tight, we'll email you."))})).catch((e=>{var t,s;const r=null!==(t=null==e||null===(s=e.responseJSON)||void 0===s?void 0:s.detail)&&void 0!==t?t:"We tried our hardest, but we couldn't export your data. Give it another go.";(0,i.Iw)((0,d.t)(r)),g(!1)}))}),[p.queryInfo,p.queryType,c.slug,t]);return(0,u.tZ)(a.Z,{features:["organizations:discover-query"],children:m?(0,u.tZ)(l.ZP,{size:"small",priority:"default",title:"You can get on with your life. We'll email you when your data's ready.",disabled:!0,icon:h,children:(0,d.t)("We're working on it...")}):(0,u.tZ)(l.ZP,{onClick:o()(v,500),disabled:n||!1,size:"small",priority:"default",title:"Put your data to work. Start your export and we'll email you when it's finished.",icon:h,children:s||(0,d.t)("Export All to CSV")})})}!function(e){e.IssuesByTag="Issues-by-Tag",e.Discover="Discover"}(h||(h={})),m.displayName="DataExport";const g=(0,c.Z)((0,p.Z)(m))},"./app/utils/performance/spanOperationBreakdowns/constants.tsx":(e,t,s)=>{s.d(t,{$:()=>r});const r=["spans.browser","spans.http","spans.db","spans.resource"]},"./app/views/eventsV2/breadcrumb.tsx":(e,t,s)=>{s.d(t,{Z:()=>l}),s("../node_modules/core-js/modules/es.array.includes.js");var r=s("./app/components/breadcrumbs.tsx"),n=s("./app/locale.tsx"),o=s("./app/utils/discover/urls.tsx"),i=s("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");function a(e){let{eventView:t,event:s,organization:a,location:l}=e;const d=[],c=a.features.includes("discover-query")?{pathname:(0,o.zR)(a),query:{...l.query,...t.generateBlankQueryStringObject(),...t.getPageFiltersQuery()}}:null;return d.push({to:c,label:(0,n.t)("Discover")}),t&&t.isValid()&&d.push({to:t.getResultsViewUrlTarget(a.slug),label:t.name||""}),s&&d.push({label:(0,n.t)("Event Detail")}),(0,i.tZ)(r.Z,{crumbs:d})}a.displayName="DiscoverBreadcrumb";const l=a},"./app/views/eventsV2/results.tsx":(e,t,s)=>{s.r(t),s.d(t,{default:()=>It});var r=s("../node_modules/@babel/runtime/helpers/esm/defineProperty.js"),n=s("../node_modules/@emotion/styled/base/dist/emotion-styled-base.browser.esm.js"),o=(s("../node_modules/core-js/modules/web.dom-collections.iterator.js"),s("../node_modules/core-js/modules/es.array.includes.js"),s("../node_modules/core-js/modules/es.string.replace.js"),s("../node_modules/react/index.js")),i=s("../node_modules/react-router/es/index.js"),a=s("../node_modules/@sentry/hub/esm/exports.js"),l=s("../node_modules/lodash/isEqual.js"),d=s.n(l),c=s("../node_modules/lodash/omit.js"),p=s.n(c),u=s("./app/actionCreators/discoverSavedQueries.tsx"),h=s("./app/actionCreators/events.tsx"),m=s("./app/actionCreators/projects.tsx"),g=s("./app/actionCreators/tags.tsx"),v=s("./app/api.tsx"),y=s("./app/components/alert.tsx"),f=s("./app/components/asyncComponent.tsx"),x=s("./app/components/confirm.tsx"),Z=s("./app/components/datePageFilter.tsx"),w=s("./app/components/environmentPageFilter.tsx"),b=s("./app/components/events/searchBar.tsx"),C=s("./app/components/layouts/thirds.tsx"),S=s("./app/components/noProjectMessage.tsx"),D=s("./app/components/organizations/pageFilterBar.tsx"),A=s("./app/components/organizations/pageFilters/container.tsx"),P=s("./app/components/organizations/pageFilters/parse.tsx"),E=s("./app/components/projectPageFilter.tsx"),j=s("./app/components/sentryDocumentTitle.tsx"),q=s("./app/constants/index.tsx"),z=s("./app/locale.tsx"),T=s("./app/styles/organization.tsx"),_=s("./app/styles/space.tsx"),N=s("./app/utils.tsx"),V=s("./app/utils/analytics.tsx"),R=s("./app/utils/discover/eventView.tsx"),k=s("./app/utils/discover/fields.tsx"),O=s("./app/utils/discover/types.tsx"),L=s("./app/utils/localStorage.tsx"),Q=s("./app/utils/queryString.tsx"),F=s("./app/utils/withApi.tsx"),I=s("./app/utils/withOrganization.tsx"),B=s("./app/utils/withPageFilters.tsx"),M=s("./app/views/performance/utils.tsx"),U=s("./app/views/eventsV2/data.tsx"),Y=s("./app/components/charts/barChart.tsx"),K=s("./app/components/charts/eventsChart.tsx"),H=s("./app/components/charts/utils.tsx"),X=s("./app/components/charts/worldMapChart.tsx"),$=s("./app/components/panels/index.tsx"),G=s("./app/components/placeholder.tsx"),W=s("./app/utils/dates.tsx"),J=s("./app/utils/getDynamicText.tsx"),ee=s("./app/components/charts/optionSelector.tsx"),te=s("./app/components/charts/styles.tsx"),se=s("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");function re(e){let{total:t,yAxisValue:s,yAxisOptions:r,onAxisChange:n,displayMode:o,displayOptions:i,onDisplayChange:a,onTopEventsChange:l,topEvents:d}=e;const c=[];c.push((0,se.tZ)(te.OT,{children:(0,z.t)("Total Events")},"total-label")),c.push(null===t?(0,se.tZ)(te.uN,{"data-test-id":"loading-placeholder",children:"—"},"total-value"):(0,se.tZ)(te.uN,{children:t.toLocaleString()},"total-value"));const p=[];for(let e=1;e<=10;e++)p.push({value:e.toString(),label:e.toString()});return(0,se.BX)(te.xx,{children:[(0,se.tZ)(te.m2,{children:c}),(0,se.BX)(te.m2,{children:[(0,se.tZ)(ee.Z,{title:(0,z.t)("Display"),selected:o,options:i,onChange:a}),O.v2.includes(o)&&(0,se.tZ)(ee.Z,{title:(0,z.t)("Limit"),selected:d,options:p,onChange:l}),O.v2.includes(o)?(0,se.tZ)(ee.Z,{title:(0,z.t)("Y-Axis"),selected:s[0],options:r,onChange:e=>n([e])}):(0,se.tZ)(ee.Z,{multiple:!0,isClearable:!0,menuTitle:r.length>3?(0,z.t)("Select up to 3 options"):(0,z.t)("Y-axis"),title:(0,z.t)("Y-Axis"),selected:s,options:r,onChange:n})]})]})}re.displayName="ChartFooter";class ne extends o.Component{shouldComponentUpdate(e){const{eventView:t,...s}=this.props,{eventView:r,...n}=e;return!t.isEqualTo(r)||!d()(s,n)}render(){const{api:e,eventView:t,location:s,organization:r,router:n,confirmedQuery:i,yAxisValue:a}=this.props,l=r.features.includes("performance-chart-interpolation"),d=t.getPageFilters(),c=d.datetime.start?(0,W.hC)(d.datetime.start):null,p=d.datetime.end?(0,W.hC)(d.datetime.end):null,{utc:u}=(0,P.fK)(s.query),h=t.getEventsAPIPayload(s),m=t.getDisplayMode(),g=m===O.DC.TOP5||m===O.DC.DAILYTOP5,v=m===O.DC.DEFAULT||m===O.DC.TOP5,y=m===O.DC.DAILYTOP5||m===O.DC.DAILY,f=m===O.DC.PREVIOUS,x=`api.discover.${m}-chart`,Z=t.topEvents?parseInt(t.topEvents,10):O.hY,w=m===O.DC.WORLDMAP?X.y:m===O.DC.BAR?Y.v:void 0,b=m===O.DC.BAR?(0,H.ZS)({start:c,end:p,period:d.datetime.period,utc:"true"===u},"low"):t.interval,C=a.map(k.bQ),S=[...C,...C.map(H.TE)];return(0,se.tZ)(o.Fragment,{children:(0,J.Z)({value:(0,se.tZ)(K.Z,{api:e,router:n,query:h.query,organization:r,showLegend:!0,yAxis:a,projects:d.projects,environments:d.environments,start:c,end:p,period:d.datetime.period,disablePrevious:!f,disableReleases:!v,field:g?h.field:void 0,interval:b,showDaily:y,topEvents:g?Z:void 0,orderby:g?(0,Q.ro)(h.sort):void 0,utc:"true"===u,confirmedQuery:i,withoutZerofill:l,chartComponent:w,referrer:x,fromDiscover:!0,disableableSeries:S}),fixed:(0,se.tZ)(G.Z,{height:"200px",testId:"skeleton-ui"})})})}}ne.displayName="ResultsChart";class oe extends o.Component{constructor(){super(...arguments),(0,r.Z)(this,"state",{yAxisOptions:this.getYAxisOptions(this.props.eventView)})}componentWillReceiveProps(e){const t=this.getYAxisOptions(this.props.eventView),s=this.getYAxisOptions(e.eventView);(0,N.Sp)(t,s,!0)||this.setState({yAxisOptions:s})}shouldComponentUpdate(e){const{eventView:t,...s}=this.props,{eventView:r,...n}=e;return!t.isEqualTo(r)||this.props.confirmedQuery!==e.confirmedQuery||!d()(s,n)}getYAxisOptions(e){const t=e.getYAxisOptions();return e.getDisplayMode()===O.DC.WORLDMAP?t.filter((e=>{let{value:t}=e;return!(0,k.GO)(t)})):t}render(){var e;const{api:t,eventView:s,location:r,router:n,total:o,onAxisChange:i,onDisplayChange:a,onTopEventsChange:l,organization:d,confirmedQuery:c,yAxis:p}=this.props,{yAxisOptions:u}=this.state,h=d.features.includes("discover-query"),m=s.getDisplayOptions().filter((e=>!(O.v2.includes(e.value)&&!h))).map((e=>(O.v2.includes(e.value)&&(e.label=O.DC.TOP5===e.value?"Top Period":"Top Daily"),p.length>1&&!O.px.includes(e.value)?{...e,disabled:!0,tooltip:(0,z.t)("Change the Y-Axis dropdown to display only 1 function to use this view.")}:e)));return(0,se.BX)(ae,{children:[p.length>0&&(0,se.tZ)(ne,{api:t,eventView:s,location:r,organization:d,router:n,confirmedQuery:c,yAxisValue:p})||(0,se.tZ)(le,{children:(0,z.t)("No Y-Axis selected.")}),(0,se.tZ)(re,{organization:d,total:o,yAxisValue:p,yAxisOptions:u,onAxisChange:i,displayOptions:m,displayMode:s.getDisplayMode(),onDisplayChange:a,onTopEventsChange:l,topEvents:null!==(e=s.topEvents)&&void 0!==e?e:O.hY.toString()})]})}}oe.displayName="ResultsChartContainer";const ie=(0,F.Z)(oe),ae=(0,n.Z)($.s_,{target:"eihhj0r1"})("@media (min-width: ",(e=>e.theme.breakpoints.large),"){margin:0;}"),le=(0,n.Z)("div",{target:"eihhj0r0"})("display:flex;flex-direction:column;justify-content:center;align-items:center;flex:1;flex-shrink:0;overflow:hidden;height:",(e=>e.height||"200px"),";position:relative;border-color:transparent;margin-bottom:0;color:",(e=>e.theme.gray300),";font-size:",(e=>e.theme.fontSizeExtraLarge),";");var de=s("./app/components/timeSince.tsx"),ce=s("./app/views/eventsV2/breadcrumb.tsx"),pe=s("./app/components/editableText.tsx"),ue=s("./app/utils/useApi.tsx"),he=s("./app/views/eventsV2/savedQuery/utils.tsx");const me=(0,z.t)("Untitled query");function ge(e){let{organization:t,eventView:s,savedQuery:r}=e;const n=(0,ue.Z)(),o=s.name||me;return(0,se.tZ)(ve,{"data-test-id":`discover2-query-name-${o}`,children:(0,se.tZ)(pe.Z,{value:o,onChange:function(e){if(!r||r.name===e)return;const o=R.ZP.fromSavedQuery({...r,name:e});(0,he.pb)(n,t,o).then((r=>{const n=s.clone();n.name=e,i.browserHistory.push(n.getResultsViewUrlTarget(t.slug))}))},isDisabled:!s.id,errorMessage:(0,z.t)("Please set a name for this query")})})}ge.displayName="EventInputName";const ve=(0,n.Z)(C.Dx,{target:"emb7zth0"})({name:"12brwd0",styles:"overflow:unset"}),ye=ge;var fe=s("./app/components/acl/feature.tsx"),xe=s("./app/components/acl/featureDisabled.tsx"),Ze=s("./app/components/assistant/guideAnchor.tsx"),we=s("./app/components/banner.tsx"),be=s("./app/components/button.tsx"),Ce=s("./app/components/buttonBar.tsx"),Se=s("./app/components/createAlertButton.tsx"),De=s("./app/components/dropdownControl.tsx"),Ae=s("./app/components/forms/controls/input.tsx"),Pe=s("./app/components/hovercard.tsx"),Ee=s("./app/icons/index.tsx"),je=s("./app/utils/discover/urls.tsx"),qe=s("./app/utils/withProjects.tsx"),ze=s("./app/views/eventsV2/utils.tsx");class Te extends o.PureComponent{constructor(){super(...arguments),(0,r.Z)(this,"state",{isNewQuery:!0,isEditingQuery:!1,queryName:""}),(0,r.Z)(this,"onBlurInput",(e=>{const t=e.target;this.setState({queryName:t.value})})),(0,r.Z)(this,"onChangeInput",(e=>{const t=e.target;this.setState({queryName:t.value})})),(0,r.Z)(this,"handleCreateQuery",(e=>{e.preventDefault(),e.stopPropagation();const{api:t,organization:s,eventView:r,yAxis:n}=this.props;if(!this.state.queryName)return;const o=r.clone();o.name=this.state.queryName;const a=!r.id;(0,he.b2)(t,s,o,n,a).then((e=>{const t=R.ZP.fromSavedQuery(e);we.Z.dismiss("discover"),this.setState({queryName:""}),i.browserHistory.push(t.getResultsViewUrlTarget(s.slug))}))})),(0,r.Z)(this,"handleUpdateQuery",(e=>{e.preventDefault(),e.stopPropagation();const{api:t,organization:s,eventView:r,updateCallback:n,yAxis:o}=this.props;(0,he.O$)(t,s,r,o).then((e=>{const t=R.ZP.fromSavedQuery(e);this.setState({queryName:""}),i.browserHistory.push(t.getResultsViewShortUrlTarget(s.slug)),n()}))})),(0,r.Z)(this,"handleDeleteQuery",(e=>{e.preventDefault(),e.stopPropagation();const{api:t,organization:s,eventView:r}=this.props;(0,he.Uc)(t,s,r).then((()=>{i.browserHistory.push({pathname:(0,je.zR)(s),query:{}})}))})),(0,r.Z)(this,"handleCreateAlertSuccess",(()=>{const{organization:e}=this.props;(0,V.ec)({eventKey:"discover_v2.create_alert_clicked",eventName:"Discoverv2: Create alert clicked",status:"success",organization_id:e.id,url:window.location.href})}))}static getDerivedStateFromProps(e,t){const{eventView:s,savedQuery:r,savedQueryLoading:n,yAxis:o}=e;if(!r)return{isNewQuery:!0,isEditingQuery:!1,queryName:t.queryName||""};if(n)return t;const i=R.ZP.fromSavedQuery(r);if(i.id!==s.id)return{isNewQuery:!1,isEditingQuery:!1,queryName:""};const a=s.isEqualTo(i),l=d()(o,r.yAxis?"string"==typeof r.yAxis?[r.yAxis]:r.yAxis:["count()"]);return{isNewQuery:!1,isEditingQuery:!a||!l,queryName:t.queryName||""}}renderButtonSaveAs(e){const{queryName:t}=this.state;return(0,se.tZ)(De.ZP,{alignRight:!0,menuWidth:"220px",priority:"default",buttonProps:{"aria-label":(0,z.t)("Save as"),showChevron:!1,icon:(0,se.tZ)(Ee.GK,{}),disabled:e},label:`${(0,z.t)("Save as")}…`,children:(0,se.BX)(Ne,{onClick:Te.stopEventPropagation,children:[(0,se.tZ)(Ve,{type:"text",name:"query_name",placeholder:(0,z.t)("Display name"),value:t||"",onBlur:this.onBlurInput,onChange:this.onChangeInput,disabled:e}),(0,se.tZ)(be.ZP,{onClick:this.handleCreateQuery,priority:"primary",disabled:e||!this.state.queryName,style:{width:"100%"},children:(0,z.t)("Save for Org")})]})})}renderButtonSave(e){const{isNewQuery:t,isEditingQuery:s}=this.state;return t||s?!t&&s?(0,se.BX)(o.Fragment,{children:[(0,se.BX)(be.ZP,{onClick:this.handleUpdateQuery,"data-test-id":"discover2-savedquery-button-update",disabled:e,children:[(0,se.tZ)(Re,{}),(0,z.t)("Save Changes")]}),this.renderButtonSaveAs(e)]}):this.renderButtonSaveAs(e):(0,se.tZ)(be.ZP,{icon:(0,se.tZ)(Ee.GK,{color:"yellow100",isSolid:!0,size:"sm"}),disabled:!0,"data-test-id":"discover2-savedquery-button-saved",children:(0,z.t)("Saved for Org")})}renderButtonDelete(e){const{isNewQuery:t}=this.state;return t?null:(0,se.tZ)(be.ZP,{"data-test-id":"discover2-savedquery-button-delete",onClick:this.handleDeleteQuery,disabled:e,icon:(0,se.tZ)(Ee.Fz,{}),"aria-label":(0,z.t)("Delete")})}renderButtonCreateAlert(){const{eventView:e,organization:t,projects:s,onIncompatibleAlertQuery:r}=this.props;return(0,se.tZ)(Ze.Z,{target:"create_alert_from_discover",children:(0,se.tZ)(Se.K,{eventView:e,organization:t,projects:s,onIncompatibleQuery:r,onSuccess:this.handleCreateAlertSuccess,referrer:"discover","aria-label":(0,z.t)("Create Alert"),"data-test-id":"discover2-create-from-discover"})})}renderButtonAddToDashboard(){const{organization:e,eventView:t,savedQuery:s,yAxis:r,router:n}=this.props;return(0,se.tZ)(be.ZP,{"data-test-id":"add-dashboard-widget-from-discover",onClick:()=>(0,ze.F_)({organization:e,eventView:t,query:s,yAxis:r,router:n}),children:(0,z.t)("Add to Dashboard")},"add-dashboard-widget-from-discover")}render(){const{organization:e}=this.props,t=e=>(0,se.tZ)(Pe.uI,{body:(0,se.tZ)(xe.Z,{features:e.features,hideHelpToggle:!0,message:(0,z.t)("Discover queries are disabled"),featureName:(0,z.t)("Discover queries")}),children:e.children(e)}),s=s=>(0,se.tZ)(fe.Z,{organization:e,features:["discover-query"],hookName:"feature-disabled:discover-saved-query-create",renderDisabled:t,children:e=>{let{hasFeature:t}=e;return s(!t||this.props.disabled)}});return(0,se.BX)(_e,{gap:1,children:[s((e=>this.renderButtonSave(e))),(0,se.tZ)(fe.Z,{organization:e,features:["incidents"],children:e=>{let{hasFeature:t}=e;return t&&this.renderButtonCreateAlert()}}),(0,se.tZ)(fe.Z,{organization:e,features:["dashboards-edit"],children:e=>{let{hasFeature:t}=e;return t&&this.renderButtonAddToDashboard()}}),s((e=>this.renderButtonDelete(e)))]})}}Te.displayName="SavedQueryButtonGroup",(0,r.Z)(Te,"stopEventPropagation",(e=>{e.target instanceof Element&&["LI","INPUT"].includes(e.target.nodeName)&&(e.preventDefault(),e.stopPropagation())})),(0,r.Z)(Te,"defaultProps",{disabled:!1});const _e=(0,n.Z)(Ce.ZP,{target:"e1nw12tj3"})("@media (min-width: ",(e=>e.theme.breakpoints.medium),"){margin-top:0;}"),Ne=(0,n.Z)("div",{target:"e1nw12tj2"})("display:flex;flex-direction:column;padding:",(0,_.Z)(1),";gap:",(0,_.Z)(1),";"),Ve=(0,n.Z)(Ae.Z,{target:"e1nw12tj1"})({name:"1k18kha",styles:"height:40px"}),Re=(0,n.Z)("div",{target:"e1nw12tj0"})("display:inline-block;width:10px;height:10px;margin-right:",(0,_.Z)(.75),";border-radius:5px;background-color:",(e=>e.theme.yellow300),";"),ke=(0,qe.Z)((0,F.Z)(Te));class Oe extends o.Component{constructor(){super(...arguments),(0,r.Z)(this,"state",{savedQuery:void 0,loading:!0})}componentDidMount(){this.props.eventView.id&&this.fetchData()}componentDidUpdate(e){e.eventView&&this.props.eventView&&e.eventView.id!==this.props.eventView.id&&this.fetchData()}fetchData(){const{api:e,eventView:t,organization:s}=this.props;"string"==typeof t.id&&(this.setState({loading:!0}),(0,u.Yi)(e,s.slug,t.id).then((e=>{this.setState({savedQuery:e,loading:!1})})))}renderAuthor(){const{eventView:e}=this.props,{savedQuery:t}=this.state;if(!e.id)return null;let s=" — ",r=" — ";var n;return void 0!==t&&(s=(null===(n=t.createdBy)||void 0===n?void 0:n.email)||"—",r=(0,se.tZ)(de.Z,{date:t.dateUpdated})),(0,se.BX)(Le,{children:[(0,z.t)("Created by:")," ",s," | ",(0,z.t)("Last edited:")," ",r]})}render(){const{organization:e,location:t,errorCode:s,eventView:r,onIncompatibleAlertQuery:n,yAxis:o,router:i}=this.props,{savedQuery:a,loading:l}=this.state;return(0,se.BX)(C.h4,{children:[(0,se.BX)(Qe,{children:[(0,se.tZ)(ce.Z,{eventView:r,organization:e,location:t}),(0,se.tZ)(ye,{savedQuery:a,organization:e,eventView:r}),this.renderAuthor()]}),(0,se.tZ)(C.kP,{children:(0,se.tZ)(ke,{location:t,organization:e,eventView:r,savedQuery:a,savedQueryLoading:l,disabled:s>=400&&s<500,updateCallback:()=>this.fetchData(),onIncompatibleAlertQuery:n,yAxis:o,router:i})})]})}}Oe.displayName="ResultsHeader";const Le=(0,n.Z)("h4",{target:"e1idqj2c1"})("font-size:",(e=>e.theme.fontSizeLarge),";font-weight:normal;color:",(e=>e.theme.gray300),";margin:",(0,_.Z)(.5)," 0 0 0;"),Qe=(0,n.Z)(C.oB,{target:"e1idqj2c0"})({name:"12brwd0",styles:"overflow:unset"}),Fe=(0,F.Z)(Oe);var Ie=s("./app/components/pagination.tsx"),Be=s("./app/utils/measurements/measurements.tsx"),Me=s("./app/utils/parseLinkHeader.tsx"),Ue=s("./app/utils/performance/spanOperationBreakdowns/constants.tsx"),Ye=(s("../node_modules/core-js/modules/es.error.cause.js"),s("./app/actionCreators/modal.tsx")),Ke=s("./app/components/gridEditable/index.tsx"),He=s("./app/components/gridEditable/sortLink.tsx"),Xe=s("./app/components/links/link.tsx"),$e=s("./app/components/tooltip.tsx"),Ge=s("./app/components/truncate.tsx"),We=s("./app/utils/discover/fieldRenderers.tsx"),Je=s("./app/utils/tokenizeSearch.tsx"),et=s("./app/views/performance/traceDetails/utils.tsx"),tt=s("./app/views/performance/transactionSummary/utils.tsx"),st=s("./app/views/eventsV2/table/cellAction.tsx"),rt=s("../node_modules/@emotion/react/dist/emotion-react.browser.esm.js"),nt=s("./app/components/links/externalLink.tsx"),ot=s("./app/utils/theme.tsx"),it=s("./app/stores/tagStore.tsx"),at=s("./app/stores/useLegacyStore.tsx");var lt=s("./app/views/eventsV2/table/columnEditCollection.tsx");function dt(e){const{Header:t,Body:s,Footer:r,measurementKeys:n,spanOperationBreakdownKeys:i,organization:a,onApply:l,closeModal:d}=e;(0,o.useEffect)((()=>{(0,V.ec)({eventKey:"discover_v2.column_editor.open",eventName:"Discoverv2: Open column editor",organization_id:parseInt(a.id,10)})}),[a.id]);const{tags:c}={tags:(0,at.X)(it.Z)},p=Object.values(c).map((e=>{let{key:t}=e;return t})),[u,h]=(0,o.useState)(e.columns),m=(0,ze.R0)({organization:a,tagKeys:p,measurementKeys:n,spanOperationBreakdownKeys:i});return(0,se.BX)(o.Fragment,{children:[(0,se.tZ)(t,{closeButton:!0,children:(0,se.tZ)("h4",{children:(0,z.t)("Edit Columns")})}),(0,se.BX)(s,{children:[(0,se.tZ)(ct,{children:(0,z._N)("To group events, add [functionLink: functions] f(x) that may take in additional parameters. [fieldTagLink: Tag and field] columns will help you view more details about the events (i.e. title).",{functionLink:(0,se.tZ)(nt.Z,{href:"https://docs.sentry.io/product/discover-queries/query-builder/#filter-by-table-columns"}),fieldTagLink:(0,se.tZ)(nt.Z,{href:"https://docs.sentry.io/product/sentry-basics/search/searchable-properties/#event-properties"})})}),(0,se.tZ)(lt.Z,{columns:u,fieldOptions:m,onChange:h,organization:a})]}),(0,se.tZ)(r,{children:(0,se.BX)(Ce.ZP,{gap:1,children:[(0,se.tZ)(be.ZP,{priority:"default",href:q.l5,external:!0,children:(0,z.t)("Read the Docs")}),(0,se.tZ)(be.ZP,{"aria-label":(0,z.t)("Apply"),priority:"primary",onClick:function(){l(u),d()},children:(0,z.t)("Apply")})]})})]})}dt.displayName="ColumnEditModal";const ct=(0,n.Z)("div",{target:"e2ihjqm0"})("margin-bottom:",(0,_.Z)(4),";"),pt=(0,rt.iv)("@media (min-width: ",ot.ZP.breakpoints.medium,"){width:auto;max-width:900px;}",""),ut=dt;var ht=s("./app/components/dataExport.tsx");function mt(e,t){return(0,se.tZ)(fe.Z,{features:["organizations:discover-query"],renderDisabled:()=>gt(e,t),children:vt(e,t)})}function gt(e,t){const{isLoading:s,error:r}=t,n=s||null!==r||!1===e,o=n?void 0:()=>function(e,t){let{organization:s,eventView:r,tableData:n}=t;(0,V.ec)({eventKey:"discover_v2.results.download_csv",eventName:"Discoverv2: Download CSV",organization_id:parseInt(s.id,10)}),(0,ze.Di)(n,r.getColumns(),e)}(t.title,t);return(0,se.tZ)(be.ZP,{size:"small",disabled:n,onClick:o,"data-test-id":"grid-download-csv",icon:(0,se.tZ)(Ee.Dj,{size:"xs"}),children:(0,z.t)("Export")})}function vt(e,t){const{isLoading:s,error:r,location:n,eventView:o}=t,i=s||null!==r||!1===e;return(0,se.tZ)(ht.ZP,{payload:{queryType:ht.tD.Discover,queryInfo:o.getEventsAPIPayload(n)},disabled:i,icon:(0,se.tZ)(Ee.Dj,{size:"xs"}),children:(0,z.t)("Export All")})}function yt(e,t){const s=e?t.onEdit:void 0;return(0,se.tZ)(Ze.Z,{target:"columns_header_button",children:(0,se.tZ)(be.ZP,{size:"small",disabled:!e,onClick:s,"data-test-id":"grid-edit-enable",icon:(0,se.tZ)(Ee.bv,{size:"xs"}),children:(0,z.t)("Columns")})})}function ft(e){let{onChangeShowTags:t,showTags:s}=e;return(0,se.tZ)(be.ZP,{"data-test-id":"toggle-show-tags",size:"small",onClick:t,icon:(0,se.tZ)(Ee.Ah,{size:"xs"}),children:s?(0,z.t)("Hide Tags"):(0,z.t)("Show Tags")})}function xt(e){const t=(0,z.t)("Requires discover query feature.");return(0,se.tZ)(fe.Z,{hookName:"feature-disabled:grid-editable-actions",renderDisabled:e=>(0,se.tZ)(Pe.uI,{body:(0,se.tZ)(xe.Z,{features:e.features,hideHelpToggle:!0,message:t,featureName:t}),children:e.children(e)}),features:["organizations:discover-query"],children:t=>{let{hasFeature:s}=t;return e.children(s,e)}})}function Zt(e){return(0,se.BX)(o.Fragment,{children:[(0,rt.az)(xt,{...e,key:"edit"},yt),(0,rt.az)(xt,{...e,key:"download"},mt),ft(e)]})}mt.displayName="renderDownloadButton",gt.displayName="renderBrowserExportButton",vt.displayName="renderAsyncExportButton",yt.displayName="renderEditButton",ft.displayName="renderSummaryButton",xt.displayName="FeatureWrapper",Zt.displayName="HeaderActions";const wt=Zt;var bt=s("./app/views/eventsV2/table/topResultsIndicator.tsx");class Ct extends o.Component{constructor(){super(...arguments),(0,r.Z)(this,"_resizeColumn",((e,t)=>{const{location:s,eventView:r}=this.props,n=t.width?Number(t.width):Ke.z7,o=r.withResizedColumn(e,n);(0,ze.TX)({location:s,nextEventView:o,extraQuery:(0,R.QN)(s)})})),(0,r.Z)(this,"_renderPrependColumns",((e,t,s)=>{const{organization:r,eventView:n,tableData:o,location:i}=this.props,l=n.hasAggregateField(),d=n.hasIdField();if(e)return l?[(0,se.tZ)(St,{children:(0,se.tZ)(Ee.bv,{size:"sm"})},"header-icon")]:d?[]:[(0,se.tZ)(St,{children:(0,se.tZ)(He.Z,{align:"left",title:(0,z.t)("event id"),direction:void 0,canSort:!1,generateSortLink:()=>{}})},"header-event-id")];if(l){const e=(0,ze.Bn)(n,{},t),r={pathname:i.pathname,query:e.generateQueryStringObject()};return[(0,se.tZ)($e.Z,{title:(0,z.t)("Open Group"),children:(0,se.tZ)(Xe.Z,{to:r,"data-test-id":"open-group",onClick:()=>{e.isEqualTo(n)&&a.Tb(new Error("Failed to drilldown"))},children:(0,se.tZ)(Pt,{size:"sm"})})},`eventlink${s}`)]}if(!d){let e=t.id;o&&o.meta&&(e=(0,We.Js)("id",o.meta)(t,{organization:r,location:i}));const a=(0,je.JE)(t),l=(0,je.eQ)({orgSlug:r.slug,eventSlug:a,eventView:n});return[(0,se.tZ)($e.Z,{title:(0,z.t)("View Event"),children:(0,se.tZ)(At,{"data-test-id":"view-event",to:l,children:e})},`eventlink${s}`)]}return[]})),(0,r.Z)(this,"_renderGridHeaderCell",(e=>{const{eventView:t,location:s,tableData:r}=this.props,n=null==r?void 0:r.meta,o=(0,k.qG)(e.name,e.type,n),i={field:e.key,width:e.width},a=t.sortForField(i,n),l=(0,R.M3)(i,n),d=(0,k.uI)(e.name)?t.getEquations()[(0,k.G5)(e.name)]:e.name,c=(0,se.tZ)(Dt,{title:d,children:(0,se.tZ)(Ge.Z,{value:d,maxLength:60,expandable:!1})});return(0,se.tZ)(He.Z,{align:o,title:c,direction:a?a.kind:void 0,canSort:l,generateSortLink:function(){if(!n)return;const e=t.sortOnField(i,n).generateQueryStringObject();return e.yAxis=(0,Q.qP)(s.query.yAxis),{...s,query:e}}})})),(0,r.Z)(this,"_renderGridBodyCell",((e,t,s,r)=>{var n,i;const{isFirstPage:a,eventView:l,location:d,organization:c,tableData:p}=this.props;if(!p||!p.meta)return t[e.key];const u=String(e.key),h=(0,We.Js)(u,p.meta,!c.features.includes("discover-frontend-use-events-endpoint")),m=l.getDisplayMode(),g=m===O.DC.TOP5||m===O.DC.DAILYTOP5,v=l.topEvents?parseInt(l.topEvents,10):O.hY,y=Math.min(null!==(n=null==p||null===(i=p.data)||void 0===i?void 0:i.length)&&void 0!==n?n:v,v);let f=h(t,{organization:c,location:d});if("id"===u){const e=(0,je.JE)(t),s=(0,je.eQ)({orgSlug:c.slug,eventSlug:e,eventView:l});f=(0,se.tZ)($e.Z,{title:(0,z.t)("View Event"),children:(0,se.tZ)(At,{"data-test-id":"view-event",to:s,children:f})})}else if("trace"===u){const e=l.normalizeDateSelection(d);if(t.trace){const s=(0,et.YA)(c,String(t.trace),e,{});f=(0,se.tZ)($e.Z,{title:(0,z.t)("View Trace"),children:(0,se.tZ)(At,{"data-test-id":"view-trace",to:s,children:f})})}}const x=(0,k.LY)(u),Z=t[x];return"integer"===p.meta[x]&&(0,N.ri)(Z)&&Z>999?(0,se.tZ)($e.Z,{title:Z.toLocaleString(),containerDisplayMode:"block",position:"right",children:(0,se.tZ)(st.ZP,{column:e,dataRow:t,handleCellAction:this.handleCellAction(t,e),children:f})}):(0,se.BX)(o.Fragment,{children:[a&&g&&s<v&&0===r?(0,se.tZ)(bt.Z,{count:y,index:s}):null,(0,se.tZ)(st.ZP,{column:e,dataRow:t,handleCellAction:this.handleCellAction(t,e),children:f})]})})),(0,r.Z)(this,"handleEditColumns",(()=>{const{organization:e,eventView:t,measurementKeys:s,spanOperationBreakdownKeys:r}=this.props,n=e.features.includes("performance-ops-breakdown");(0,Ye.openModal)((o=>(0,se.tZ)(ut,{...o,organization:e,measurementKeys:s,spanOperationBreakdownKeys:n?r:void 0,columns:t.getColumns().map((e=>e.column)),onApply:this.handleUpdateColumns})),{modalCss:pt,backdrop:"static"})})),(0,r.Z)(this,"handleCellAction",((e,t)=>(s,r)=>{const{eventView:n,organization:o,projects:a,location:l}=this.props,d=new Je.MY(n.query);let c=n.clone();switch((0,V.ec)({eventKey:"discover_v2.results.cellaction",eventName:"Discoverv2: Cell Action Clicked",organization_id:parseInt(o.id,10),action:s}),s){case st.eX.TRANSACTION:{const t=a.find((t=>t.slug&&[e["project.name"],e.project].includes(t.slug))),s=t?[t.id]:void 0,n=(0,tt.e1)({orgSlug:o.slug,transaction:String(r),projectID:s,query:c.getPageFiltersQuery()});return void i.browserHistory.push(n)}case st.eX.RELEASE:{const t=a.find((t=>t.slug===e.project));return void i.browserHistory.push({pathname:`/organizations/${o.slug}/releases/${encodeURIComponent(r)}/`,query:{...c.getPageFiltersQuery(),project:t?t.id:void 0}})}case st.eX.DRILLDOWN:return(0,V.ec)({eventKey:"discover_v2.results.drilldown",eventName:"Discoverv2: Click aggregate drilldown",organization_id:parseInt(o.id,10)}),c=(0,ze.Bn)(c,{},e).withNewColumn({kind:"function",function:["count","",void 0,void 0]}),void i.browserHistory.push(c.getResultsViewUrlTarget(o.slug));default:(0,st.rh)(d,s,t,r)}c.query=d.formatString();const p=c.getResultsViewUrlTarget(o.slug);p.query.yAxis=(0,Q.qP)(l.query.yAxis),i.browserHistory.push(p)})),(0,r.Z)(this,"handleUpdateColumns",(e=>{const{organization:t,eventView:s,location:r}=this.props;(0,V.ec)({eventKey:"discover_v2.update_columns",eventName:"Discoverv2: Update columns",organization_id:parseInt(t.id,10)});const n=s.withColumns(e),o=n.getResultsViewUrlTarget(t.slug),a=(0,Q.qP)(r.query.yAxis);o.query.yAxis=a.filter((e=>n.getYAxisOptions().find((t=>{let{value:s}=t;return s===e})))),i.browserHistory.push(o)})),(0,r.Z)(this,"renderHeaderButtons",(()=>{const{organization:e,title:t,eventView:s,isLoading:r,error:n,tableData:o,location:i,onChangeShowTags:a,showTags:l}=this.props;return(0,se.tZ)(wt,{title:t,isLoading:r,error:n,organization:e,eventView:s,onEdit:this.handleEditColumns,tableData:o,location:i,onChangeShowTags:a,showTags:l})}))}render(){const{isLoading:e,error:t,location:s,tableData:r,eventView:n,organization:o}=this.props,i=n.getColumns(o.features.includes("discover-frontend-use-events-endpoint")),a=n.getSorts(),l=n.hasAggregateField()?["40px"]:n.hasIdField()?[]:[`minmax(${Ke.zO}px, max-content)`];return(0,se.tZ)(Ke.ZP,{isLoading:e,error:t,data:r?r.data:[],columnOrder:i,columnSortBy:a,title:(0,z.t)("Results"),grid:{renderHeadCell:this._renderGridHeaderCell,renderBodyCell:this._renderGridBodyCell,onResizeColumn:this._resizeColumn,renderPrependColumns:this._renderPrependColumns,prependColumnWidths:l},headerButtons:this.renderHeaderButtons,location:s})}}Ct.displayName="TableView";const St=(0,n.Z)("span",{target:"ecjx3jw3"})("color:",(e=>e.theme.subText),";"),Dt=(0,n.Z)($e.Z,{target:"ecjx3jw2"})({name:"168giuu",styles:"display:initial"}),At=(0,n.Z)(Xe.Z,{target:"ecjx3jw1"})({name:"1p0lxza",styles:">div{display:inline;}"}),Pt=(0,n.Z)(Ee.bv,{target:"ecjx3jw0"})({name:"1989ovb",styles:"vertical-align:middle"}),Et=(0,qe.Z)(Ct);class jt extends o.PureComponent{constructor(){super(...arguments),(0,r.Z)(this,"state",{isLoading:!0,tableFetchID:void 0,error:null,pageLinks:null,tableData:null}),(0,r.Z)(this,"shouldRefetchData",(e=>{const t=this.props.eventView.getEventsAPIPayload(this.props.location),s=e.eventView.getEventsAPIPayload(e.location);return!(0,R.ze)(t,s)})),(0,r.Z)(this,"fetchData",(()=>{const{eventView:e,organization:t,location:s,setError:r,confirmedQuery:n}=this.props;if(!e.isValid()||!n)return;const o=t.features.includes("discover-frontend-use-events-endpoint"),i=o?`/organizations/${t.slug}/events/`:`/organizations/${t.slug}/eventsv2/`,a=Symbol("tableFetchID"),l=e.getEventsAPIPayload(s);l.referrer="api.discover.query-table";const d=(0,Q.ro)(s.query.userModified);void 0!==d&&(l.user_modified=d),r("",200),this.setState({isLoading:!0,tableFetchID:a}),V.oF.mark({name:`discover-events-start-${l.query}`}),this.props.api.clear(),this.props.api.requestPromise(i,{method:"GET",includeAllArgs:!0,query:l}).then((e=>{var t;let[s,r,n]=e;if(V.oF.measure({name:"app.api.discover-query",start:`discover-events-start-${l.query}`,data:{status:n&&n.status}}),this.state.tableFetchID!==a)return;const{fields:i,...d}=null!==(t=s.meta)&&void 0!==t?t:{},c=o?{...s,meta:{...i,nonFieldsMeta:d}}:s;this.setState((e=>({isLoading:!1,tableFetchID:void 0,error:null,pageLinks:n?n.getResponseHeader("Link"):e.pageLinks,tableData:c})))})).catch((e=>{var t;V.oF.measure({name:"app.api.discover-query",start:`discover-events-start-${l.query}`,data:{status:e.status}});const s=(null==e||null===(t=e.responseJSON)||void 0===t?void 0:t.detail)||(0,z.t)("An unknown error occurred.");this.setState({isLoading:!1,tableFetchID:void 0,error:s,pageLinks:null,tableData:null}),(0,V.ec)({eventKey:"discover_search.failed",eventName:"Discover Search: Failed",organization_id:this.props.organization.id,search_type:"events",search_source:"discover_search",error:s}),r(s,e.status)}))}))}componentDidMount(){this.fetchData()}componentDidUpdate(e){(!this.state.isLoading&&this.shouldRefetchData(e)||!1===e.eventView.isValid()&&this.props.eventView.isValid()||e.confirmedQuery!==this.props.confirmedQuery)&&this.fetchData()}render(){const{eventView:e}=this.props,{pageLinks:t,tableData:s,isLoading:r,error:n}=this.state,o=!!t&&!1===(0,Me.Z)(t).previous.results;return(0,se.BX)(zt,{children:[(0,se.tZ)(Be.Z,{children:t=>{let{measurements:i}=t;const a=Object.values(i).map((e=>{let{key:t}=e;return t}));return(0,se.tZ)(Et,{...this.props,isLoading:r,isFirstPage:o,error:n,eventView:e,tableData:s,measurementKeys:a,spanOperationBreakdownKeys:Ue.$})}}),(0,se.tZ)(Ie.Z,{pageLinks:t})]})}}jt.displayName="Table";const qt=(0,F.Z)(jt),zt=(0,n.Z)("div",{target:"e1rpfy900"})({name:"ovk77c",styles:"min-width:0"});var Tt=s("./app/views/eventsV2/tags.tsx");const _t="discover2:show-tags";function Nt(e,t,s){return e.query.yAxis?(0,Q.qP)(e.query.yAxis):null===e.query.yAxis?[]:null!=s&&s.yAxis&&(null==s?void 0:s.yAxis.length)>0?(0,Q.qP)(null==s?void 0:s.yAxis):[t.getYAxis()]}class Vt extends o.Component{constructor(){super(...arguments),(0,r.Z)(this,"state",{eventView:R.ZP.fromSavedQueryOrLocation(this.props.savedQuery,this.props.location),error:"",errorCode:200,totalValues:null,showTags:"1"===L.Z.getItem(_t),needConfirmation:!1,confirmedQuery:!1,incompatibleAlertNotice:null}),(0,r.Z)(this,"tagsApi",new v.KU),(0,r.Z)(this,"canLoadEvents",(async()=>{const{api:e,location:t,organization:s}=this.props,{eventView:r}=this.state;let n=!1,o=!0;const i=r.getEventsAPIPayload(t);if(r.getDays()>30&&i.project){let t=i.project.length;if(0===t||1===t&&"-1"===i.project[0])try{const r=await(0,m.xV)(e,s.slug);t=0===t?r.myProjects:r.allProjects}catch(e){}t>10&&(n=!0,o=!1)}this.setState({needConfirmation:n,confirmedQuery:o},(()=>{this.setState({confirmedQuery:!1})})),n&&this.openConfirm()})),(0,r.Z)(this,"openConfirm",(()=>{})),(0,r.Z)(this,"setOpenFunction",(e=>{let{open:t}=e;return this.openConfirm=t,null})),(0,r.Z)(this,"handleConfirmed",(()=>{this.setState({needConfirmation:!1,confirmedQuery:!0},(()=>{this.setState({confirmedQuery:!1})}))})),(0,r.Z)(this,"handleCancelled",(()=>{this.setState({needConfirmation:!1,confirmedQuery:!1})})),(0,r.Z)(this,"handleChangeShowTags",(()=>{const{organization:e}=this.props;(0,V.ec)({eventKey:"discover_v2.results.toggle_tag_facets",eventName:"Discoverv2: Toggle Tag Facets",organization_id:parseInt(e.id,10)}),this.setState((e=>{const t=!e.showTags;return L.Z.setItem(_t,t?"1":"0"),{...e,showTags:t}}))})),(0,r.Z)(this,"handleSearch",(e=>{const{router:t,location:s}=this.props,r=(0,P.fK)({...s.query||{},query:e}),n=p()(r,"cursor");t.push({pathname:s.pathname,query:{...n,userModified:!0}})})),(0,r.Z)(this,"handleYAxisChange",(e=>{const{router:t,location:s}=this.props,r=O.px.includes(s.query.display),n={...s.query,yAxis:e.length>0?e:[null],display:e.length>1&&!r?s.query.display===O.DC.DAILYTOP5?O.DC.DAILY:O.DC.DEFAULT:s.query.display};t.push({pathname:s.pathname,query:n}),this.state.needConfirmation||this.handleConfirmed(),(0,V.ec)({eventKey:"discover_v2.y_axis_change",eventName:"Discoverv2: Change chart's y axis",organization_id:parseInt(this.props.organization.id,10),y_axis_value:e})})),(0,r.Z)(this,"handleDisplayChange",(e=>{const{router:t,location:s}=this.props,r={...s.query,display:e};t.push({pathname:s.pathname,query:r}),this.state.needConfirmation||this.handleConfirmed()})),(0,r.Z)(this,"handleTopEventsChange",(e=>{const{router:t,location:s}=this.props,r={...s.query,topEvents:e};t.push({pathname:s.pathname,query:r}),this.state.needConfirmation||this.handleConfirmed()})),(0,r.Z)(this,"generateTagUrl",((e,t)=>{const{organization:s}=this.props,{eventView:r}=this.state,n=r.getResultsViewUrlTarget(s.slug);return n.query=(0,N.ZT)(n.query,{key:(0,k.ZC)(e),value:t}),n})),(0,r.Z)(this,"handleIncompatibleQuery",((e,t)=>{const{organization:s}=this.props,{eventView:r}=this.state;(0,V.ec)({eventKey:"discover_v2.create_alert_clicked",eventName:"Discoverv2: Create alert clicked",status:"error",query:r.query,errors:t,organization_id:s.id,url:window.location.href});const n=e((()=>this.setState({incompatibleAlertNotice:null})));this.setState({incompatibleAlertNotice:n})})),(0,r.Z)(this,"setError",((e,t)=>{this.setState({error:e,errorCode:t})}))}static getDerivedStateFromProps(e,t){if(e.savedQuery||!e.loading){const s=R.ZP.fromSavedQueryOrLocation(e.savedQuery,e.location);return{...t,eventView:s,savedQuery:e.savedQuery}}return t}componentDidMount(){const{organization:e,selection:t,location:s}=this.props;(0,g.QK)(this.tagsApi,e.slug,t),(0,M.n4)(t),this.checkEventView(),this.canLoadEvents(),(0,N.ri)(s.query.id)&&(0,u.EQ)(e.slug,s.query.id)}componentDidUpdate(e,t){const{api:s,location:r,organization:n,selection:o}=this.props,{eventView:i,confirmedQuery:a,savedQuery:l}=this.state;this.checkEventView();const c=i.getEventsAPIPayload(r),p=t.eventView.getEventsAPIPayload(e.location),u=Nt(r,i,l),h=Nt(e.location,i,t.savedQuery);(0,R.ze)(c,p)&&!this.hasChartParametersChanged(t.eventView,i,h,u)||(s.clear(),this.canLoadEvents()),d()(e.selection.datetime,o.datetime)&&d()(e.selection.projects,o.projects)||((0,g.QK)(this.tagsApi,n.slug,o),(0,M.n4)(o)),t.confirmedQuery!==a&&this.fetchTotalCount()}hasChartParametersChanged(e,t,s,r){return!d()(s,r)||e.getDisplayMode()!==t.getDisplayMode()}async fetchTotalCount(){const{api:e,organization:t,location:s}=this.props,{eventView:r,confirmedQuery:n}=this.state;if(!1!==n&&r.isValid())try{const n=await(0,h.JE)(e,t.slug,r.getEventsAPIPayload(s));this.setState({totalValues:n})}catch(e){a.Tb(e)}}checkEventView(){var e;const{eventView:t}=this.state,{loading:s}=this.props;if(t.isValid()||s)return;const{location:r,organization:n,selection:o}=this.props,a=R.ZP.fromNewQueryWithLocation(U.eP,r);0===a.project.length&&o.projects&&(a.project=o.projects),null!==(e=r.query)&&void 0!==e&&e.query&&(a.query=(0,Q.ro)(r.query.query,"")),i.browserHistory.replace(a.getResultsViewUrlTarget(n.slug))}getDocumentTitle(){const{organization:e}=this.props,{eventView:t}=this.state;return t?(0,ze.zt)({eventView:t,organization:e}):""}renderTagsTable(){const{organization:e,location:t}=this.props,{eventView:s,totalValues:r,confirmedQuery:n}=this.state;return(0,se.tZ)(C.MF,{children:(0,se.tZ)(Tt.Z,{generateUrl:this.generateTagUrl,totalValues:r,eventView:s,organization:e,location:t,confirmedQuery:n})})}renderError(e){return e?(0,se.tZ)(y.Z,{type:"error",showIcon:!0,children:e}):null}render(){const{organization:e,location:t,router:s}=this.props,{eventView:r,error:n,errorCode:o,totalValues:i,showTags:a,incompatibleAlertNotice:l,confirmedQuery:d,savedQuery:c}=this.state,p=r.hasAggregateField()?(0,k.db)(e,r.fields):r.fields,u=r.query,h=this.getDocumentTitle(),m=Nt(t,r,c);return(0,se.tZ)(j.Z,{title:h,orgSlug:e.slug,children:(0,se.tZ)(Rt,{children:(0,se.BX)(S.Z,{organization:e,children:[(0,se.tZ)(Fe,{errorCode:o,organization:e,location:t,eventView:r,onIncompatibleAlertQuery:this.handleIncompatibleQuery,yAxis:m,router:s}),(0,se.BX)(C.uT,{children:[l&&(0,se.tZ)(Lt,{fullWidth:!0,children:l}),(0,se.BX)(Lt,{fullWidth:!0,children:[this.renderError(n),(0,se.BX)(kt,{condensed:!0,children:[(0,se.tZ)(E.Z,{}),(0,se.tZ)(w.Z,{}),(0,se.tZ)(Z.Z,{alignDropdown:"left"})]}),(0,se.tZ)(Ot,{searchSource:"eventsv2",organization:e,projectIds:r.project,query:u,fields:p,onSearch:this.handleSearch,maxQueryLength:q.dI}),(0,se.tZ)(ie,{router:s,organization:e,eventView:r,location:t,onAxisChange:this.handleYAxisChange,onDisplayChange:this.handleDisplayChange,onTopEventsChange:this.handleTopEventsChange,total:i,confirmedQuery:d,yAxis:m})]}),(0,se.tZ)(C.or,{fullWidth:!a,children:(0,se.tZ)(qt,{organization:e,eventView:r,location:t,title:h,setError:this.setError,onChangeShowTags:this.handleChangeShowTags,showTags:a,confirmedQuery:d})}),a?this.renderTagsTable():null,(0,se.tZ)(x.Z,{priority:"primary",header:(0,se.tZ)("strong",{children:(0,z.t)("May lead to thumb twiddling")}),confirmText:(0,z.t)("Do it"),cancelText:(0,z.t)("Nevermind"),onConfirm:this.handleConfirmed,onCancel:this.handleCancelled,message:(0,se.tZ)("p",{children:(0,z._N)("You've created a query that will search for events made\n                      [dayLimit:over more than 30 days] for [projectLimit:more than 10 projects].\n                      A lot has happened during that time, so this might take awhile.\n                      Are you sure you want to do this?",{dayLimit:(0,se.tZ)("strong",{}),projectLimit:(0,se.tZ)("strong",{})})}),children:this.setOpenFunction})]})]})})})}}Vt.displayName="Results";const Rt=(0,n.Z)(T.JH,{target:"e1phmre33"})({name:"1hcx8jb",styles:"padding:0"}),kt=(0,n.Z)(D.Z,{target:"e1phmre32"})("margin-bottom:",(0,_.Z)(1),";"),Ot=(0,n.Z)(b.Z,{target:"e1phmre31"})("margin-bottom:",(0,_.Z)(2),";"),Lt=(0,n.Z)(C.or,{target:"e1phmre30"})({name:"y6n6nb",styles:"flex-grow:0"});class Qt extends f.Z{getEndpoints(){const{organization:e,location:t}=this.props;return t.query.id?[["savedQuery",`/organizations/${e.slug}/discover/saved/${t.query.id}/`]]:[]}renderLoading(){return this.renderBody()}renderBody(){const{savedQuery:e,loading:t}=this.state;return(0,se.tZ)(Vt,{...this.props,savedQuery:null!=e?e:void 0,loading:t})}}function Ft(e){return(0,se.tZ)(A.Z,{skipLoadLastUsed:e.organization.features.includes("global-views")&&!!e.savedQuery,hideGlobalHeader:!0,children:(0,se.tZ)(Qt,{...e})})}Ft.displayName="ResultsContainer";const It=(0,F.Z)((0,I.Z)((0,B.Z)(Ft)))},"./app/views/eventsV2/tags.tsx":(e,t,s)=>{s.d(t,{Z:()=>S});var r=s("../node_modules/@babel/runtime/helpers/esm/defineProperty.js"),n=s("../node_modules/@emotion/styled/base/dist/emotion-styled-base.browser.esm.js"),o=(s("../node_modules/core-js/modules/web.dom-collections.iterator.js"),s("../node_modules/react/index.js")),i=s("../node_modules/@sentry/hub/esm/exports.js"),a=s("./app/actionCreators/events.tsx"),l=s("./app/components/charts/errorPanel.tsx"),d=s("./app/components/charts/styles.tsx"),c=s("./app/components/emptyStateWarning.tsx"),p=s("./app/components/placeholder.tsx"),u=s("./app/components/tagDistributionMeter.tsx"),h=s("./app/icons/index.tsx"),m=s("./app/locale.tsx"),g=s("./app/styles/space.tsx"),v=s("./app/utils/analytics.tsx"),y=s("./app/utils/discover/eventView.tsx"),f=s("./app/utils/withApi.tsx"),x=s("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");class Z extends o.Component{constructor(){var e;super(...arguments),e=this,(0,r.Z)(this,"state",{loading:!0,tags:[],totalValues:null,error:""}),(0,r.Z)(this,"shouldRefetchData",(e=>{const t=this.props.eventView.getFacetsAPIPayload(this.props.location),s=e.eventView.getFacetsAPIPayload(e.location);return!(0,y.ze)(t,s)})),(0,r.Z)(this,"fetchData",(async function(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];const{api:s,organization:r,eventView:n,location:o,confirmedQuery:l}=e.props;if(e.setState({loading:!0,error:"",tags:[]}),t||!1!==l)try{const t=await(0,a.eV)(s,r.slug,n.getFacetsAPIPayload(o));e.setState({loading:!1,tags:t})}catch(t){i.Tb(t),e.setState({loading:!1,error:t})}})),(0,r.Z)(this,"handleTagClick",(e=>{const{organization:t}=this.props;(0,v.ec)({eventKey:"discover_v2.facet_map.clicked",eventName:"Discoverv2: Clicked on a tag on the facet map",tag:e,organization_id:parseInt(t.id,10)})})),(0,r.Z)(this,"renderBody",(()=>{const{loading:e,error:t,tags:s}=this.state;return e?this.renderPlaceholders():t?(0,x.tZ)(l.Z,{height:"132px",children:(0,x.tZ)(h.FC,{color:"gray300",size:"lg"})}):s.length>0?s.map((e=>this.renderTag(e))):(0,x.tZ)(w,{small:!0,children:(0,m.t)("No tags found")})}))}componentDidMount(){this.fetchData(!0)}componentDidUpdate(e){(this.shouldRefetchData(e)||e.confirmedQuery!==this.props.confirmedQuery)&&this.fetchData()}renderTag(e){const{generateUrl:t,totalValues:s}=this.props,r=e.topValues.map((s=>(s.url=t(e.key,s.value),s))),n=r.length>0?Math.max(Number(s),r[0].count):s;return(0,x.tZ)(u.Z,{title:e.key,segments:r,totalValues:Number(n),renderLoading:()=>(0,x.tZ)(b,{height:"16px"}),onTagClick:this.handleTagClick,showReleasePackage:!0},e.key)}renderPlaceholders(){return(0,x.BX)(o.Fragment,{children:[(0,x.tZ)(C,{},"title-1"),(0,x.tZ)(b,{},"bar-1"),(0,x.tZ)(C,{},"title-2"),(0,x.tZ)(b,{},"bar-2"),(0,x.tZ)(C,{},"title-3"),(0,x.tZ)(b,{},"bar-3")]})}render(){return(0,x.BX)(o.Fragment,{children:[(0,x.tZ)(d.OT,{children:(0,m.t)("Tag Summary")}),this.renderBody()]})}}Z.displayName="Tags";const w=(0,n.Z)(c.Z,{target:"e1pu9veq2"})({name:"rtpdsm",styles:"height:132px;padding:54px 15%"}),b=(0,n.Z)(p.Z,{target:"e1pu9veq1"})("border-radius:",(e=>e.theme.borderRadius),";height:16px;margin-bottom:",(0,g.Z)(1.5),";"),C=(0,n.Z)(p.Z,{target:"e1pu9veq0"})("width:100px;height:12px;margin-bottom:",(0,g.Z)(.5),";"),S=(0,f.Z)(Z)},"./app/views/performance/trends/types.tsx":(e,t,s)=>{let r,n,o;s.d(t,{A2:()=>o,ER:()=>r,Z2:()=>n}),function(e){e.IMPROVED="improved",e.REGRESSION="regression"}(r||(r={})),function(e){e.P50="p50",e.P75="p75",e.P95="p95",e.P99="p99",e.AVG="avg"}(n||(n={})),function(e){e.DURATION="transaction.duration",e.LCP="measurements.lcp",e.FCP="measurements.fcp",e.FID="measurements.fid",e.CLS="measurements.cls",e.SPANS_DB="spans.db",e.SPANS_HTTP="spans.http",e.SPANS_BROWSER="spans.browser",e.SPANS_RESOURCE="spans.resource"}(o||(o={}))},"./app/views/performance/trends/utils.tsx":(e,t,s)=>{s.d(t,{CE:()=>C,HF:()=>V,IO:()=>S,Kt:()=>A,P4:()=>_,RP:()=>z,T1:()=>v,Ws:()=>b,_1:()=>m,_H:()=>P,bg:()=>g,cs:()=>y,ed:()=>D,es:()=>f,iF:()=>j,j_:()=>T,kM:()=>E,vq:()=>R,vt:()=>w,wx:()=>q}),s("../node_modules/core-js/modules/web.dom-collections.iterator.js"),s("../node_modules/core-js/modules/es.array.includes.js");var r=s("../node_modules/downsample/methods/ASAP.js"),n=s("../node_modules/moment/moment.js"),o=s.n(n),i=s("./app/components/charts/utils.tsx"),a=s("./app/locale.tsx"),l=s("./app/utils/discover/fields.tsx"),d=s("./app/utils/queryString.tsx"),c=s("./app/utils/theme.tsx"),p=s("./app/utils/tokenizeSearch.tsx"),u=s("./app/views/performance/utils.tsx"),h=s("./app/views/performance/trends/types.tsx");const m="14d",g="15min",v=[{label:"p50",field:h.Z2.P50,alias:"percentile_range",legendLabel:"p50"},{label:"p75",field:h.Z2.P75,alias:"percentile_range",legendLabel:"p75"},{label:"p95",field:h.Z2.P95,alias:"percentile_range",legendLabel:"p95"},{label:"p99",field:h.Z2.P99,alias:"percentile_range",legendLabel:"p99"},{label:"average",field:h.Z2.AVG,alias:"avg_range",legendLabel:"average"}],y=[{label:"Duration",column:h.A2.DURATION},{label:"LCP",column:h.A2.LCP},{label:"FCP",column:h.A2.FCP},{label:"FID",column:h.A2.FID},{label:"CLS",column:h.A2.CLS},{label:"Spans (http)",column:h.A2.SPANS_HTTP},{label:"Spans (db)",column:h.A2.SPANS_DB},{label:"Spans (browser)",column:h.A2.SPANS_BROWSER},{label:"Spans (resource)",column:h.A2.SPANS_RESOURCE}],f={[h.ER.IMPROVED]:{lighter:c.ZP.green200,default:c.ZP.green300},[h.ER.REGRESSION]:{lighter:c.ZP.red200,default:c.ZP.red300}},x={[h.ER.IMPROVED]:"improvedSelected",[h.ER.REGRESSION]:"regressionSelected"},Z={[h.ER.IMPROVED]:"improvedUnselectedSeries",[h.ER.REGRESSION]:"regressionUnselectedSeries"},w={[h.ER.IMPROVED]:"improvedCursor",[h.ER.REGRESSION]:"regressionCursor"};function b(){const e={};return Object.values(w).forEach((t=>e[t]=void 0)),e}function C(e,t){var s;const r=null!=t?t:(0,d.ro)(null==e||null===(s=e.query)||void 0===s?void 0:s.trendFunction);return v.find((e=>{let{field:t}=e;return t===r}))||v[0]}function S(e,t,s){var r;const n=(0,d.ro)(null==e||null===(r=e.query)||void 0===r?void 0:r.trendParameter),o=y.find((e=>{let{label:t}=e;return t===n}));return o||function(e,t){return function(e){switch(e){case u.iy.FRONTEND:return{label:"LCP",column:h.A2.LCP};case u.iy.ANY:case u.iy.BACKEND:case u.iy.FRONTEND_OTHER:default:return{label:"Duration",column:h.A2.DURATION}}}((0,u.Bh)(e,t))}(t,s)}function D(e,t){return(0,l.sN)({kind:"function",function:[e,t,void 0,void 0]})}function A(e,t){return{fromSeconds:e/1e3,toSeconds:t/1e3,showDigits:e>1e3||t>1e3||e<10||t<10}}function P(e,t){if(!e.project||!t)return;const s=t.find((t=>t.slug===e.project));return null==s?void 0:s.id}function E(e,t,s,r,n){const o=C(t),a=S(t,r,e.project),l=[...n?[]:["transaction"],"project"].map((e=>({field:e}))),c={field:"trend_percentage()",kind:"asc"};e.trendType=s,s===h.ER.REGRESSION&&(c.kind="desc"),o&&a&&(e.trendFunction=D(o.field,a.column)),e.query=function(e){const t=new p.MY(e);return t.hasFilter("count_percentage()")||t.addFilterValues("count_percentage()",[">0.25","<4"]),t.hasFilter("trend_percentage()")||t.addFilterValues("trend_percentage()",[">0%"]),t.hasFilter("confidence()")||t.addFilterValues("confidence()",[">6"]),t.formatString()}(e.query),e.interval=function(e,t){var s;const r=(0,d.ro)(null==e||null===(s=e.query)||void 0===s?void 0:s.interval),{start:n,end:o,statsPeriod:a}=t,l={start:n||null,end:o||null,period:a},c=(0,i.ZS)(l,"high");return r||c}(t,e),e.sorts=[c],e.fields=l}function j(e,t){const{query:s}=t,r=s.start&&s.end;return s.statsPeriod||r||(e.statsPeriod=m),e}function q(e,t){const s=Math.abs(e);return{seconds:s/1e3,fixedDigits:s>1e3||s<10?1:0,changeLabel:t===h.ER.REGRESSION?(0,a.t)("slower"):(0,a.t)("faster")}}function z(e){const t=o()();return e.map((e=>({...e,received_at:t,transaction:e.transaction})))}function T(e){return x[e]}function _(e){return Z[e]}const N=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:100;return(0,r.Cl)(e,t)},V=e=>["p50","p75"].find((t=>e.includes(t)));function R(e,t){let s=Number.MAX_SAFE_INTEGER,r=0;if(!e)return{maxValue:r,minValue:s,smoothedResults:void 0};const n=[];for(const o of e){const e=o.data,i=[],a=N(e.map((e=>{let{name:t,value:s}=e;return[Number(t),s]})));for(let e=0;e<a.length;e++){const t=a[e],n=t.y;if(i.push({name:t.x,value:n}),!isNaN(n)){const e=Math.round(n);s=Math.min(e,s),r=Math.max(e,r)}}n.push({seriesName:t||o.seriesName||"Current",data:i,lineStyle:o.lineStyle,color:o.color})}return{minValue:s,maxValue:r,smoothedResults:n}}},"./app/views/performance/utils.tsx":(e,t,s)=>{s.d(t,{Bh:()=>x,C$:()=>Z,Ik:()=>w,JY:()=>q,Ov:()=>D,R8:()=>A,U7:()=>m,Ws:()=>S,YL:()=>z,al:()=>P,de:()=>C,iL:()=>b,iy:()=>g,m_:()=>E,n4:()=>j}),s("../node_modules/core-js/modules/web.dom-collections.iterator.js"),s("../node_modules/core-js/modules/es.array.includes.js");var r=s("../node_modules/react-router/es/index.js"),n=s("./app/constants/pageFilters.tsx"),o=s("./app/data/platformCategories.tsx"),i=s("./app/utils/analytics.tsx"),a=s("./app/utils/dates.tsx"),l=s("./app/utils/discover/fields.tsx"),d=s("./app/utils/formatters.tsx"),c=s("./app/utils/getCurrentSentryReactTransaction.tsx"),p=s("./app/utils/queryString.tsx"),u=s("./app/utils/tokenizeSearch.tsx"),h=s("./app/views/performance/trends/utils.tsx");const m=["environment","project","query","start","end","statsPeriod"];let g;!function(e){e.ANY="any",e.FRONTEND="frontend",e.BACKEND="backend",e.FRONTEND_OTHER="frontend_other",e.MOBILE="mobile"}(g||(g={}));const v=[...o.tQ],y=o.y3.filter((e=>"native"!==e)),f=[...o.ai];function x(e,t){if(0===t.length||t[0]===n.mP)return g.ANY;const s=e.filter((e=>t.includes(parseInt(`${e.id}`,10))));return 0===s.length||s.some((e=>!e.platform))?g.ANY:s.every((e=>v.includes(e.platform)))?g.FRONTEND:s.every((e=>y.includes(e.platform)))?g.BACKEND:s.every((e=>f.includes(e.platform)))?g.MOBILE:g.ANY}function Z(e,t){const s=x(e,t.project);return s===g.FRONTEND&&new u.MY(t.query).getFilterValues("!transaction.op").some((e=>"pageload"===e))?g.FRONTEND_OTHER:s}function w(e,t){return Z(t,e)===g.FRONTEND}function b(e,t){return Z(t,e)===g.FRONTEND||Z(t,e)===g.FRONTEND_OTHER}function C(e){return`/organizations/${e.slug}/performance/`}function S(e){return`/organizations/${e.slug}/performance/trends/`}function D(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return(0,p.ro)(e.query.query,t).trim()}function A(e){let{location:t,organization:s}=e;(0,i.ec)({eventKey:"performance_views.change_view",eventName:"Performance Views: Change View",organization_id:parseInt(s.id,10),view_name:"TRENDS"});const n=P({location:t,organization:s});r.browserHistory.push(n)}function P(e){let{location:t,organization:s,initialConditions:r,additionalQuery:n}=e;const o={...t.query,...n},i=(0,p.ro)(t.query.query,""),a=new u.MY(i),l=null!=r?r:new u.MY([]);return a.hasFilter("tpm()")?l.setFilterValues("tpm()",a.getFilterValues("tpm()")):l.setFilterValues("tpm()",[">0.01"]),a.hasFilter("transaction.duration")?l.setFilterValues("transaction.duration",a.getFilterValues("transaction.duration")):l.setFilterValues("transaction.duration",[">0",`<${h.bg}`]),o.query=l.formatString(),{pathname:S(s),query:{...o}}}function E(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{excludeTagKeys:new Set(["event.type","project"])};return e.getFilterKeys().forEach((s=>{const r=s.startsWith("!")?s.substr(1):s;(r.match(/\w+\(.*\)/)||l.J8.includes(r)||t.excludeTagKeys.has(r))&&e.removeFilter(s)})),e}function j(e){const t=(0,c.Z)(),s=(0,a.Ri)(e.datetime.period,e.datetime.start,e.datetime.end),r=Math.floor(86400*s);null==t||t.setTag("query.period",r.toString());let n=">30d";r<=86400?n="<=1d":r<=604800?n="<=7d":r<=1209600?n="<=14d":r<=2592e3&&(n="<=30d"),null==t||t.setTag("query.period.grouped",n)}function q(e){const{transaction:t}=e.query;return(0,p.ro)(t)}function z(e){return(0,d.g9)(e/1e3,e>1e3?2:0,!0)}}}]);
//# sourceMappingURL=../sourcemaps/app_views_eventsV2_results_tsx.88ebe42a01a19687814d2f25bc027e5c.js.map