(globalThis.webpackChunk=globalThis.webpackChunk||[]).push([["app_views_performance_content_tsx","app_components_searchBar_tsx","app_components_dropdownControl_tsx"],{"./app/components/dropdownControl.tsx":(t,e,r)=>{"use strict";r.d(e,{VY:()=>g,ZP:()=>v,hP:()=>f});var n=r("../node_modules/@babel/runtime/helpers/esm/defineProperty.js"),i=r("../node_modules/@emotion/styled/base/dist/emotion-styled-base.browser.esm.js"),o=r("../node_modules/react/index.js"),a=r("./app/components/dropdownBubble.tsx"),s=r("./app/components/dropdownButton.tsx"),l=r("./app/components/dropdownMenu.tsx"),d=r("./app/components/menuItem.tsx"),c=r("./app/components/tooltip.tsx"),u=r("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");class p extends o.Component{renderButton(t,e){const{label:r,button:n,buttonProps:i,buttonTooltipTitle:o,priority:a,detached:s,fullWidth:l}=this.props;return n?n({isOpen:t,getActorProps:e}):o&&!t?(0,u.tZ)(c.Z,{skipWrapper:!0,position:"top",title:o,children:(0,u.tZ)(m,{priority:a,...e(i),isOpen:t,"data-test-id":"dropdown-control-button",detached:s,hideBottomBorder:!s,rightAlignChevron:null!=l&&l,children:r})}):(0,u.tZ)(m,{priority:a,...e(i),isOpen:t,"data-test-id":"dropdown-control-button",detached:s,hideBottomBorder:!s,rightAlignChevron:null!=l&&l,children:r})}renderChildren(t,e){const{children:r,alignRight:n,menuWidth:i,blendWithActor:o,priority:a,detached:s}=this.props;if("function"==typeof r)return r({isOpen:t,getMenuProps:e});const l=n?"right":"left";return(0,u.tZ)(g,{...e(),priority:a,alignMenu:l,width:i,isOpen:t,blendWithActor:o,detached:s,blendCorner:!0,"data-test-id":"dropdown-control",children:r})}render(){const{alwaysRenderMenu:t,className:e,fullWidth:r}=this.props;return(0,u.tZ)(h,{className:e,fullWidth:null!=r&&r,children:(0,u.tZ)(l.Z,{alwaysRenderMenu:t,children:t=>{let{isOpen:e,getMenuProps:r,getActorProps:n}=t;return(0,u.BX)(o.Fragment,{children:[this.renderButton(e,n),this.renderChildren(e,r)]})}})})}}p.displayName="DropdownControl",(0,n.Z)(p,"defaultProps",{alwaysRenderMenu:!0,menuWidth:"100%"});const h=(0,i.Z)("div",{target:"endo0sm3"})("display:inline-block;position:relative;@media (max-width: ",(t=>t.theme.breakpoints.small),"){width:",(t=>t.fullWidth&&"100%"),";}"),m=(0,i.Z)(s.Z,{target:"endo0sm2"})("z-index:",(t=>t.theme.zIndex.dropdownAutocomplete.actor),";white-space:nowrap;"),g=(0,i.Z)(a.Z,{target:"endo0sm1"})("display:",(t=>t.isOpen?"block":"none"),";border-color:",(t=>t.theme.button[t.priority||"form"].border),";"),f=(0,i.Z)(d.Z,{target:"endo0sm0"})("font-size:",(t=>t.theme.fontSizeMedium),";"),v=p},"./app/components/searchBar.tsx":(t,e,r)=>{"use strict";r.d(e,{Z:()=>Z});var n=r("../node_modules/@babel/runtime/helpers/esm/defineProperty.js"),i=r("../node_modules/@emotion/styled/base/dist/emotion-styled-base.browser.esm.js"),o=(r("../node_modules/core-js/modules/web.dom-collections.iterator.js"),r("../node_modules/react/index.js")),a=r("../node_modules/classnames/index.js"),s=r.n(a),l=r("./app/components/button.tsx"),d=r("./app/components/forms/controls/input.tsx"),c=r("./app/icons/index.tsx"),u=r("./app/icons/iconClose.tsx"),p=r("./app/locale.tsx"),h=r("./app/utils/callIfFunction.tsx"),m=r("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");class g extends o.PureComponent{constructor(){super(...arguments),(0,n.Z)(this,"state",{query:this.props.query||this.props.defaultQuery,dropdownVisible:!1}),(0,n.Z)(this,"searchInputRef",(0,o.createRef)()),(0,n.Z)(this,"blur",(()=>{this.searchInputRef.current&&this.searchInputRef.current.blur()})),(0,n.Z)(this,"onSubmit",(t=>{t.preventDefault(),this.blur(),this.props.onSearch(this.state.query)})),(0,n.Z)(this,"clearSearch",(()=>{this.setState({query:this.props.defaultQuery},(()=>{this.props.onSearch(this.state.query),(0,h.g)(this.props.onChange,this.state.query)}))})),(0,n.Z)(this,"onQueryFocus",(()=>{this.setState({dropdownVisible:!0})})),(0,n.Z)(this,"onQueryBlur",(()=>{this.setState({dropdownVisible:!1})})),(0,n.Z)(this,"onQueryChange",(t=>{const{value:e}=t.target;this.setState({query:e}),(0,h.g)(this.props.onChange,e)}))}UNSAFE_componentWillReceiveProps(t){t.query!==this.props.query&&this.setState({query:t.query})}render(){const{className:t,width:e,query:r,defaultQuery:n,onChange:i,onSearch:o,...a}=this.props;return(0,m.tZ)("div",{className:s()("search",t),children:(0,m.tZ)("form",{className:"form-horizontal",onSubmit:this.onSubmit,children:(0,m.BX)("div",{children:[(0,m.tZ)(f,{...a,type:"text",className:"search-input",name:"query",ref:this.searchInputRef,autoComplete:"off",value:this.state.query,onBlur:this.onQueryBlur,onChange:this.onQueryChange,width:e}),(0,m.tZ)(v,{className:"search-input-icon",size:"sm",color:"gray300"}),this.state.query!==n&&(0,m.tZ)(y,{type:"button",className:"search-clear-form",priority:"link",onClick:this.clearSearch,size:"xsmall",icon:(0,m.tZ)(u.b,{}),"aria-label":(0,p.t)("Clear")})]})})})}}g.displayName="SearchBar",(0,n.Z)(g,"defaultProps",{query:"",defaultQuery:"",onSearch:function(){}});const f=(0,i.Z)(d.Z,{target:"e4xnwji2"})("width:",(t=>t.width?t.width:void 0),";&.focus-visible{box-shadow:0 0 0 1px ",(t=>t.theme.focusBorder),";border-color:",(t=>t.theme.focusBorder),";outline:none;}"),v=(0,i.Z)(c.jV,{target:"e4xnwji1"})({name:"ax87xc",styles:"position:absolute;top:50%;transform:translateY(-50%);left:14px"}),y=(0,i.Z)(l.ZP,{target:"e4xnwji0"})("position:absolute;top:50%;height:16px;transform:translateY(-50%);right:10px;font-size:",(t=>t.theme.fontSizeLarge),";color:",(t=>t.theme.gray200),";&:hover{color:",(t=>t.theme.gray300),";}"),Z=g},"./app/utils/usePrevious.tsx":(t,e,r)=>{"use strict";r.d(e,{Z:()=>i});var n=r("../node_modules/react/index.js");const i=function(t){const e=(0,n.useRef)(t);return(0,n.useEffect)((()=>{e.current=t}),[t]),e.current}},"./app/views/performance/content.tsx":(t,e,r)=>{"use strict";r.r(e),r.d(e,{default:()=>Ir}),r("../node_modules/core-js/modules/web.dom-collections.iterator.js"),r("../node_modules/core-js/modules/es.array.includes.js"),r("../node_modules/core-js/modules/es.error.cause.js");var n=r("../node_modules/react/index.js"),i=r("../node_modules/react-router/es/index.js"),o=r("../node_modules/@sentry/hub/esm/exports.js"),a=r("../node_modules/lodash/isEqual.js"),s=r.n(a),l=r("./app/actionCreators/tags.tsx"),d=r("./app/components/organizations/pageFilters/container.tsx"),c=r("./app/components/sentryDocumentTitle.tsx"),u=r("./app/constants/pageFilters.tsx"),p=r("./app/locale.tsx"),h=r("./app/utils/analytics/trackAdvancedAnalyticsEvent.tsx"),m=r("./app/utils/performance/contexts/metricsEnhancedSetting.tsx"),g=r("./app/utils/performance/contexts/performanceEventViewContext.tsx"),f=r("./app/utils/useApi.tsx"),v=r("./app/utils/useOrganization.tsx"),y=r("./app/utils/usePrevious.tsx"),Z=r("./app/utils/useProjects.tsx"),w=r("./app/utils/withPageFilters.tsx"),S=r("./app/views/performance/data.tsx"),x=r("../node_modules/@emotion/styled/base/dist/emotion-styled-base.browser.esm.js"),b=(r("../node_modules/core-js/modules/es.string.replace.js"),r("./app/actionCreators/modal.tsx")),C=r("./app/components/acl/feature.tsx"),_=r("./app/components/button.tsx"),A=r("./app/components/buttonBar.tsx"),E=r("./app/components/datePageFilter.tsx"),P=r("./app/components/environmentPageFilter.tsx"),T=r("./app/components/events/searchBar.tsx"),R=r("./app/components/globalSdkUpdateAlert.tsx"),j=r("./app/components/layouts/thirds.tsx"),O=r("./app/components/loadingIndicator.tsx"),D=r("./app/components/organizations/pageFilterBar.tsx"),L=r("./app/components/pageHeading.tsx"),F=r("../node_modules/@emotion/react/dist/emotion-react.browser.esm.js"),q=r("../node_modules/lodash/debounce.js"),M=r.n(q),N=r("./app/components/searchBar.tsx"),I=r("./app/constants/index.tsx"),z=r("./app/utils/discover/genericDiscoverQuery.tsx"),k=r("./app/utils/tokenizeSearch.tsx"),B=r("./app/views/performance/transactionSummary/utils.tsx"),V=r("./app/components/smartSearchBar/searchDropdown.tsx"),W=r("./app/components/smartSearchBar/types.tsx"),H=r("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");function X(t){var e;const{organization:r,eventView:o}=t,[a,s]=(0,n.useState)([]),[l,d]=(0,n.useState)(!1),c=(0,f.Z)(),u=t=>`${"*"===t[0]?"":"*"}${t}${"*"===t[t.length-1]?"":"*"}`,h=M()((async t=>{var e;if(t.length<3)return void s([]);const n=null===(e=o.project)||void 0===e?void 0:e.map(String);try{d(!0);const e=new k.MY("");e.addFilterValues("transaction",[u(t)],!1),e.addFilterValues("event.type",["transaction"]),Object.keys(c.activeRequests).length&&c.clear();const i=r.features.includes("performance-frontend-use-events-endpoint")?`/organizations/${r.slug}/events/`:`/organizations/${r.slug}/eventsv2/`,[a]=await(0,z.AA)(c,i,{field:["transaction","project_id","count()"],project:n,sort:"-transaction",query:e.formatString(),statsPeriod:o.statsPeriod}),l=a.data.reduce(((t,e)=>(t.children.push({value:`${e.transaction}:${e.project_id}`,title:e.transaction,type:W.q.DEFAULT,desc:""}),t)),{title:"",children:[],icon:null,type:W.q.DEFAULT});s([l])}catch(t){throw new Error("Unable to fetch event field values")}finally{d(!1)}}),I.Dk,{leading:!0});return(0,H.BX)(Q,{"data-test-id":"transaction-search-bar",children:[(0,H.tZ)(N.Z,{placeholder:(0,p.t)("Search Transactions"),onChange:h}),(0,H.tZ)(V.Z,{css:(0,F.iv)({display:null!==(e=a[0])&&void 0!==e&&e.children.length?"block":"none",maxHeight:"300px",overflowY:"auto"},"",""),loading:l,items:a,onClick:t=>{const e=t.lastIndexOf(":"),n=t.slice(0,e),a=t.slice(e+1),s=o.generateQueryStringObject(),l=(0,B.e1)({orgSlug:r.slug,transaction:String(n),projectID:a,query:s});i.browserHistory.push(l)}})]})}X.displayName="SearchBar";const Q=(0,x.Z)("div",{target:"e8fo1u0"})({name:"bjn8wh",styles:"position:relative"}),U=X;var $=r("./app/components/performance/teamKeyTransactionsManager.tsx"),Y=r("./app/components/projectPageFilter.tsx"),G=r("./app/icons/index.tsx"),K=r("./app/styles/organization.tsx"),J=r("./app/styles/space.tsx"),tt=r("./app/utils/discover/fields.tsx"),et=(r("../node_modules/core-js/modules/es.reflect.to-string-tag.js"),r("./app/utils/performance/contexts/utils.tsx"));const[rt,nt]=(0,et.n)({name:"GenericQueryBatcherContext"});function it(t){return`${t.batchProperty}.${t.path}`}function ot(t,e,r){return t.requestPromise(e,r)}function at(t){const e=ot(t.api,t.path,t.requestQueryObject);t.resolve(e)}const st=t=>{let{children:e}=t;const r=(0,n.useRef)({}),i=(0,n.useRef)(void 0),o=(0,v.Z)();return(0,n.useEffect)((()=>()=>{i.current&&window.clearTimeout(i.current)}),[]),(0,H.tZ)(rt,{value:{addQuery:(t,e)=>{r.current[e]=t,window.clearTimeout(i.current),i.current=window.setTimeout((()=>{(function(t,e){const r=function(t){const e=Reflect.ownKeys(t);if(!e.length)return!1;const r={};return e.forEach((e=>{const n=t[e];r[it(n)]=r[it(n)]||[],r[it(n)].push(n),delete t[e]})),r}(e);if(!r)return;let n=0;n+=function(t){let e=0;return Object.keys(t).forEach((r=>{const n=t[r];if(1===n.length){const[t]=n;e++,at(t)}})),e}(r),n+=function(t){let e=0;return Object.keys(t).forEach((async r=>{const n=t[r];if(n.length<=1)return;const[i]=n,o=i.batchProperty,a={...i.requestQueryObject.query},s={...i.requestQueryObject,query:a},l=[];n.forEach((t=>{const r=t.requestQueryObject.query[o];if(Array.isArray(r)){if(r.length>1)return e++,void at(t);l.push(r[0])}else l.push(r)})),s.query[o]=l,e++;const d=ot(i.api,i.path,s);try{const t=await d;n.forEach((e=>{const r=Array.isArray(e.requestQueryObject.query[e.batchProperty])?e.requestQueryObject.query[e.batchProperty][0]:e.requestQueryObject.query[e.batchProperty],n=t[r];e.resolve(n)}))}catch(t){n.forEach((e=>e.reject(t)))}})),e}(r);const i=Object.values(r).reduce(((t,e)=>t+e.length),0),o=i-n;(0,h.Z)("performance_views.landingv3.batch_queries",{organization:t,num_collected:i,num_saved:o,num_sent:n})})(o,r.current),i.current=void 0}),0)}},children:e})};st.displayName="GenericQueryBatcher";const lt=(0,n.createContext)(void 0);function dt(t){const e=(0,f.Z)(),{batchProperty:r,children:i}=t,o=(0,n.useRef)(Symbol());let a;try{a=nt()}catch(t){return(0,H.tZ)(n.Fragment,{children:i({})})}const s={batchRequest:function(t,n,i){return new Promise(((t,s)=>{var l;const d={resolve:t,reject:s,batchProperty:r,path:n,requestQueryObject:i,api:e};null===(l=a)||void 0===l||l.addQuery(d,o.current)}))}};return(0,H.tZ)(lt.Provider,{value:{id:o,batchProperty:r},children:i({queryBatching:s})})}dt.displayName="QueryBatchNode";var ct=r("./app/components/alert.tsx");const ut=(0,n.createContext)({pageError:void 0,setPageError:t=>{}}),pt=t=>{let{children:e}=t;const[r,i]=(0,n.useState)();return(0,H.tZ)(ut.Provider,{value:{pageError:r,setPageError:i},children:e})};pt.displayName="PageErrorProvider";const ht=()=>{const{pageError:t}=(0,n.useContext)(ut);return t?(0,H.tZ)(ct.Z,{type:"error","data-test-id":"page-error-alert",showIcon:!0,children:t}):null};ht.displayName="PageErrorAlert";const mt=()=>(0,n.useContext)(ut);var gt=r("./app/utils/useTeams.tsx"),ft=r("./app/views/performance/onboarding.tsx"),vt=r("./app/views/performance/transactionSummary/transactionOverview/metricEvents/metricsEventsDropdown.tsx"),yt=r("./app/views/performance/utils.tsx");const[Zt,wt]=(0,et.n)({name:"CurrentPerformanceViewContext"});function St(){return wt().performanceType}var xt=r("../node_modules/@babel/runtime/helpers/esm/defineProperty.js"),bt=r("./app/actionCreators/indicator.tsx"),Ct=r("./app/components/assistant/guideAnchor.tsx"),_t=r("./app/components/gridEditable/index.tsx"),At=r("./app/components/gridEditable/sortLink.tsx"),Et=r("./app/components/links/link.tsx"),Pt=r("./app/components/pagination.tsx"),Tt=r("./app/components/tooltip.tsx"),Rt=r("./app/utils.tsx"),jt=r("./app/utils/discover/discoverQuery.tsx"),Ot=r("./app/utils/discover/eventView.tsx"),Dt=r("./app/utils/discover/fieldRenderers.tsx"),Lt=r("./app/views/eventsV2/table/cellAction.tsx"),Ft=r("./app/views/performance/landing/widgets/utils.tsx"),qt=r("./app/views/performance/transactionSummary/transactionThresholdModal.tsx");function Mt(t,e){const r=(null==t?void 0:t.project)||void 0;if(void 0===typeof r)return;const n=e.find((t=>t.slug===r));return n?n.id:void 0}class Nt extends n.Component{constructor(){super(...arguments),(0,xt.Z)(this,"state",{widths:[],transaction:void 0,transactionThreshold:void 0,transactionThresholdMetric:void 0}),(0,xt.Z)(this,"handleCellAction",((t,e)=>(r,n)=>{const{eventView:o,location:a,organization:s,projects:l}=this.props;if((0,h.Z)("performance_views.overview.cellaction",{organization:s,action:r}),r===Lt.eX.EDIT_THRESHOLD){const t=e.project_threshold_config,r=e.transaction,n=Mt(e,l);return void(0,b.openModal)((e=>(0,H.tZ)(qt.ZP,{...e,organization:s,transactionName:r,eventView:o,project:n,transactionThreshold:t[1],transactionThresholdMetric:t[0],onApply:(e,n)=>{e===t[1]&&n===t[0]||this.setState({transaction:r,transactionThreshold:e,transactionThresholdMetric:n}),(0,bt.S9)((0,p._N)("[transactionName] updated successfully",{transactionName:r}))}})),{modalCss:qt.fY,backdrop:"static"})}const d=(0,B.PU)(o.query);(0,Lt.rh)(d,r,t,n),i.browserHistory.push({pathname:a.pathname,query:{...a.query,cursor:void 0,query:d.formatString()}})})),(0,xt.Z)(this,"renderBodyCellWithData",(t=>(e,r)=>this.renderBodyCell(t,e,r))),(0,xt.Z)(this,"paginationAnalyticsEvent",(t=>{const{organization:e}=this.props;(0,h.Z)("performance_views.landingv3.table_pagination",{organization:e,direction:t})})),(0,xt.Z)(this,"renderHeadCellWithMeta",(t=>{var e;const r=null!==(e=this.props.columnTitles)&&void 0!==e?e:S.hj;return(e,n)=>this.renderHeadCell(t,e,r[n])})),(0,xt.Z)(this,"renderPrependCellWithData",(t=>{const{eventView:e}=this.props,r=e.getColumns().find((t=>"team_key_transaction"===t.name));return(e,n)=>{if(r){if(e){const e=(0,H.tZ)(G.GK,{color:"yellow300",isSolid:!0,"data-test-id":"team-key-transaction-header"},"keyTransaction");return[this.renderHeadCell(null==t?void 0:t.meta,r,e)]}return[this.renderBodyCell(t,r,n)]}return[]}})),(0,xt.Z)(this,"handleSummaryClick",(()=>{const{organization:t}=this.props;(0,h.Z)("performance_views.overview.navigate.summary",{organization:t})})),(0,xt.Z)(this,"handleResizeColumn",((t,e)=>{const r=[...this.state.widths];r[t]=e.width?Number(e.width):_t.z7,this.setState({widths:r})}))}renderBodyCell(t,e,r){const{eventView:n,organization:i,projects:o,location:a,withStaticFilters:s}=this.props,l=!i.features.includes("performance-frontend-use-events-endpoint");if(!t||!t.meta)return r[e.key];const d=t.meta,c=String(e.key),u=(0,Dt.Js)(c,d,l)(r,{organization:i,location:a}),p=[Lt.eX.ADD,Lt.eX.EXCLUDE,Lt.eX.SHOW_GREATER_THAN,Lt.eX.SHOW_LESS_THAN,Lt.eX.EDIT_THRESHOLD],h=s?[]:p;if("transaction"===c){const t=Mt(r,o),a=n.clone();r["http.method"]&&a.additionalConditions.setFilterValues("http.method",[r["http.method"]]),a.query=a.getQueryWithAdditionalConditions();const s=(0,B.e1)({orgSlug:i.slug,transaction:String(r.transaction)||"",query:a.generateQueryStringObject(),projectID:t});return(0,H.tZ)(Lt.ZP,{column:e,dataRow:r,handleCellAction:this.handleCellAction(e,r),allowActions:h,children:(0,H.tZ)(Et.Z,{to:s,onClick:this.handleSummaryClick,style:{display:"block",width:"100%"},children:u})})}if(c.startsWith("team_key_transaction"))return u;const m=(0,tt.LY)(c),g=r[m];return"integer"===d[m]&&(0,Rt.ri)(g)&&g>999?(0,H.tZ)(Tt.Z,{title:g.toLocaleString(),containerDisplayMode:"block",position:"right",children:(0,H.tZ)(Lt.ZP,{column:e,dataRow:r,handleCellAction:this.handleCellAction(e,r),allowActions:h,children:u})}):(0,H.tZ)(Lt.ZP,{column:e,dataRow:r,handleCellAction:this.handleCellAction(e,r),allowActions:h,children:u})}onSortClick(t,e){const{organization:r}=this.props;(0,h.Z)("performance_views.landingv2.transactions.sort",{organization:r,field:e,direction:t})}renderHeadCell(t,e,r){const{eventView:n,location:i}=this.props,o=(0,tt.qG)(e.name,e.type,t),a={field:e.name,width:e.width},s=n.sortForField(a,t),l=(0,Ot.M3)(a,t),d=s?s.kind:void 0,c=s?s.field:void 0,u=(0,H.tZ)(At.Z,{align:o,title:r||a.field,direction:d,canSort:l,generateSortLink:function(){if(!t)return;const e=n.sortOnField(a,t).generateQueryStringObject();return{...i,query:{...i.query,sort:e.sort}}},onClick:()=>this.onSortClick(d,c)});return a.field.startsWith("user_misery")?(0,H.tZ)(Ct.Z,{target:"project_transaction_threshold",position:"top",children:u}):u}getSortedEventView(){const{eventView:t}=this.props;return t.withSorts([{field:"team_key_transaction",kind:"desc"},...t.sorts])}render(){const{eventView:t,organization:e,location:r,setError:i}=this.props,o=e.features.includes("performance-frontend-use-events-endpoint"),{widths:a,transaction:s,transactionThreshold:l}=this.state,d=t.getColumns(o).filter((t=>"team_key_transaction"!==t.name&&!t.name.startsWith("count_miserable")&&"project_threshold_config"!==t.name)).map(((t,e)=>"number"==typeof a[e]?{...t,width:a[e]}:t)),c=this.getSortedEventView(),u=c.getSorts(),p=["max-content"];return(0,H.tZ)("div",{children:(0,H.tZ)(m.nP,{children:t=>(0,H.tZ)(jt.Z,{eventView:c,orgSlug:e.slug,location:r,setError:t=>i(null==t?void 0:t.message),referrer:"api.performance.landing-table",transactionName:s,transactionThreshold:l,queryExtras:(0,Ft.gM)(t),useEvents:o,children:t=>{let{pageLinks:e,isLoading:i,tableData:o}=t;return(0,H.BX)(n.Fragment,{children:[(0,H.tZ)(_t.ZP,{isLoading:i,data:o?o.data:[],columnOrder:d,columnSortBy:u,grid:{onResizeColumn:this.handleResizeColumn,renderHeadCell:this.renderHeadCellWithMeta(null==o?void 0:o.meta),renderBodyCell:this.renderBodyCellWithData(o),renderPrependColumns:this.renderPrependCellWithData(o),prependColumnWidths:p},location:r}),(0,H.tZ)(Pt.Z,{pageLinks:e,paginationAnalyticsEvent:this.paginationAnalyticsEvent})]})}})})})}}function It(t){var e;const r=null!==(e=t.summaryConditions)&&void 0!==e?e:t.eventView.getQueryWithAdditionalConditions();return(0,H.tZ)(Nt,{...t,summaryConditions:r})}Nt.displayName="_Table",It.displayName="Table";const zt=It;var kt=r("../node_modules/@emotion/react/dist/emotion-element-cbed451f.browser.esm.js");const Bt=(0,x.Z)("div",{target:"e13nlx020"})("display:grid;grid-template-columns:1fr;grid-column-gap:",(0,J.Z)(2),";grid-row-gap:",(0,J.Z)(2),";@media (min-width: ",(t=>t.theme.breakpoints.small),"){grid-template-columns:repeat(2, 1fr);}@media (min-width: ",(t=>t.theme.breakpoints.large),"){",(t=>t.columns?`\n    grid-template-columns: repeat(${t.columns}, 1fr);\n    `:`\n    grid-template-columns: repeat(auto-fit, minmax(${t.minSize}px, 1fr));\n    `),";}");var Vt=r("../node_modules/lodash/pick.js"),Wt=r.n(Vt),Ht=r("./app/components/dropdownButtonV2.tsx"),Xt=r("./app/components/forms/compactSelect.tsx"),Qt=r("./app/icons/iconEllipsis.tsx"),Ut=r("./app/utils/withOrganization.tsx"),$t=r("./app/views/performance/landing/widgets/types.tsx"),Yt=r("./app/views/performance/landing/widgets/widgetDefinitions.tsx"),Gt=r("./app/utils/performance/histogram/histogramQuery.tsx"),Kt=r("./app/components/charts/barChart.tsx"),Jt=r("./app/components/charts/barChartZoom.tsx"),te=(r("./app/components/charts/errorPanel.tsx"),r("./app/components/charts/styles.tsx"),r("./app/components/charts/transparentLoadingMask.tsx")),ee=r("./app/components/placeholder.tsx"),re=(r("./app/components/questionTooltip.tsx"),r("./app/icons/iconWarning.tsx"),r("./app/utils/formatters.tsx")),ne=r("./app/utils/getDynamicText.tsx"),ie=r("./app/utils/performance/histogram/utils.tsx");r("./app/views/performance/styles.tsx");function oe(t){const{isLoading:e,isErrored:r,chartData:i,location:o,field:a,onFilterChange:s,height:l,grid:d,disableXAxis:c,disableZoom:u,disableChartPadding:h,colors:m}=t,g=(0,kt.a)();if(!i)return null;const f={seriesName:(0,p.t)("Count"),data:(0,ie.GT)(i,{type:"duration"})},v={type:"category",truncate:!0,axisTick:{alignWithLabel:!0}},y=[];e||r||y.push(f);const Z={type:"value",axisLabel:{color:g.chartLabel,formatter:re.Du}};return(0,H.tZ)(n.Fragment,{children:(0,H.tZ)(Jt.Z,{minZoomWidth:50,location:o,paramStart:`${a}:>=`,paramEnd:`${a}:<=`,xAxisIndex:[0],buckets:(0,ie._W)(i),onHistoryPush:s,children:t=>(0,H.tZ)(ae,{hasPadding:!h,children:(0,H.BX)(se,{children:[(0,H.tZ)(te.Z,{visible:e}),(0,ne.Z)({value:(0,H.tZ)(Kt.v,{height:null!=l?l:250,series:y,xAxis:c?{show:!1}:v,yAxis:Z,colors:m,grid:null!=d?d:{left:(0,J.Z)(3),right:(0,J.Z)(3),top:(0,J.Z)(3),bottom:e?(0,J.Z)(4):(0,J.Z)(1.5)},stacked:!0,...u?{}:t}),fixed:(0,H.tZ)(ee.Z,{height:"250px",testId:"skeleton-ui"})})]})})})})}oe.displayName="Chart";const ae=(0,x.Z)("div",{target:"e1kr7yxp1"})("padding-top:",(t=>t.hasPadding?(0,J.Z)(1):0),";position:relative;"),se=(0,x.Z)("div",{target:"e1kr7yxp0"})({name:"bjn8wh",styles:"position:relative"});var le=r("./app/views/performance/landing/widgets/components/performanceWidget.tsx");function de(t,e){const{histograms:r}=e;return{...e,data:r,isLoading:e.isLoading,isErrored:null!==e.error,hasData:!!Object.values(r||{}).length}}function ce(t){const e=(0,m.Eg)(),{ContainerActions:r,location:i}=t,o=t.eventView.getPageFilters(),a=(0,n.useMemo)((()=>({chart:{fields:t.fields,component:r=>(0,H.tZ)(Gt.Z,{...r,eventView:r.eventView,location:t.location,numBuckets:20,dataFilter:"exclude_outliers",queryExtras:(0,Ft.gM)(e)}),transform:de}})),[t.chartSetting,e.memoizationKey]),s=()=>{};return(0,H.tZ)(le.I,{...t,Subtitle:()=>(0,H.tZ)(ue,{children:o.datetime.period?(0,p.t)("In the last %s ",o.datetime.period):(0,p.t)("In the last period")}),HeaderActions:t=>(0,H.tZ)(n.Fragment,{children:(0,H.tZ)(r,{...t.widgetData.chart})}),Queries:a,Visualizations:[{component:e=>{var r,n;return(0,H.tZ)(oe,{...e,colors:t.chartColor?[t.chartColor]:void 0,location:i,isLoading:!1,isErrored:!1,onFilterChange:s,field:t.fields[0],chartData:null===(r=e.widgetData.chart)||void 0===r||null===(n=r.data)||void 0===n?void 0:n[t.fields[0]],disableXAxis:!0,disableZoom:!0,disableChartPadding:!0})},height:t.chartHeight}]})}ce.displayName="HistogramWidget";const ue=(0,x.Z)("span",{target:"elb5aiu0"})("color:",(t=>t.theme.gray300),";font-size:",(t=>t.theme.fontSizeMedium),";");var pe=r("./app/components/charts/eventsRequest.tsx"),he=r("./app/components/charts/utils.tsx"),me=r("./app/components/count.tsx"),ge=r("./app/components/truncate.tsx"),fe=r("./app/utils/queryString.tsx"),ve=r("./app/utils/withApi.tsx"),ye=r("../node_modules/lodash/max.js"),Ze=r.n(ye),we=r("../node_modules/lodash/min.js"),Se=r.n(we),xe=r("./app/components/charts/areaChart.tsx"),be=r("./app/components/charts/chartZoom.tsx"),Ce=r("./app/components/charts/lineChart.tsx"),_e=r("./app/utils/discover/charts.tsx");function Ae(t){let{data:e,previousData:r,router:n,statsPeriod:i,start:o,end:a,utc:s,loading:l,height:d,grid:c,disableMultiAxis:u,disableXAxis:p,definedAxisTicks:h,chartColors:m,isLineChart:g}=t;const f=(0,kt.a)();if(!e||e.length<=0)return null;const v=null!=m?m:f.charts.getColorPalette(4),y=e.every((t=>"duration"===(0,tt.Px)(t.seriesName)))?function(t){const e=t.map((t=>t.data.map((t=>t.value)))),r=Ze()(e.map(Ze()));if(r<=1)return 1;const n=Math.log10(r),i=Se()([Ze()([10**(n-Math.floor(n)),0]),10]);let o;o=i<=2.5?.2:i<=5?.5:i<=7.5?1:2;const a=10**Math.floor(n)*o;return Math.round(Math.ceil(r/a)*a)}(e):void 0,Z={seriesOptions:{showSymbol:!1},grid:u?c:[{top:"8px",left:"24px",right:"52%",bottom:"16px"},{top:"8px",left:"52%",right:"24px",bottom:"16px"}],axisPointer:u?void 0:{link:[{xAxisIndex:[0,1]}]},xAxes:u?void 0:[{gridIndex:0,type:"time"},{gridIndex:1,type:"time"}],yAxes:u?[{splitNumber:h,axisLabel:{color:f.chartLabel,formatter:t=>(0,_e.gu)(t,e[0].seriesName)}}]:[{gridIndex:0,scale:!0,max:y,axisLabel:{color:f.chartLabel,formatter:t=>(0,_e.gu)(t,e[0].seriesName)}},{gridIndex:1,scale:!0,max:y,axisLabel:{color:f.chartLabel,formatter:t=>(0,_e.gu)(t,e[1].seriesName)}}],utc:s,isGroupedByDate:!0,showTimeInTooltip:!0,colors:[v[0],v[1]],tooltip:{valueFormatter:(t,r)=>(0,_e.CX)(t,e&&e.length?e[0].seriesName:r),nameFormatter:t=>"epm()"===t?"tpm()":t}};if(l)return g?(0,H.tZ)(Ce.w,{height:d,series:[],...Z}):(0,H.tZ)(xe.T,{height:d,series:[],...Z});const w=e.map(((t,e)=>({...t,yAxisIndex:e,xAxisIndex:e}))),S=p?{show:!1,axisLabel:{show:!0,margin:0},axisLine:{show:!1}}:void 0;return(0,H.tZ)(be.Z,{router:n,period:i,start:o,end:a,utc:s,xAxisIndex:u?void 0:[0,1],children:t=>g?(0,H.tZ)(Ce.w,{height:d,...t,series:w,previousPeriod:r,xAxis:S,yAxis:Z.yAxes[0],tooltip:Z.tooltip}):(0,H.tZ)(xe.T,{height:d,...t,series:w,previousPeriod:r,xAxis:S,...Z})})}Ae.displayName="Chart";const Ee=Ae;var Pe=r("./app/views/performance/landing/utils.tsx"),Te=r("./app/views/performance/landing/widgets/components/selectableList.tsx"),Re=r("./app/components/organizations/pageFilters/parse.tsx");function je(t,e,r){var n,i;const{start:o,end:a,utc:s,interval:l,statsPeriod:d}=(0,Re.fK)(t.location.query,{defaultStatsPeriod:S.GY}),c=null!==(n=null===(i=e.tableData)||void 0===i?void 0:i.data)&&void 0!==n?n:[];return{...e,isErrored:!!e.error,hasData:(0,Rt.ri)(c)&&!!c.length,data:c,utc:"true"===s,interval:l,statsPeriod:null!=d?d:void 0,start:null!=o?o:"",end:null!=a?a:""}}var Oe=r("../node_modules/lodash/mean.js"),De=r.n(Oe);function Le(t,e,r){var n,i;const{start:o,end:a,utc:s,interval:l,statsPeriod:d}=(0,Re.fK)(t.location.query),c=null!==(n=e.timeseriesData)&&void 0!==n?n:[],u=c.map((t=>{const e=De()(t.data.map((t=>{let{value:e}=t;return e})));return{mean:e,outputType:(0,tt.Px)(t.seriesName),label:(0,_e.gu)(e,t.seriesName)}}));return{...e,isLoading:e.loading||e.reloading,isErrored:e.errored,hasData:(0,Rt.ri)(c)&&!!c.length&&!!c[0].data.length,data:c,dataMean:u,previousData:null!==(i=e.previousTimeseriesData)&&void 0!==i?i:void 0,utc:"true"===s,interval:l,statsPeriod:null!=d?d:void 0,start:null!=o?o:"",end:null!=a?a:""}}const Fe=[Yt.s.SLOW_HTTP_OPS,Yt.s.SLOW_DB_OPS,Yt.s.SLOW_BROWSER_OPS,Yt.s.SLOW_RESOURCE_OPS],qe=[Yt.s.MOST_SLOW_FRAMES,Yt.s.MOST_FROZEN_FRAMES];function Me(t){const e=(0,m.Eg)(),[r,i]=(0,n.useState)(0),{ContainerActions:o,organization:a}=t,s=a.features.includes("performance-frontend-use-events-endpoint"),l=mt(),d=t.fields[0];if(1!==t.fields.length)throw new Error(`Line chart list widget can only accept a single field (${t.fields})`);const c=Fe.includes(t.chartSetting),u=qe.includes(t.chartSetting),h={list:(0,n.useMemo)((()=>({fields:d,component:r=>{const n=r.eventView.clone();if(n.sorts=[{kind:"desc",field:d}],t.chartSetting===Yt.s.MOST_RELATED_ISSUES){n.fields=[{field:"issue"},{field:"transaction"},{field:"title"},{field:"project.id"},{field:d}],n.additionalConditions.setFilterValues("event.type",["error"]),n.additionalConditions.setFilterValues("!tags[transaction]",[""]);const t=new k.MY(n.query);t.removeFilter("transaction.duration"),n.additionalConditions.removeFilter("transaction.op"),n.additionalConditions.removeFilter("!transaction.op"),n.query=t.formatString()}else c||u?(n.additionalConditions.setFilterValues("epm()",[">0.01"]),n.fields=[{field:"transaction"},{field:"project.id"},{field:"epm()"},...t.fields.map((t=>({field:t})))]):n.fields=[{field:"transaction"},{field:"project.id"},{field:d}];return n.additionalConditions.setFilterValues(d,[">0"]),(0,H.tZ)(jt.Z,{...r,eventView:n,location:t.location,limit:3,cursor:"0:0:1",noPagination:!0,queryExtras:(0,Ft.I2)(e,t.chartSetting),useEvents:s})},transform:je})),[t.chartSetting,e.memoizationKey]),chart:(0,n.useMemo)((()=>({enabled:t=>{var e,r;return!(null==t||null===(e=t.list)||void 0===e||null===(r=e.data)||void 0===r||!r.length)},fields:d,component:n=>{var i;const o=t.eventView.clone();if(null===(i=n.widgetData.list.data[r])||void 0===i||!i.transaction)return null;if(o.additionalConditions.setFilterValues("transaction",[n.widgetData.list.data[r].transaction]),t.chartSetting===Yt.s.MOST_RELATED_ISSUES){var a;if(null===(a=n.widgetData.list.data[r])||void 0===a||!a.issue)return null;o.fields=[{field:"issue"},{field:"issue.id"},{field:"transaction"},{field:d}],o.additionalConditions.setFilterValues("issue",[n.widgetData.list.data[r].issue]),o.additionalConditions.setFilterValues("event.type",["error"]),o.additionalConditions.setFilterValues("!tags[transaction]",[""]),o.additionalConditions.removeFilter("transaction.op"),o.additionalConditions.removeFilter("!transaction.op");const t=new k.MY(o.query);t.removeFilter("transaction.duration"),o.query=t.formatString()}else o.fields=[{field:"transaction"},{field:d}];return(0,H.tZ)(Ne,{...Wt()(n,Ft.CJ),limit:1,includePrevious:!0,includeTransformedData:!0,partial:!0,currentSeriesNames:[d],query:o.getQueryWithAdditionalConditions(),interval:(0,he.ZS)({start:n.start,end:n.end,period:n.period},"medium"),hideError:!0,onError:l.setPageError,queryExtras:(0,Ft.I2)(e,t.chartSetting),userModified:(0,fe.ro)(t.location.query.userModified)})},transform:Le})),[t.chartSetting,r,e.memoizationKey,t.location.query.userModified])};return(0,H.tZ)(le.I,{...t,Subtitle:()=>(0,H.tZ)(Te.QE,{children:(0,p.t)("Suggested transactions")}),HeaderActions:t=>{var e;return(0,H.tZ)(o,{isLoading:null===(e=t.widgetData.list)||void 0===e?void 0:e.isLoading})},EmptyComponent:Te.xq,Queries:h,Visualizations:[{component:e=>(0,H.tZ)(Ie,{...e.widgetData.chart,...e,disableMultiAxis:!0,disableXAxis:!0,chartColors:t.chartColor?[t.chartColor]:void 0,isLineChart:!0}),height:t.chartHeight},{component:e=>(0,H.tZ)(Te.ZP,{selectedIndex:r,setSelectedIndex:i,items:e.widgetData.list.data.map((e=>()=>{var r;const o=e.transaction,a={};t.chartSetting===Yt.s.SLOW_HTTP_OPS?(a.breakdown="http",a.display="latency"):t.chartSetting===Yt.s.SLOW_DB_OPS?(a.breakdown="db",a.display="latency"):t.chartSetting===Yt.s.SLOW_BROWSER_OPS?(a.breakdown="browser",a.display="latency"):t.chartSetting===Yt.s.SLOW_RESOURCE_OPS&&(a.breakdown="resource",a.display="latency");const l=(0,B.e1)({orgSlug:t.organization.slug,projectID:e["project.id"],transaction:o,query:t.eventView.getPageFiltersQuery(),additionalQuery:a}),u=s?d:(0,tt.LY)(d),h=null!==(r={[Yt.s.MOST_RELATED_ERRORS]:e.failure_count,[Yt.s.MOST_RELATED_ISSUES]:e.issue,slowest:(0,yt.YL)(e[u])}[c?"slowest":t.chartSetting])&&void 0!==r?r:e[u];switch(t.chartSetting){case Yt.s.MOST_RELATED_ISSUES:return(0,H.BX)(n.Fragment,{children:[(0,H.tZ)(Te.qL,{to:l,children:(0,H.tZ)(ge.Z,{value:o,maxLength:40})}),(0,H.tZ)(Te.S$,{children:(0,H.tZ)(Tt.Z,{title:e.title,children:(0,H.tZ)(Et.Z,{to:`/organizations/${t.organization.slug}/issues/${e["issue.id"]}/`,children:h})})}),!t.withStaticFilters&&(0,H.tZ)(Te.Nm,{setSelectListIndex:i,onClick:()=>(0,Pe.kP)(e.transaction,t)})]});case Yt.s.MOST_RELATED_ERRORS:return(0,H.BX)(n.Fragment,{children:[(0,H.tZ)(Te.qL,{to:l,children:(0,H.tZ)(ge.Z,{value:o,maxLength:40})}),(0,H.tZ)(Te.S$,{children:(0,p._N)("[count] errors",{count:(0,H.tZ)(me.Z,{value:h})})}),!t.withStaticFilters&&(0,H.tZ)(Te.Nm,{setSelectListIndex:i,onClick:()=>(0,Pe.kP)(e.transaction,t)})]});default:return"number"==typeof h?(0,H.BX)(n.Fragment,{children:[(0,H.tZ)(Te.qL,{to:l,children:(0,H.tZ)(ge.Z,{value:o,maxLength:40})}),(0,H.tZ)(Te.S$,{children:(0,H.tZ)(me.Z,{value:h})}),!t.withStaticFilters&&(0,H.tZ)(Te.Nm,{setSelectListIndex:i,onClick:()=>(0,Pe.kP)(e.transaction,t)})]}):(0,H.BX)(n.Fragment,{children:[(0,H.tZ)(Te.qL,{to:l,children:(0,H.tZ)(ge.Z,{value:o,maxLength:40})}),(0,H.tZ)(Te.S$,{children:h}),!t.withStaticFilters&&(0,H.tZ)(Te.Nm,{setSelectListIndex:i,onClick:()=>(0,Pe.kP)(e.transaction,t)})]})}}))}),height:124,noPadding:!0}]})}Me.displayName="LineChartListWidget";const Ne=(0,ve.Z)(pe.Z),Ie=(0,i.withRouter)(Ee);function ze(t){const{ContainerActions:e,location:r}=t,i=t.eventView.getPageFilters(),o=mt(),a=(0,m.Eg)();if(1!==t.fields.length)throw new Error(`Single field area can only accept a single field (${t.fields})`);const s=t.fields[0],l={chart:(0,n.useMemo)((()=>({fields:t.fields[0],component:t=>(0,H.tZ)(dt,{batchProperty:"yAxis",children:e=>{let{queryBatching:n}=e;return(0,H.tZ)(ke,{...Wt()(t,Ft.CJ),limit:1,queryBatching:n,includePrevious:!0,includeTransformedData:!0,partial:!0,currentSeriesNames:[s],previousSeriesNames:[(0,he.TE)(s)],query:t.eventView.getQueryWithAdditionalConditions(),interval:(0,he.ZS)({start:t.start,end:t.end,period:t.period},"medium"),hideError:!0,onError:o.setPageError,queryExtras:(0,Ft.gM)(a),userModified:(0,fe.ro)(r.query.userModified)})}}),transform:Le})),[t.chartSetting,a.memoizationKey,r.query.userModified])};return(0,H.tZ)(le.I,{...t,Subtitle:()=>(0,H.tZ)(Ve,{children:i.datetime.period?(0,p.t)("Compared to last %s ",i.datetime.period):(0,p.t)("Compared to the last period")}),HeaderActions:r=>{var i,o,a;return(0,H.BX)(n.Fragment,{children:[(0,H.tZ)(We,{color:t.chartColor,children:null!==(i=r.widgetData.chart)&&void 0!==i&&i.hasData?null===(o=r.widgetData.chart)||void 0===o||null===(a=o.dataMean)||void 0===a?void 0:a[0].label:null}),(0,H.tZ)(e,{...r.widgetData.chart})]})},Queries:l,Visualizations:[{component:e=>(0,H.tZ)(Be,{...e.widgetData.chart,...e,disableMultiAxis:!0,disableXAxis:!0,definedAxisTicks:4,chartColors:t.chartColor?[t.chartColor]:void 0}),height:t.chartHeight}]})}ze.displayName="SingleFieldAreaWidget";const ke=(0,ve.Z)(pe.Z),Be=(0,i.withRouter)(Ee),Ve=(0,x.Z)("span",{target:"eou5xbm1"})("color:",(t=>t.theme.gray300),";font-size:",(t=>t.theme.fontSizeMedium),";"),We=(0,x.Z)("div",{target:"eou5xbm0"})("color:",(t=>t.color),";font-size:",(t=>t.theme.fontSizeExtraLarge),";");var He=r("./app/utils/performance/trends/trendsDiscoverQuery.tsx"),Xe=r("./app/utils/withProjects.tsx"),Qe=r("./app/views/performance/trends/changedTransactions.tsx"),Ue=r("./app/views/performance/trends/chart.tsx"),$e=r("./app/views/performance/trends/types.tsx"),Ye=r("./app/views/performance/trends/utils.tsx");function Ge(t,e){var r;const{trendsData:n}=e,i=n?(0,Ye.RP)(n&&n.events&&n.events.data||[]):[];return{...e,data:n,hasData:!(null==n||null===(r=n.events)||void 0===r||!r.data.length),loading:e.isLoading,isLoading:e.isLoading,isErrored:!!e.error,errored:e.error,statsData:n?n.stats:{},transactionsList:i&&i.slice?i.slice(0,3):[],events:i}}const Ke=[{field:"transaction"},{field:"project"}];function Je(t){const{eventView:e,ContainerActions:r,location:i,organization:o,withStaticFilters:a}=t,s=t.chartSetting===Yt.s.MOST_IMPROVED?$e.ER.IMPROVED:$e.ER.REGRESSION,l=$e.Z2.AVG,[d,c]=(0,n.useState)(0),u=e.clone();u.fields=Ke,u.sorts=[{kind:s===$e.ER.IMPROVED?"asc":"desc",field:"trend_percentage()"}];const h={...t,eventView:u};u.additionalConditions.addFilterValues("tpm()",[">0.01"]),u.additionalConditions.addFilterValues("count_percentage()",[">0.25","<4"]),u.additionalConditions.addFilterValues("trend_percentage()",[">0%"]),u.additionalConditions.addFilterValues("confidence()",[">6"]);const m={chart:(0,n.useMemo)((()=>({fields:["transaction","project"],component:e=>(0,H.tZ)(He.ZP,{...e,eventView:e.eventView,location:t.location,trendChangeType:s,trendFunctionField:l,limit:3,cursor:"0:0:1",noPagination:!0}),transform:Ge})),[t.chartSetting,s])};return(0,H.tZ)(le.I,{...h,Subtitle:()=>(0,H.tZ)(Te.QE,{children:(0,p.t)("Trending Transactions")}),HeaderActions:t=>(0,H.BX)(n.Fragment,{children:[(0,H.tZ)("div",{children:(0,H.tZ)(_.ZP,{onClick:()=>(0,yt.R8)({location:i,organization:o}),size:"small","data-test-id":"view-all-button",children:(0,p.t)("View All")})}),(0,H.tZ)(r,{...t.widgetData.chart})]}),EmptyComponent:Te.xq,Queries:m,Visualizations:[{component:t=>(0,H.tZ)(tr,{...t,...h,isLoading:t.widgetData.chart.isLoading,statsData:t.widgetData.chart.statsData,query:u.query,project:u.project,environment:u.environment,start:u.start,end:u.end,statsPeriod:u.statsPeriod,transaction:t.widgetData.chart.transactionsList[d],trendChangeType:s,trendFunctionField:l,disableXAxis:!0,disableLegend:!0}),bottomPadding:!1,height:t.chartHeight},{component:e=>(0,H.tZ)(Te.ZP,{selectedIndex:d,setSelectedIndex:c,items:e.widgetData.chart.transactionsList.map((e=>()=>{const r=new k.MY([]);r.addFilterValues("transaction",[e.transaction]);const i=(0,yt.al)({organization:t.organization,location:t.location,initialConditions:r,additionalQuery:{trendFunction:l}});return(0,H.BX)(n.Fragment,{children:[(0,H.tZ)(Te.qL,{to:i,children:(0,H.tZ)(ge.Z,{value:e.transaction,maxLength:40})}),(0,H.tZ)(Te.S$,{children:(0,H.tZ)(Qe.H,{transaction:e})}),!a&&(0,H.tZ)(Te.Nm,{setSelectListIndex:c,onClick:()=>(0,Pe.kP)(e.transaction,t)})]})}))}),height:124,noPadding:!0}]})}Je.displayName="TrendsWidget";const tr=(0,i.withRouter)((0,Xe.Z)(Ue.k));var er=r("./app/views/performance/vitalDetail/utils.tsx"),rr=r("./app/views/performance/vitalDetail/vitalChart.tsx"),nr=r("./app/views/performance/landing/vitalsCards.tsx");function ir(t,e,r){var n;const{start:i,end:o,utc:a,interval:s,statsPeriod:l}=(0,Re.fK)(t.location.query),d=null!==(n=e.results)&&void 0!==n?n:[];return{...e,isLoading:e.loading||e.reloading,isErrored:e.errored,hasData:(0,Rt.ri)(d)&&!!d.length&&!!d[0].data.length,data:d,utc:"true"===a,interval:s,statsPeriod:null!=l?l:void 0,start:null!=i?i:"",end:null!=o?o:""}}function or(t){return{poorCountField:`count_web_vitals(${t}, poor)`,mehCountField:`count_web_vitals(${t}, meh)`,goodCountField:`count_web_vitals(${t}, good)`}}function ar(t){const e=(0,m.Eg)(),{ContainerActions:r,eventView:i,organization:o,location:a}=t,s=o.features.includes("performance-frontend-use-events-endpoint"),[l,d]=(0,n.useState)(0),c=t.fields[0],u=mt(),{fieldsList:h,vitalFields:g,sortField:f}=function(t){const{field:e,fields:r,vitalStops:n}=t,i=null==n?void 0:n.poor,o=null==n?void 0:n.meh;if(!(0,Rt.ri)(i)||!(0,Rt.ri)(o))return{sortField:r[0],fieldsList:r};const a=or(e),s=[a.poorCountField,a.mehCountField,a.goodCountField];return{sortField:a.poorCountField,vitalFields:a,fieldsList:s}}({field:c,fields:t.fields,vitalStops:t.chartDefinition.vitalStops}),v={list:(0,n.useMemo)((()=>({fields:f,component:r=>{const n=r.eventView.clone(),i=h.map((t=>({field:t})));n.sorts=[{kind:"desc",field:f}],n.fields=[{field:"transaction"},{field:"title"},{field:"project.id"},...i];const o=new k.MY(n.query);return n.query=o.formatString(),(0,H.tZ)(jt.Z,{...r,eventView:n,location:t.location,limit:3,cursor:"0:0:1",noPagination:!0,queryExtras:(0,Ft.gM)(e),useEvents:s})},transform:je})),[t.eventView,h,t.organization.slug,e.memoizationKey]),chart:(0,n.useMemo)((()=>({enabled:t=>{var e,r;return!(null==t||null===(e=t.list)||void 0===e||null===(r=e.data)||void 0===r||!r.length)},fields:h,component:r=>{var n;const i=r.eventView.clone();return i.additionalConditions.setFilterValues("transaction",[null===(n=r.widgetData.list.data[l])||void 0===n?void 0:n.transaction]),(0,H.tZ)(dr,{...Wt()(r,Ft.CJ),limit:1,currentSeriesNames:[f],includePrevious:!1,partial:!1,includeTransformedData:!0,query:i.getQueryWithAdditionalConditions(),interval:(0,he.ZS)({start:r.start,end:r.end,period:r.period},"medium"),hideError:!0,onError:u.setPageError,queryExtras:(0,Ft.gM)(e),userModified:(0,fe.ro)(t.location.query.userModified)})},transform:ir})),[t.chartSetting,l,e.memoizationKey,t.location.query.userModified])},y={[Yt.s.WORST_LCP_VITALS]:tt.Zl.LCP,[Yt.s.WORST_FCP_VITALS]:tt.Zl.FCP,[Yt.s.WORST_FID_VITALS]:tt.Zl.FID,[Yt.s.WORST_CLS_VITALS]:tt.Zl.CLS},Z=()=>{};return(0,H.tZ)(le.I,{...t,Subtitle:e=>{var r,n;const i=null===(r=e.widgetData.list)||void 0===r?void 0:r.data[l];if(!i)return(0,H.tZ)(Te.QE,{});const o=y[t.chartSetting],a={[y[t.chartSetting]]:sr(i,o,!s)};return(0,H.tZ)(Te.QE,{children:(0,H.tZ)(nr.JO,{isLoading:null===(n=e.widgetData.list)||void 0===n?void 0:n.isLoading,vital:y[t.chartSetting],data:a,showBar:!1,showDurationDetail:!1,showDetail:!0})})},EmptyComponent:Te.xq,HeaderActions:e=>{const s=y[t.chartSetting],l=(0,er.i4)({orgSlug:o.slug,query:i.generateQueryStringObject(),vitalName:s,projectID:(0,fe.qP)(a.query.project)});return(0,H.BX)(n.Fragment,{children:[(0,H.tZ)("div",{children:(0,H.tZ)(_.ZP,{onClick:Z,to:l,size:"small","data-test-id":"view-all-button",children:(0,p.t)("View All")})}),(0,H.tZ)(r,{...e.widgetData.chart})]})},Queries:v,Visualizations:[{component:t=>(0,H.tZ)(rr.S,{...t.widgetData.chart,...t,field:c,vitalFields:g,grid:t.grid}),height:t.chartHeight},{component:e=>(0,H.tZ)(Te.ZP,{selectedIndex:l,setSelectedIndex:d,items:e.widgetData.list.data.map((r=>()=>{var l;const c=null==r?void 0:r.transaction,u=i.clone(),p=new k.MY(u.query);p.addFilterValues("transaction",[c]);const h=y[t.chartSetting];u.query=p.formatString();const m=(0,er.i4)({orgSlug:o.slug,query:u.generateQueryStringObject(),vitalName:h,projectID:(0,fe.qP)(a.query.project)}),g={[y[t.chartSetting]]:sr(r,h,!s)};return(0,H.BX)(n.Fragment,{children:[(0,H.tZ)(Te.qL,{to:m,children:(0,H.tZ)(ge.Z,{value:c,maxLength:40})}),(0,H.tZ)(lr,{children:(0,H.tZ)(nr.JO,{isLoading:null===(l=e.widgetData.list)||void 0===l?void 0:l.isLoading,vital:y[t.chartSetting],data:g,showBar:!0,showDurationDetail:!1,showDetail:!1,showTooltip:!0,barHeight:20})}),!t.withStaticFilters&&(0,H.tZ)(Te.Nm,{setSelectListIndex:d,onClick:()=>(0,Pe.kP)(r.transaction,t)})]})}))}),height:124,noPadding:!0}]})}function sr(t,e){let r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];const n=or(e),i=t=>r?(0,tt.LY)(t):t,o=t[i(n.poorCountField)]||0,a=t[i(n.mehCountField)]||0,s=t[i(n.goodCountField)]||0,l={poor:o,meh:a,good:s,p75:0},d={...l,total:l.poor+l.meh+l.good};return d}ar.displayName="VitalWidget";const lr=(0,x.Z)(Te.S$,{target:"ejni1p10"})("width:120px;margin-left:",(0,J.Z)(1),";margin-right:",(0,J.Z)(1),";display:flex;align-items:center;justify-content:center;"),dr=(0,ve.Z)(pe.Z),cr=t=>{let{chartSetting:e,setChartSetting:r,allowedCharts:n,rowChartSettings:i}=t;const o=(0,v.Z)(),a=[],s=(0,Yt.W)({organization:o});for(const t of n){const r=s[t];a.push({value:t,label:r.title,disabled:t!==e&&i.includes(t)})}return(0,H.tZ)(Xt.Z,{onChange:t=>r(t.value),options:a,isOptionDisabled:t=>t.disabled,value:e,trigger:function(t){let{props:e,ref:r}=t;return(0,H.tZ)(Ht.Z,{ref:r,...e,size:"xsmall",borderless:!0,showChevron:!1,icon:(0,H.tZ)(Qt.Y,{"aria-label":(0,p.t)("More")})})},placement:"bottom right"})};cr.displayName="WidgetContainerActions";const ur=(0,Ut.Z)((t=>{const{organization:e,index:r,chartHeight:i,allowedCharts:o,rowChartSettings:a,setRowChartSettings:s,...l}=t,d=St();let c=(0,Ft.rp)(r,i,d,l.defaultChartSetting,l.forceDefaultChartSetting);o.includes(c)||(c=l.defaultChartSetting);const[u,p]=(0,n.useState)(c),m=n=>{t.forceDefaultChartSetting||(0,Ft.zM)(r,i,d,n),p(n);const o=[...a];o[r]=n,s(o),function(t,e,r,n){(0,h.Z)("performance_views.landingv3.widget.switch",{organization:n,from_widget:t,to_widget:e,from_default:r})}(u,n,l.defaultChartSetting===u,e)};(0,n.useEffect)((()=>{p(c)}),[l.defaultChartSetting]);const g=(0,Yt.W)({organization:e})[u],f={...g,chartSetting:u,chartDefinition:g,ContainerActions:e=>(0,H.tZ)(cr,{...e,allowedCharts:t.allowedCharts,chartSetting:u,setChartSetting:m,rowChartSettings:a})},v=Wt()(t,["eventView","location","organization","chartHeight","withStaticFilters"]);switch(f.dataType){case $t.A.trends:return(0,H.tZ)(Je,{...v,...f});case $t.A.area:return(0,H.tZ)(ze,{...v,...f});case $t.A.vitals:return(0,H.tZ)(ar,{...v,...f});case $t.A.line_list:return(0,H.tZ)(Me,{...v,...f});case $t.A.histogram:return(0,H.tZ)(ce,{...v,...f});default:throw new Error(`Widget type "${f.dataType}" has no implementation.`)}})),pr=ur,hr=t=>{const{chartCount:e,chartHeight:r,allowedCharts:i}=t,o=(0,kt.a)(),a=St(),s=o.charts.getColorPalette(e),[l,d]=(0,n.useState)(function(t,e,r,n){return new Array(t).fill(0).map(((t,i)=>(0,Ft.rp)(i,e,r,n[i])))}(e,r,a,i));if(t.allowedCharts.length<e)throw new Error("Not enough allowed chart types to show row.");return(0,H.tZ)(fr,{minSize:200,children:new Array(e).fill(0).map(((e,n)=>(0,F.az)(pr,{...t,key:n,index:n,chartHeight:r,chartColor:s[n],defaultChartSetting:i[n],rowChartSettings:l,setRowChartSettings:d})))})};hr.displayName="ChartRow";const mr=t=>(0,H.tZ)(hr,{...t});mr.displayName="TripleChartRow",mr.defaultProps={chartCount:3,chartHeight:100};const gr=t=>(0,H.tZ)(hr,{...t});gr.displayName="DoubleChartRow",gr.defaultProps={chartCount:2,chartHeight:180};const fr=(0,x.Z)(Bt,{target:"e5t9wbo0"})("margin-bottom:",(0,J.Z)(2),";");function vr(t){return(0,H.tZ)(Zt,{value:{performanceType:yt.iy.ANY},children:(0,H.BX)("div",{"data-test-id":"all-transactions-view",children:[(0,H.tZ)(mr,{...t,allowedCharts:[Yt.s.USER_MISERY_AREA,Yt.s.TPM_AREA,Yt.s.FAILURE_RATE_AREA,Yt.s.APDEX_AREA,Yt.s.P50_DURATION_AREA,Yt.s.P75_DURATION_AREA,Yt.s.P95_DURATION_AREA,Yt.s.P99_DURATION_AREA]}),(0,H.tZ)(gr,{...t,allowedCharts:[Yt.s.MOST_RELATED_ISSUES,Yt.s.MOST_IMPROVED,Yt.s.MOST_REGRESSED]}),(0,H.tZ)(zt,{...t,setError:mt().setPageError})]})})}vr.displayName="AllTransactionsView";const yr=["transaction","project","tpm","FCP","LCP","FID","CLS","users","user misery"],Zr=["transaction","project","operation","tpm","p50()","p75()","p95()","users","user misery"],wr=["transaction","project","operation","http method","tpm","p50","p95","failure rate","apdex","users","user misery"],Sr=["transaction","project","operation","tpm","slow frame %","frozen frame %","users","user misery"],xr=["transaction","project","operation","tpm","slow frame %","frozen frame %","stall %","users","user misery"];function br(t){return(0,H.tZ)(Zt,{value:{performanceType:yt.iy.ANY},children:(0,H.BX)("div",{children:[(0,H.tZ)(mr,{...t,allowedCharts:[Yt.s.APDEX_AREA,Yt.s.TPM_AREA,Yt.s.FAILURE_RATE_AREA,Yt.s.USER_MISERY_AREA,Yt.s.P50_DURATION_AREA,Yt.s.P75_DURATION_AREA,Yt.s.P95_DURATION_AREA,Yt.s.P99_DURATION_AREA,Yt.s.DURATION_HISTOGRAM]}),(0,H.tZ)(gr,{...t,allowedCharts:[Yt.s.SLOW_HTTP_OPS,Yt.s.SLOW_DB_OPS,Yt.s.MOST_IMPROVED,Yt.s.MOST_REGRESSED]}),(0,H.tZ)(zt,{...t,columnTitles:wr,setError:mt().setPageError})]})})}function Cr(t){return(0,H.tZ)(Zt,{value:{performanceType:yt.iy.FRONTEND_OTHER},children:(0,H.BX)("div",{children:[(0,H.tZ)(mr,{...t,allowedCharts:[Yt.s.TPM_AREA,Yt.s.DURATION_HISTOGRAM,Yt.s.P50_DURATION_AREA,Yt.s.P75_DURATION_AREA,Yt.s.P95_DURATION_AREA,Yt.s.P99_DURATION_AREA]}),(0,H.tZ)(gr,{...t,allowedCharts:[Yt.s.MOST_RELATED_ISSUES,Yt.s.SLOW_HTTP_OPS,Yt.s.SLOW_RESOURCE_OPS]}),(0,H.tZ)(zt,{...t,columnTitles:Zr,setError:mt().setPageError})]})})}function _r(t){return(0,H.tZ)(Zt,{value:{performanceType:yt.iy.FRONTEND},children:(0,H.BX)("div",{"data-test-id":"frontend-pageload-view",children:[(0,H.tZ)(mr,{...t,allowedCharts:[Yt.s.P75_LCP_AREA,Yt.s.LCP_HISTOGRAM,Yt.s.FCP_HISTOGRAM,Yt.s.USER_MISERY_AREA,Yt.s.TPM_AREA]}),(0,H.tZ)(gr,{...t,allowedCharts:[Yt.s.WORST_LCP_VITALS,Yt.s.WORST_FCP_VITALS,Yt.s.WORST_FID_VITALS,Yt.s.MOST_RELATED_ISSUES,Yt.s.SLOW_HTTP_OPS,Yt.s.SLOW_BROWSER_OPS,Yt.s.SLOW_RESOURCE_OPS]}),(0,H.tZ)(zt,{...t,columnTitles:yr,setError:mt().setPageError})]})})}function Ar(t){const e=(0,Pe.ZR)(t.eventView)?xr:Sr;return(0,H.tZ)(Zt,{value:{performanceType:yt.iy.ANY},children:(0,H.BX)("div",{children:[(0,H.tZ)(mr,{...t,allowedCharts:[Yt.s.TPM_AREA,Yt.s.COLD_STARTUP_AREA,Yt.s.WARM_STARTUP_AREA,Yt.s.SLOW_FRAMES_AREA,Yt.s.FROZEN_FRAMES_AREA]}),(0,H.tZ)(gr,{...t,allowedCharts:[Yt.s.MOST_SLOW_FRAMES,Yt.s.MOST_FROZEN_FRAMES,Yt.s.MOST_IMPROVED,Yt.s.MOST_REGRESSED]}),(0,H.tZ)(zt,{...t,columnTitles:e,setError:mt().setPageError})]})})}br.displayName="BackendView",Cr.displayName="FrontendOtherView",_r.displayName="FrontendPageloadView",Ar.displayName="MobileView";var Er=r("./app/components/forms/controls/radioGroup.tsx");const Pr=t=>{const{Header:e,Body:r,Footer:i,organization:o,eventView:a,isMEPEnabled:s,projects:l}=t,d=l.find((t=>`${a.project[0]}`===t.id)),c=[["true",(0,p.t)("Automatically switch to sampled data when required")],["false",(0,p.t)("Always show sampled data")]],[u,h]=(0,n.useState)(c[s?0:1][0]);return(0,H.BX)(n.Fragment,{children:[(0,H.tZ)(e,{closeButton:!0,children:(0,H.tZ)("h4",{children:(0,p.t)("Sampling Settings")})}),(0,H.BX)(r,{children:[(0,H.tZ)(Tr,{children:(0,p._N)("The visualizations shown are based on your data without any filters or sampling. This does not contribute to your quota usage but transaction details are limited. If you'd like to improve accuracy, we recommend adding more transactions to your quota. or modifying your dataset through [projectSettings: Sampling in settings].",{projectSettings:(0,H.tZ)(Et.Z,{to:`/settings/${o.slug}/projects/${null==d?void 0:d.slug}/filters-and-sampling/`})})}),(0,H.tZ)(Tr,{children:(0,H.tZ)(Er.Z,{style:{flex:1},choices:c,value:u,label:"",onChange:t=>h(t)})})]}),(0,H.tZ)(i,{children:(0,H.BX)(A.ZP,{gap:1,children:[(0,H.tZ)(_.ZP,{priority:"default",onClick:()=>{},"data-test-id":"reset-all",children:(0,p.t)("Read the docs")}),(0,H.tZ)(_.ZP,{"aria-label":(0,p.t)("Apply"),priority:"primary",onClick:e=>{e.preventDefault(),t.closeModal(),t.onApply("true"===u)},"data-test-id":"apply-threshold",children:(0,p.t)("Apply")})]})})]})};Pr.displayName="SamplingModal";const Tr=(0,x.Z)("div",{target:"e1jalyf80"})("margin-bottom:",(0,J.Z)(4),";"),Rr=Pr,jr={name:"9w3zq5",styles:"width:100%;max-width:650px;margin:70px auto"},Or={[Pe.BY.ALL]:vr,[Pe.BY.BACKEND]:br,[Pe.BY.FRONTEND_OTHER]:Cr,[Pe.BY.FRONTEND_PAGELOAD]:_r,[Pe.BY.MOBILE]:Ar};function Dr(t){const{organization:e,location:r,eventView:o,projects:a,handleSearch:s,handleTrendsClick:l,onboardingProject:d,withStaticFilters:c}=t,{teams:u,initiallyLoaded:h}=(0,gt.Z)({provideUserTeams:!0}),m=(0,n.useRef)(!1),g=(0,Pe.Cf)(r),f=(0,Pe.TT)(a,o),v=null!=g?g:f,y=void 0!==d;(0,n.useEffect)((()=>{m.current&&i.browserHistory.replace({pathname:r.pathname,query:{...r.query,landingDisplay:void 0}})}),[o.project.join(".")]),(0,n.useEffect)((()=>{m.current=!0}),[]);const Z=c?"transaction.duration:<15m":(0,yt.Ov)(r,o.query),w=Or[v.field];let S=(0,H.BX)(D.Z,{condensed:!0,children:[(0,H.tZ)(Y.Z,{}),(0,H.tZ)(P.Z,{}),(0,H.tZ)(E.Z,{alignDropdown:"left"})]});y&&(S=(0,H.tZ)(qr,{children:S}));const x=e.features.includes("performance-use-metrics")?Mr:qr;return(0,H.tZ)(Lr,{"data-test-id":"performance-landing-v3",children:(0,H.BX)(pt,{children:[(0,H.BX)(j.h4,{children:[(0,H.tZ)(j.oB,{children:(0,H.tZ)(Fr,{children:(0,p.t)("Performance")})}),(0,H.tZ)(j.kP,{children:!y&&(0,H.BX)(A.ZP,{gap:3,children:[(0,H.tZ)(_.ZP,{priority:"primary","data-test-id":"landing-header-trends",onClick:()=>l(),children:(0,p.t)("View Trends")}),(0,H.tZ)(C.Z,{features:["organizations:performance-use-metrics"],children:(0,H.tZ)(_.ZP,{onClick:()=>{(0,b.openModal)((t=>(0,H.tZ)(Rr,{...t,organization:e,eventView:o,projects:a,onApply:()=>{},isMEPEnabled:!0})),{modalCss:jr,backdrop:"static"})},icon:(0,H.tZ)(G.iC,{}),"aria-label":(0,p.t)("Settings"),"data-test-id":"open-meps-settings"})})]})}),(0,H.tZ)(j.mL,{children:Pe.Lx.map((t=>{let{label:n,field:i}=t;return(0,H.tZ)("li",{className:v.field===i?"active":"",children:(0,H.tZ)("a",{href:"#","data-test-id":`landing-tab-${i}`,onClick:()=>(0,Pe.NJ)(i,r,a,e,o),children:(0,p.t)(n)})},n)}))})]}),(0,H.tZ)(j.uT,{children:(0,H.BX)(j.or,{fullWidth:!0,children:[(0,H.tZ)(R._,{}),(0,H.tZ)(ht,{}),y?(0,H.BX)(n.Fragment,{children:[S,(0,H.tZ)(ft.Z,{organization:e,project:d})]}):(0,H.BX)(n.Fragment,{children:[(0,H.BX)(x,{children:[S,(0,H.tZ)(C.Z,{features:["organizations:performance-transaction-name-only-search"],children:t=>{let{hasFeature:n}=t;return n?(0,H.tZ)(U,{organization:e,location:r,eventView:o}):(0,H.tZ)(T.Z,{searchSource:"performance_landing",organization:e,projectIds:o.project,query:Z,fields:(0,tt.db)(e,[...o.fields,{field:"tps()"}],["epm()","eps()"]),onSearch:s,maxQueryLength:I.dI})}}),(0,H.tZ)(C.Z,{features:["organizations:performance-transaction-name-only-search"],children:t=>{let{hasFeature:e}=t;return e&&(0,H.tZ)(vt.n,{})}})]}),h?(0,H.tZ)($.z,{organization:e,teams:u,selectedTeams:["myteams"],selectedProjects:o.project.map(String),children:(0,H.tZ)(st,{children:(0,H.tZ)(w,{...t})})}):(0,H.tZ)(O.Z,{})]})]})})]})})}Dr.displayName="PerformanceLanding";const Lr=(0,x.Z)(K.JH,{target:"e1ce5rqc3"})({name:"1hcx8jb",styles:"padding:0"}),Fr=(0,x.Z)(L.Z,{target:"e1ce5rqc2"})({name:"ht6xsx",styles:"line-height:40px"}),qr=(0,x.Z)("div",{target:"e1ce5rqc1"})("display:grid;grid-template-rows:auto auto;gap:",(0,J.Z)(2),";margin-bottom:",(0,J.Z)(2),";@media (min-width: ",(t=>t.theme.breakpoints.small),"){grid-template-rows:auto;grid-template-columns:auto 1fr;}"),Mr=(0,x.Z)("div",{target:"e1ce5rqc0"})("display:grid;grid-template-rows:auto auto auto;gap:",(0,J.Z)(2),";margin-bottom:",(0,J.Z)(2),";@media (min-width: ",(t=>t.theme.breakpoints.small),"){grid-template-rows:auto;grid-template-columns:auto 1fr auto;}");function Nr(t){let{selection:e,location:r,demoMode:a}=t;const w=(0,f.Z)(),x=(0,v.Z)(),{projects:b}=(0,Z.Z)(),C=(0,n.useRef)(!1),_=(0,y.Z)(e.datetime),[A,E]=(0,n.useState)({error:void 0}),P=x.features.includes("performance-transaction-name-only-search"),T=(0,S.C)(r,b,{withStaticFilters:P}),R=function(){if(a)return;if(0===b.length)return;if(0===T.project.length||T.project===[u.mP]){const t=b.filter((t=>!1===t.firstTransactionEvent));if(t.length===b.length)return t[0]}const t=b.filter((t=>T.project.includes(parseInt(t.id,10))&&!1===t.firstTransactionEvent));return t.length===T.project.length?t[0]:void 0}();return(0,n.useEffect)((()=>{if(!C.current)return(0,h.Z)("performance_views.overview.view",{organization:x,show_onboarding:void 0!==R}),(0,l.QK)(w,x.slug,e),(0,yt.n4)(e),void(C.current=!0);s()(_,e.datetime)||((0,l.QK)(w,x.slug,e),(0,yt.n4)(e))}),[e.datetime,_,e,w,x,R]),(0,H.tZ)(c.Z,{title:(0,p.t)("Performance"),orgSlug:x.slug,children:(0,H.tZ)(g.bq,{value:{eventView:T},children:(0,H.tZ)(m.kP,{children:(0,H.tZ)(d.Z,{defaultSelection:{datetime:{start:null,end:null,utc:!1,period:S.GY}},hideGlobalHeader:!0,children:(0,H.tZ)(Dr,{eventView:T,setError:function(t){"object"==typeof t||Array.isArray(t)&&"object"==typeof t[0]?o.$e((e=>{e.setExtra("error",t),o.Tb(new Error("setError failed with error type."))})):E({...A,error:t})},handleSearch:function(t){(0,h.Z)("performance_views.overview.search",{organization:x}),i.browserHistory.push({pathname:r.pathname,query:{...r.query,cursor:void 0,query:String(t).trim()||void 0,isDefaultQuery:!1,userModified:!0}})},handleTrendsClick:()=>(0,yt.R8)({location:r,organization:x}),onboardingProject:R,organization:x,location:r,projects:b,selection:e,withStaticFilters:P})})})})})}Nr.displayName="PerformanceContent";const Ir=(0,w.Z)(Nr)},"./app/views/performance/transactionSummary/transactionOverview/metricEvents/metricsEventsDropdown.tsx":(t,e,r)=>{"use strict";r.d(e,{n:()=>d});var n=r("./app/components/acl/feature.tsx"),i=r("./app/components/dropdownControl.tsx"),o=r("./app/locale.tsx"),a=r("./app/utils/performance/contexts/metricsEnhancedSetting.tsx"),s=r("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");const l={[a.nl.unset]:(0,o.t)("Auto"),[a.nl.metrics]:(0,o.t)("Auto (ingested)"),[a.nl.transactions]:(0,o.t)("Auto (stored)")};function d(){return(0,s.tZ)(n.Z,{features:["performance-use-metrics"],children:(0,s.tZ)(c,{})})}function c(){const t=(0,a.Eg)(),e=function(t){const e=l[t.autoSampleState],r=(0,o.t)("Sample");return[{field:a.oR.auto,prefix:r,label:e},{field:a.oR.metricsOnly,prefix:r,label:(0,o.t)("Ingested only")},{field:a.oR.transactionsOnly,prefix:r,label:(0,o.t)("Stored only")}]}(t),r=e.find((e=>{let{field:r}=e;return r===t.metricSettingState}))||e[0];return(0,s.tZ)(i.ZP,{buttonProps:{prefix:r.prefix},label:r.label,children:e.map((e=>(0,s.tZ)(i.hP,{eventKey:e.field,isActive:e.field===r.field,onSelect:e=>t.setMetricSettingState(e),children:e.label},e.field)))})}d.displayName="MetricsEventsDropdown",c.displayName="InnerDropdown"},"./app/views/performance/transactionSummary/transactionThresholdModal.tsx":(t,e,r)=>{"use strict";r.d(e,{ZP:()=>T,fY:()=>P});var n=r("../node_modules/@babel/runtime/helpers/esm/defineProperty.js"),i=r("../node_modules/@emotion/styled/base/dist/emotion-styled-base.browser.esm.js"),o=(r("../node_modules/core-js/modules/web.dom-collections.iterator.js"),r("../node_modules/react/index.js")),a=r("../node_modules/lodash/cloneDeep.js"),s=r.n(a),l=r("../node_modules/lodash/set.js"),d=r.n(l),c=r("./app/actionCreators/indicator.tsx"),u=r("./app/components/button.tsx"),p=r("./app/components/buttonBar.tsx"),h=r("./app/components/forms/controls/input.tsx"),m=r("./app/components/forms/field/index.tsx"),g=r("./app/components/forms/selectControl.tsx"),f=r("./app/components/links/link.tsx"),v=r("./app/locale.tsx"),y=r("./app/styles/space.tsx"),Z=r("./app/utils.tsx"),w=r("./app/utils/withApi.tsx"),S=r("./app/utils/withProjects.tsx"),x=r("./app/views/performance/transactionSummary/utils.tsx"),b=r("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");let C;!function(t){t.TRANSACTION_DURATION="duration",t.LARGEST_CONTENTFUL_PAINT="lcp"}(C||(C={}));const _=[{label:(0,v.t)("Transaction Duration"),value:"duration"},{label:(0,v.t)("Largest Contentful Paint"),value:"lcp"}];class A extends o.Component{constructor(){super(...arguments),(0,n.Z)(this,"state",{threshold:this.props.transactionThreshold,metric:this.props.transactionThresholdMetric,error:null}),(0,n.Z)(this,"handleApply",(t=>{t.preventDefault();const{api:e,closeModal:r,organization:n,transactionName:i,onApply:o}=this.props,a=this.getProject();if(!(0,Z.ri)(a))return;const s=`/organizations/${n.slug}/project-transaction-threshold-override/`;e.requestPromise(s,{method:"POST",includeAllArgs:!0,query:{project:a.id},data:{transaction:i,threshold:this.state.threshold,metric:this.state.metric}}).then((()=>{r(),o&&o(this.state.threshold,this.state.metric)})).catch((t=>{var e,r,n,i;this.setState({error:t});const o=null!==(e=null!==(r=null===(n=t.responseJSON)||void 0===n?void 0:n.threshold)&&void 0!==r?r:null===(i=t.responseJSON)||void 0===i?void 0:i.non_field_errors)&&void 0!==e?e:null;(0,c.Iw)(o)}))})),(0,n.Z)(this,"handleFieldChange",(t=>e=>{this.setState((r=>{const n=s()(r);return d()(n,t,e),{...n,errors:void 0}}))})),(0,n.Z)(this,"handleReset",(t=>{t.preventDefault();const{api:e,closeModal:r,organization:n,transactionName:i,onApply:o}=this.props,a=this.getProject();if(!(0,Z.ri)(a))return;const s=`/organizations/${n.slug}/project-transaction-threshold-override/`;e.requestPromise(s,{method:"DELETE",includeAllArgs:!0,query:{project:a.id},data:{transaction:i}}).then((()=>{const t=`/projects/${n.slug}/${a.slug}/transaction-threshold/configure/`;this.props.api.requestPromise(t,{method:"GET",includeAllArgs:!0,query:{project:a.id}}).then((t=>{let[e]=t;this.setState({threshold:e.threshold,metric:e.metric}),r(),o&&o(this.state.threshold,this.state.metric)})).catch((t=>{var e,r;const n=null!==(e=null===(r=t.responseJSON)||void 0===r?void 0:r.threshold)&&void 0!==e?e:null;(0,c.Iw)(n)}))})).catch((t=>{this.setState({error:t})}))}))}getProject(){const{projects:t,eventView:e,project:r}=this.props;if((0,Z.ri)(r))return t.find((t=>t.id===r));const n=String(e.project[0]);return t.find((t=>t.id===n))}renderModalFields(){return(0,b.BX)(o.Fragment,{children:[(0,b.tZ)(m.Z,{"data-test-id":"response-metric",label:(0,v.t)("Calculation Method"),inline:!1,help:(0,v.t)("This determines which duration metric is used for the Response Time Threshold."),showHelpInTooltip:!0,flexibleControlStateSize:!0,stacked:!0,required:!0,children:(0,b.tZ)(g.Z,{required:!0,options:_.slice(),name:"responseMetric",label:(0,v.t)("Calculation Method"),value:this.state.metric,onChange:t=>{this.handleFieldChange("metric")(t.value)}})}),(0,b.tZ)(m.Z,{"data-test-id":"response-time-threshold",label:(0,v.t)("Response Time Threshold (ms)"),inline:!1,help:(0,v.t)("The satisfactory response time for the calculation method defined above. This is used to calculate Apdex and User Misery scores."),showHelpInTooltip:!0,flexibleControlStateSize:!0,stacked:!0,required:!0,children:(0,b.tZ)(h.Z,{type:"number",name:"threshold",required:!0,pattern:"[0-9]*(\\.[0-9]*)?",onChange:t=>{this.handleFieldChange("threshold")(t.target.value)},value:this.state.threshold,step:100,min:100})})]})}render(){const{Header:t,Body:e,Footer:r,organization:n,transactionName:i,eventView:a}=this.props,s=this.getProject(),l=a.clone();l.query=l.getQueryWithAdditionalConditions();const d=(0,x.e1)({orgSlug:n.slug,transaction:i,query:l.generateQueryStringObject(),projectID:null==s?void 0:s.id});return(0,b.BX)(o.Fragment,{children:[(0,b.tZ)(t,{closeButton:!0,children:(0,b.tZ)("h4",{children:(0,v.t)("Transaction Settings")})}),(0,b.BX)(e,{children:[(0,b.tZ)(E,{children:(0,v._N)("The changes below will only be applied to [transaction]. To set it at a more global level, go to [projectSettings: Project Settings].",{transaction:(0,b.tZ)(f.Z,{to:d,children:i}),projectSettings:(0,b.tZ)(f.Z,{to:`/settings/${n.slug}/projects/${null==s?void 0:s.slug}/performance/`})})}),this.renderModalFields()]}),(0,b.tZ)(r,{children:(0,b.BX)(p.ZP,{gap:1,children:[(0,b.tZ)(u.ZP,{priority:"default",onClick:this.handleReset,"data-test-id":"reset-all",children:(0,v.t)("Reset All")}),(0,b.tZ)(u.ZP,{"aria-label":(0,v.t)("Apply"),priority:"primary",onClick:this.handleApply,"data-test-id":"apply-threshold",children:(0,v.t)("Apply")})]})})]})}}A.displayName="TransactionThresholdModal";const E=(0,i.Z)("div",{target:"ezg6l150"})("margin-bottom:",(0,y.Z)(4),";"),P={name:"9w3zq5",styles:"width:100%;max-width:650px;margin:70px auto"},T=(0,w.Z)((0,S.Z)(A))},"./app/views/performance/vitalDetail/vitalChart.tsx":(t,e,r)=>{"use strict";r.d(e,{S:()=>P,Z:()=>A}),r("../node_modules/core-js/modules/web.dom-collections.iterator.js"),r("../node_modules/core-js/modules/es.string.replace.js");var n=r("../node_modules/react-router/es/index.js"),i=r("../node_modules/@emotion/react/dist/emotion-element-cbed451f.browser.esm.js"),o=r("./app/components/charts/chartZoom.tsx"),a=r("./app/components/charts/errorPanel.tsx"),s=r("./app/components/charts/eventsRequest.tsx"),l=r("./app/components/charts/lineChart.tsx"),d=r("./app/components/charts/releaseSeries.tsx"),c=r("./app/components/charts/styles.tsx"),u=r("./app/components/charts/transitionChart.tsx"),p=r("./app/components/charts/transparentLoadingMask.tsx"),h=r("./app/components/panels/index.tsx"),m=r("./app/components/questionTooltip.tsx"),g=r("./app/icons/index.tsx"),f=r("./app/locale.tsx"),v=r("./app/utils/discover/charts.tsx"),y=r("./app/utils/discover/fields.tsx"),Z=r("./app/utils/getDynamicText.tsx"),w=r("./app/utils/queryString.tsx"),S=r("./app/utils/useApi.tsx"),x=r("./app/views/performance/trends/utils.tsx"),b=r("./app/views/performance/vitalDetail/utils.tsx"),C=r("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");function _(t){let{project:e,environment:r,location:v,organization:y,query:_,statsPeriod:A,router:E,start:P,end:T,interval:R}=t;const j=(0,S.Z)(),O=(0,i.a)(),D=(0,b.iF)(v),L=`p75(${D})`,{utc:F,legend:q,vitalPoor:M,markLines:N,chartOptions:I}=(0,b.EX)({theme:O,location:v,yAxis:L,vital:D});function z(t){const{selected:e}=t,r=Object.keys(e).filter((t=>!e[t])),i={...v,query:{...v.query,unselectedSeries:r}};n.browserHistory.push(i)}return(0,C.tZ)(h.s_,{children:(0,C.BX)(c.BO,{children:[(0,C.BX)(c.ws,{children:[(0,b.Uy)(D),(0,C.tZ)(m.Z,{size:"sm",position:"top",title:(0,f.t)("The durations shown should fall under the vital threshold.")})]}),(0,C.tZ)(o.Z,{router:E,period:A,start:P,end:T,utc:F,children:t=>(0,C.tZ)(s.Z,{api:j,organization:y,period:A,project:e,environment:r,start:P,end:T,interval:R,showLoading:!1,query:_,includePrevious:!1,yAxis:[L],partial:!0,userModified:(0,w.ro)(v.query.userModified),children:n=>{let{timeseriesData:i,errored:o,loading:s,reloading:c}=n;if(o)return(0,C.tZ)(a.Z,{children:(0,C.tZ)(g.FC,{color:"gray500",size:"lg"})});const h=i&&O.charts.getColorPalette(i.length-2)||[],{smoothedResults:m}=(0,x.vq)(i),f=m?m.map(((t,e)=>{let{seriesName:r,...n}=t;return{seriesName:(0,x.HF)(r)||"p75",...n,color:h[e],lineStyle:{opacity:1,width:2}}})):[],v=(0,b.vk)(f),y=Math.max(v,M);return I.yAxis.max=1.1*y,(0,C.tZ)(d.Z,{start:P,end:T,period:A,utc:F,projects:e,environments:r,children:e=>{let{releaseSeries:r}=e;return(0,C.BX)(u.Z,{loading:s,reloading:c,children:[(0,C.tZ)(p.Z,{visible:c}),(0,Z.Z)({value:(0,C.tZ)(l.w,{...t,...I,legend:q,onLegendSelectChanged:z,series:[...N,...r,...f]}),fixed:"Web Vitals Chart"})]})}})}})})]})})}_.displayName="VitalChart";const A=(0,n.withRouter)(_);function E(t,e){return t===(null==e?void 0:e.poorCountField.replace("equation|",""))?b.SP.POOR:t===(null==e?void 0:e.mehCountField.replace("equation|",""))?b.SP.MEH:t===(null==e?void 0:e.goodCountField.replace("equation|",""))?b.SP.GOOD:void 0}function P(t){const{field:e,data:r,loading:n,reloading:o,height:a,grid:s,utc:d,vitalFields:c}=t,h=(0,i.a)();if(!r||!c)return null;const m={grid:s,seriesOptions:{showSymbol:!1},tooltip:{trigger:"axis",valueFormatter:(t,r)=>(0,v.CX)(t,c[0]===y.Zl.CLS?r:e)},xAxis:{show:!1},xAxes:void 0,yAxis:{axisLabel:{color:h.chartLabel,showMaxLabel:!1,formatter:t=>(0,v.gu)(t,e)}},utc:d,isGroupedByDate:!0,showTimeInTooltip:!0},g=r.filter((t=>!!E(t.seriesName,c))),f=null!=g&&g.length?g.map((t=>{let{seriesName:e,...r}=t;const n=E(e,c)||"count";return{seriesName:n,...r,color:h[b.fL[n]],lineStyle:{opacity:1,width:2}}})):[];return(0,C.tZ)("div",{children:(0,C.BX)(u.Z,{loading:n,reloading:o,children:[(0,C.tZ)(p.Z,{visible:o}),(0,Z.Z)({value:(0,C.tZ)(l.w,{height:a,...m,onLegendSelectChanged:()=>{},series:[...f],isGroupedByDate:!0}),fixed:"Web Vitals Chart"})]})})}P.displayName="_VitalChart"},"../node_modules/lodash/_baseLt.js":t=>{t.exports=function(t,e){return t<e}},"../node_modules/lodash/min.js":(t,e,r)=>{var n=r("../node_modules/lodash/_baseExtremum.js"),i=r("../node_modules/lodash/_baseLt.js"),o=r("../node_modules/lodash/identity.js");t.exports=function(t){return t&&t.length?n(t,o,i):void 0}}}]);
//# sourceMappingURL=../sourcemaps/app_views_performance_content_tsx.5a1a10805cd8fbfc0ce3b365b429b14c.js.map