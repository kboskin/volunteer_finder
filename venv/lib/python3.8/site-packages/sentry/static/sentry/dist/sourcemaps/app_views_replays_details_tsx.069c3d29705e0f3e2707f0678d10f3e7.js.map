{"version":3,"file":"chunks/app_views_replays_details_tsx.xxxxxxxxxxxxxxxxxxxx.js","mappings":"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","sources":["webpack:///./app/components/charts/areaChart.tsx","webpack:///./app/components/charts/series/areaSeries.tsx","webpack:///./app/components/featureFeedback/index.tsx","webpack:///./app/components/keyValueTable.tsx","webpack:///./app/components/tagsTable.tsx","webpack:///./app/utils/getUrlPathname.tsx","webpack:///./app/utils/replays/hooks/useDiscoveryQuery.tsx","webpack:///./app/utils/useLocation.tsx","webpack:///./app/utils/usePrevious.tsx","webpack:///./app/components/replays/breadcrumbs/timeline.tsx","webpack:///./app/components/replays/utils.tsx","webpack:///./app/components/replays/breadcrumbs/gridlines.tsx","webpack:///./app/components/replays/breadcrumbs/replayTimelineEvents.tsx","webpack:///./app/components/replays/breadcrumbs/replayTimelineSpans.tsx","webpack:///./app/components/replays/breadcrumbs/stacked.tsx","webpack:///./app/utils/replays/highlightNode.tsx","webpack:///./app/components/replays/highlightReplayPlugin.tsx","webpack:///./app/components/replays/replayContext.tsx","webpack:///./app/utils/replays/hooks/useRAF.tsx","webpack:///./app/components/replays/player/horizontalMouseTracking.tsx","webpack:///./app/components/replays/progress.tsx","webpack:///./app/components/replays/player/scrubber.tsx","webpack:///./app/components/replays/resizeable.tsx","webpack:///./app/components/replays/timelinePosition.tsx","webpack:///./app/components/replays/breadcrumbs/replayTimeline.tsx","webpack:///./app/utils/replays/getBreadcrumb.tsx","webpack:///./app/utils/replays/hooks/useFullscreen.tsx","webpack:///./app/components/replays/replayController.tsx","webpack:///./app/utils/replays/getCurrentUrl.tsx","webpack:///./app/components/replays/replayCurrentUrl.tsx","webpack:///./app/components/replays/player/bufferingOverlay.tsx","webpack:///./app/components/replays/player/fastForwardBadge.tsx","webpack:///./app/components/replays/replayPlayer.tsx","webpack:///./app/components/replays/replayView.tsx","webpack:///./app/utils/replays/replayReader.tsx","webpack:///./app/utils/replays/replayDataUtils.tsx","webpack:///./app/utils/replays/hooks/useReplayData.tsx","webpack:///./app/components/replays/keyMetrics.tsx","webpack:///./app/views/replays/detail/detailLayout.tsx","webpack:///./app/utils/replays/createUrlToShare.tsx","webpack:///./app/views/replays/types.tsx","webpack:///./app/utils/replays/hooks/useActiveTabFromLocation.tsx","webpack:///./app/views/replays/detail/console/consoleMessage.tsx","webpack:///./app/views/replays/detail/console/index.tsx","webpack:///./app/views/replays/detail/console/utils.tsx","webpack:///./app/views/replays/detail/issueList.tsx","webpack:///./app/views/replays/detail/memoryChart.tsx","webpack:///./app/views/replays/detail/trace.tsx","webpack:///./app/views/replays/detail/focusArea.tsx","webpack:///./app/views/replays/detail/focusTabs.tsx","webpack:///./app/components/replays/actionCategory.tsx","webpack:///./app/components/replays/playerRelativeTime.tsx","webpack:///./app/views/replays/detail/userActionsNavigator.tsx","webpack:///./app/views/replays/details.tsx","webpack:///./app/utils/replays/flattenListOfObjects.tsx","webpack:///./app/utils/replays/hooks/useReplayErrors.tsx"],"sourcesContent":["import type {LineSeriesOption} from 'echarts';\n\nimport {Series} from 'sentry/types/echarts';\n\nimport AreaSeries from './series/areaSeries';\nimport BaseChart from './baseChart';\n\ntype ChartProps = Omit<React.ComponentProps<typeof BaseChart>, 'css'>;\n\nexport type AreaChartSeries = Series & Omit<LineSeriesOption, 'data' | 'name'>;\n\nexport interface AreaChartProps extends Omit<ChartProps, 'series'> {\n  series: AreaChartSeries[];\n  stacked?: boolean;\n}\n\nexport function AreaChart({series, stacked, colors, ...props}: AreaChartProps) {\n  return (\n    <BaseChart\n      {...props}\n      data-test-id=\"area-chart\"\n      colors={colors}\n      series={series.map(({seriesName, data, ...otherSeriesProps}, i) =>\n        AreaSeries({\n          stack: stacked ? 'area' : undefined,\n          name: seriesName,\n          data: data.map(({name, value}) => [name, value]),\n          lineStyle: {\n            color: colors?.[i],\n            opacity: 1,\n            width: 0.4,\n          },\n          areaStyle: {\n            color: colors?.[i],\n            opacity: 1.0,\n          },\n          animation: false,\n          animationThreshold: 1,\n          animationDuration: 0,\n          ...otherSeriesProps,\n        })\n      )}\n    />\n  );\n}\n","import type {LineSeriesOption} from 'echarts';\n\nimport LineSeries from 'sentry/components/charts/series/lineSeries';\n\nexport default function AreaSeries(props: LineSeriesOption = {}): LineSeriesOption {\n  return LineSeries({\n    ...props,\n  });\n}\n","import {openModal} from 'sentry/actionCreators/modal';\nimport Button, {ButtonProps} from 'sentry/components/button';\nimport {IconMegaphone} from 'sentry/icons';\nimport {t} from 'sentry/locale';\n\nimport {FeedBackModalProps} from './feedbackModal';\n\nexport interface FeatureFeedbackProps extends FeedBackModalProps {\n  buttonProps?: Partial<ButtonProps>;\n}\n\n// Provides a button that, when clicked, opens a modal with a form that,\n// when filled and submitted, will send feedback to Sentry (feedbacks project).\nexport function FeatureFeedback({\n  feedbackTypes,\n  featureName,\n  buttonProps = {},\n}: FeatureFeedbackProps) {\n  async function handleClick() {\n    const mod = await import('sentry/components/featureFeedback/feedbackModal');\n\n    const {FeedbackModal, modalCss} = mod;\n\n    openModal(\n      deps => (\n        <FeedbackModal\n          {...deps}\n          featureName={featureName}\n          feedbackTypes={feedbackTypes}\n        />\n      ),\n      {\n        modalCss,\n      }\n    );\n  }\n\n  return (\n    <Button icon={<IconMegaphone />} onClick={handleClick} {...buttonProps}>\n      {t('Give Feedback')}\n    </Button>\n  );\n}\n","import {Fragment} from 'react';\nimport styled from '@emotion/styled';\n\nimport space from 'sentry/styles/space';\nimport {Theme} from 'sentry/utils/theme';\n\ntype Props = {\n  keyName: React.ReactNode;\n  value: React.ReactNode;\n};\n\nexport const KeyValueTable = styled('dl')`\n  display: grid;\n  grid-template-columns: 50% 50%;\n`;\n\nexport const KeyValueTableRow = ({keyName, value}: Props) => {\n  return (\n    <Fragment>\n      <Key>{keyName}</Key>\n      <Value>{value}</Value>\n    </Fragment>\n  );\n};\n\nconst commonStyles = ({theme}: {theme: Theme}) => `\nfont-size: ${theme.fontSizeMedium};\npadding: ${space(0.5)} ${space(1)};\nfont-weight: normal;\nline-height: inherit;\n${p => p.theme.overflowEllipsis};\n&:nth-of-type(2n-1) {\n  background-color: ${theme.backgroundSecondary};\n}\n`;\n\nconst Key = styled('dt')`\n  ${commonStyles};\n  color: ${p => p.theme.textColor};\n`;\n\nconst Value = styled('dd')`\n  ${commonStyles};\n  color: ${p => p.theme.subText};\n  text-align: right;\n`;\n","import styled from '@emotion/styled';\nimport {LocationDescriptor} from 'history';\nimport capitalize from 'lodash/capitalize';\n\nimport {SectionHeading} from 'sentry/components/charts/styles';\nimport {getMeta, withMeta} from 'sentry/components/events/meta/metaProxy';\nimport {KeyValueTable, KeyValueTableRow} from 'sentry/components/keyValueTable';\nimport Link from 'sentry/components/links/link';\nimport Tooltip from 'sentry/components/tooltip';\nimport Version from 'sentry/components/version';\nimport {t} from 'sentry/locale';\nimport space from 'sentry/styles/space';\nimport {MetaError} from 'sentry/types';\nimport {Event, EventTag} from 'sentry/types/event';\n\ntype Props = {\n  event: Event;\n  generateUrl: (tag: EventTag) => LocationDescriptor;\n  query: string;\n  title?: React.ReactNode;\n};\n\nconst TagsTable = ({event, query, generateUrl, title = t('Tag Details')}: Props) => {\n  const eventWithMeta = withMeta(event) as Event;\n  const tags = eventWithMeta.tags;\n\n  const formatErrorKind = (kind: string) => {\n    return capitalize(kind.replace(/_/g, ' '));\n  };\n\n  const getErrorMessage = (error: MetaError) => {\n    if (Array.isArray(error)) {\n      if (error[1]?.reason) {\n        return formatErrorKind(error[1].reason);\n      }\n      return formatErrorKind(error[0]);\n    }\n    return formatErrorKind(error);\n  };\n\n  const getTooltipTitle = (errors: Array<MetaError>) => {\n    return <TooltipTitle>{getErrorMessage(errors[0])}</TooltipTitle>;\n  };\n\n  return (\n    <StyledTagsTable>\n      <SectionHeading>{title}</SectionHeading>\n      <KeyValueTable>\n        {tags.map(tag => {\n          const tagInQuery = query.includes(`${tag.key}:`);\n          const target = tagInQuery ? undefined : generateUrl(tag);\n          const keyMetaData = getMeta(tag, 'key');\n          const valueMetaData = getMeta(tag, 'value');\n\n          const renderTagValue = () => {\n            switch (tag.key) {\n              case 'release':\n                return <Version version={tag.value} anchor={false} withPackage />;\n              default:\n                return tag.value;\n            }\n          };\n          return (\n            <KeyValueTableRow\n              key={tag.key}\n              keyName={\n                keyMetaData?.err?.length ? (\n                  <Tooltip title={getTooltipTitle(keyMetaData.err)}>\n                    <i>{`<${t('invalid')}>`}</i>\n                  </Tooltip>\n                ) : (\n                  <StyledTooltip title={tag.key}>{tag.key}</StyledTooltip>\n                )\n              }\n              value={\n                valueMetaData?.err?.length ? (\n                  <Tooltip title={getTooltipTitle(valueMetaData.err)}>\n                    <i>{`<${t('invalid')}>`}</i>\n                  </Tooltip>\n                ) : keyMetaData?.err?.length ? (\n                  <span>{renderTagValue()}</span>\n                ) : tagInQuery ? (\n                  <Tooltip title={t('This tag is in the current filter conditions')}>\n                    <span>{renderTagValue()}</span>\n                  </Tooltip>\n                ) : (\n                  <StyledTooltip title={renderTagValue()}>\n                    <Link to={target || ''}>{renderTagValue()}</Link>\n                  </StyledTooltip>\n                )\n              }\n            />\n          );\n        })}\n      </KeyValueTable>\n    </StyledTagsTable>\n  );\n};\n\nexport default TagsTable;\n\nconst StyledTooltip = styled(Tooltip)`\n  ${p => p.theme.overflowEllipsis};\n`;\n\nconst StyledTagsTable = styled('div')`\n  margin-bottom: ${space(3)};\n`;\n\nconst TooltipTitle = styled('div')`\n  text-align: left;\n`;\n","export default function getUrlPathname(url: string) {\n  try {\n    return new URL(url).pathname;\n  } catch {\n    return undefined;\n  }\n}\n","import {useEffect, useState} from 'react';\nimport {Location} from 'history';\n\nimport {NewQuery} from 'sentry/types';\nimport EventView from 'sentry/utils/discover/eventView';\nimport useApi from 'sentry/utils/useApi';\nimport useOrganization from 'sentry/utils/useOrganization';\n\ntype OptionalProperties = 'projects' | 'environment' | 'id' | 'name' | 'version';\ninterface Params {\n  /**\n   * The Discover query to perform. This is a function because we will require the consumer of the hook to memoize this function.\n   */\n  discoverQuery: Omit<NewQuery, OptionalProperties> &\n    Partial<Pick<NewQuery, OptionalProperties>>;\n\n  endpoint?: string;\n\n  /**\n   * Should we ignore the current URL parameter `cursor`?\n   *\n   * This is useful when we are making nested discover queries and the child queries have their own cursor (or do not need it at all).\n   */\n  ignoreCursor?: boolean;\n}\n\ninterface State<T> {\n  data: T[] | undefined;\n  error: Error | undefined;\n  isLoading: boolean;\n  pageLinks: string | undefined;\n}\n\nconst INITIAL_STATE: State<any> = {\n  isLoading: true,\n  error: undefined,\n  data: undefined,\n  pageLinks: undefined,\n} as const;\n\nconst FAKE_LOCATION = {\n  query: {},\n} as Location;\n\n/**\n * Simple custom hook to perform a Discover query.\n *\n * Note this does *not* handle URL parameters like the render component `<DiscoverQuery>`.\n * It will need to be handled in a parent.\n */\nexport default function useDiscoverQuery<T = unknown>({\n  endpoint,\n  discoverQuery,\n  ignoreCursor,\n}: Params) {\n  const [state, setState] = useState<State<T>>(INITIAL_STATE);\n  const api = useApi();\n  const organization = useOrganization();\n\n  useEffect(() => {\n    async function runQuery() {\n      const url = endpoint || `/organizations/${organization.slug}/eventsv2/`;\n      const eventView = EventView.fromNewQueryWithLocation(\n        {\n          environment: [],\n          projects: [],\n          id: '',\n          name: '',\n          version: 2,\n          ...discoverQuery,\n        },\n        FAKE_LOCATION\n      );\n      const query = eventView.getEventsAPIPayload(FAKE_LOCATION);\n\n      setState(prevState => ({...prevState, isLoading: true, error: undefined}));\n      api.clear();\n\n      try {\n        const [data, , resp] = await api.requestPromise(url, {\n          includeAllArgs: true,\n          query,\n        });\n        setState(prevState => ({\n          ...prevState,\n          isLoading: false,\n          error: undefined,\n          pageLinks: resp?.getResponseHeader('Link') ?? prevState.pageLinks,\n          data: data.data,\n        }));\n      } catch (error) {\n        setState(prevState => ({\n          ...prevState,\n          isLoading: false,\n          error,\n          data: undefined,\n        }));\n      }\n    }\n\n    runQuery();\n\n    // location is ignored in deps array, see getEventView comments\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [endpoint, discoverQuery, organization.slug, ignoreCursor]);\n\n  return state;\n}\n","import {Location, Query} from 'history';\n\nimport {useRouteContext} from 'sentry/utils/useRouteContext';\n\ntype DefaultQuery<T = string> = {\n  [key: string]: T | T[] | null | undefined;\n};\n\nexport function useLocation<Q extends Query = DefaultQuery>(): Location<Q> {\n  const route = useRouteContext();\n  return route.location;\n}\n","import {useEffect, useRef} from 'react';\n\n/**\n * Provides previous prop or state inside of function components.\n * Its possible that in the future React will provide a usePrevious Hook out of the box since its a relatively common use case.\n * @see {@link https://reactjs.org/docs/hooks-faq.html#how-to-get-the-previous-props-or-state}\n *\n * @returns 'ref.current' and therefore should not be used as a dependency of useEffect.\n * Mutable values like 'ref.current' are not valid dependencies of useEffect because changing them does not re-render the component.\n */\nfunction usePrevious<T>(value: T): T {\n  // The ref object is a generic container whose current property is mutable ...\n  // ... and can hold any value, similar to an instance property on a class\n  const ref = useRef<T>(value);\n  // Store current value in ref\n  useEffect(() => {\n    ref.current = value;\n  }, [value]); // Only re-run if value changes\n  // Return previous value (happens before update in useEffect above)\n  return ref.current;\n}\n\nexport default usePrevious;\n","import styled from '@emotion/styled';\n\n/**\n * Use grid to create columns that we can place child nodes into.\n * Leveraging grid for alignment means we don't need to calculate percent offset\n * nor use position:absolute to lay out items.\n *\n * <Columns>\n *   <Col>...</Col>\n *   <Col>...</Col>\n * </Columns>\n */\nexport const Columns = styled('ul')<{remainder: number; totalColumns: number}>`\n  /* Reset defaults for <ul> */\n  list-style: none;\n  margin: 0;\n  padding: 0;\n\n  height: 100%;\n  width: 100%;\n\n  /* Layout of the lines */\n  display: grid;\n  grid-template-columns: repeat(${p => p.totalColumns}, 1fr) ${p => p.remainder}fr;\n  place-items: stretch;\n`;\n\n// Export an empty component which so that callsites can correctly nest nodes:\nexport const Col = styled('li')``;\n","import moment from 'moment';\n\nimport {Crumb} from 'sentry/types/breadcrumbs';\nimport type {ReplaySpan} from 'sentry/views/replays/types';\n\nfunction padZero(num: number, len = 2): string {\n  let str = String(num);\n  const threshold = Math.pow(10, len - 1);\n  if (num < threshold) {\n    while (String(threshold).length > str.length) {\n      str = '0' + num;\n    }\n  }\n  return str;\n}\n\nconst SECOND = 1000;\nconst MINUTE = 60 * SECOND;\nconst HOUR = 60 * MINUTE;\nconst TIME_FORMAT = 'HH:mm:ss';\n\n/**\n * @param timestamp The timestamp that is our reference point. Can be anything that `moment` accepts such as `'2022-05-04T19:47:52.915000Z'` or `1651664872.915`\n * @param diffMs Number of milliseconds to adjust the timestamp by, either positive (future) or negative (past)\n * @returns Unix timestamp of the adjusted timestamp, in milliseconds\n */\nexport function relativeTimeInMs(timestamp: moment.MomentInput, diffMs: number): number {\n  return moment(timestamp).diff(moment.unix(diffMs)).valueOf();\n}\n\nexport function showPlayerTime(timestamp: string, relativeTime: number): string {\n  return moment.utc(relativeTimeInMs(timestamp, relativeTime)).format(TIME_FORMAT);\n}\n\n// TODO: move into 'sentry/utils/formatters'\nexport function formatTime(ms: number): string {\n  if (ms <= 0) {\n    return '0:00';\n  }\n  const hour = Math.floor(ms / HOUR);\n  ms = ms % HOUR;\n  const minute = Math.floor(ms / MINUTE);\n  ms = ms % MINUTE;\n  const second = Math.floor(ms / SECOND);\n  if (hour) {\n    return `${hour}:${padZero(minute)}:${padZero(second)}`;\n  }\n  return `${minute}:${padZero(second)}`;\n}\n\n/**\n * Figure out how many ticks to show in an area.\n * If there is more space available, we can show more granular ticks, but if\n * less space is available, fewer ticks.\n * Similarly if the duration is short, the ticks will represent a short amount\n * of time (like every second) but if the duration is long one tick may\n * represent an hour.\n *\n * @param duration The amount of time that we need to chop up into even sections\n * @param width Total width available, pixels\n * @param minWidth Minimum space for each column, pixels. Ex: So we can show formatted time like `1:00:00` between major ticks\n * @returns\n */\nexport function countColumns(duration: number, width: number, minWidth: number = 50) {\n  let maxCols = Math.floor(width / minWidth);\n  const remainder = duration - maxCols * width > 0 ? 1 : 0;\n  maxCols -= remainder;\n\n  // List of all the possible time granularities to display\n  // We could generate the list, which is basically a version of fizzbuzz, hard-coding is quicker.\n  const timeOptions = [\n    1 * HOUR,\n    30 * MINUTE,\n    20 * MINUTE,\n    15 * MINUTE,\n    10 * MINUTE,\n    5 * MINUTE,\n    2 * MINUTE,\n    1 * MINUTE,\n    30 * SECOND,\n    10 * SECOND,\n    5 * SECOND,\n    1 * SECOND,\n  ];\n\n  const timeBasedCols = timeOptions.reduce<Map<number, number>>((map, time) => {\n    map.set(time, Math.floor(duration / time));\n    return map;\n  }, new Map());\n\n  const [timespan, cols] = Array.from(timeBasedCols.entries())\n    .filter(([_span, c]) => c <= maxCols) // Filter for any valid timespan option where all ticks would fit\n    .reduce((best, next) => (next[1] > best[1] ? next : best), [0, 0]); // select the timespan option with the most ticks\n\n  const remaining = (duration - timespan * cols) / timespan;\n  return {timespan, cols, remaining};\n}\n\n/**\n * Group Crumbs for display along the timeline.\n *\n * The timeline is broken down into columns (aka buckets, or time-slices).\n * Columns translate to a fixed width on the screen, to prevent side-scrolling.\n *\n * This function groups crumbs into columns based on the number of columns available\n * and the timestamp of the crumb.\n */\nexport function getCrumbsByColumn(\n  startTimestamp: number,\n  duration: number,\n  crumbs: Crumb[],\n  totalColumns: number\n) {\n  const startMilliSeconds = startTimestamp * 1000;\n  const safeDuration = isNaN(duration) ? 1 : duration;\n\n  const columnCrumbPairs = crumbs.map(breadcrumb => {\n    const {timestamp} = breadcrumb;\n    const timestampMilliSeconds = +new Date(String(timestamp));\n    const sinceStart = isNaN(timestampMilliSeconds)\n      ? 0\n      : timestampMilliSeconds - startMilliSeconds;\n    const column = Math.floor((sinceStart / safeDuration) * (totalColumns - 1)) + 1;\n\n    return [column, breadcrumb] as [number, Crumb];\n  });\n\n  const crumbsByColumn = columnCrumbPairs.reduce((map, [column, breadcrumb]) => {\n    if (map.has(column)) {\n      map.get(column)?.push(breadcrumb);\n    } else {\n      map.set(column, [breadcrumb]);\n    }\n    return map;\n  }, new Map() as Map<number, Crumb[]>);\n\n  return crumbsByColumn;\n}\n\ntype FlattenedSpanRange = {\n  /**\n   * Duration of this range\n   */\n  duration: number;\n  /**\n   * Absolute time in ms when the range ends\n   */\n  endTimestamp: number;\n  /**\n   * Number of spans that got flattened into this range\n   */\n  spanCount: number;\n  /**\n   * ID of the original span that created this range\n   */\n  spanId: string;\n  //\n  /**\n   * Absolute time in ms when the span starts\n   */\n  startTimestamp: number;\n};\n\nfunction doesOverlap(a: FlattenedSpanRange, b: FlattenedSpanRange) {\n  const bStartsWithinA =\n    a.startTimestamp <= b.startTimestamp && b.startTimestamp <= a.endTimestamp;\n  const bEndsWithinA =\n    a.startTimestamp <= b.endTimestamp && b.endTimestamp <= a.endTimestamp;\n  return bStartsWithinA || bEndsWithinA;\n}\n\nexport function flattenSpans(rawSpans: ReplaySpan[]): FlattenedSpanRange[] {\n  if (!rawSpans.length) {\n    return [];\n  }\n\n  const spans = rawSpans.map(span => {\n    const startTimestamp = span.startTimestamp * 1000;\n\n    // `endTimestamp` is at least msPerPixel wide, otherwise it disappears\n    const endTimestamp = span.endTimestamp * 1000;\n    return {\n      spanCount: 1,\n      // spanId: span.span_id,\n      startTimestamp,\n      endTimestamp,\n      duration: endTimestamp - startTimestamp,\n    } as FlattenedSpanRange;\n  });\n\n  const [firstSpan, ...restSpans] = spans;\n  const flatSpans = [firstSpan];\n\n  for (const span of restSpans) {\n    let overlap = false;\n    for (const fspan of flatSpans) {\n      if (doesOverlap(fspan, span)) {\n        overlap = true;\n        fspan.spanCount += 1;\n        fspan.startTimestamp = Math.min(fspan.startTimestamp, span.startTimestamp);\n        fspan.endTimestamp = Math.max(fspan.endTimestamp, span.endTimestamp);\n        fspan.duration = fspan.endTimestamp - fspan.startTimestamp;\n        break;\n      }\n    }\n    if (!overlap) {\n      flatSpans.push(span);\n    }\n  }\n  return flatSpans;\n}\n\n/**\n * Divide two numbers safely\n */\nexport function divide(numerator: number, denominator: number | undefined) {\n  if (denominator === undefined || isNaN(denominator) || denominator === 0) {\n    return 0;\n  }\n  return numerator / denominator;\n}\n","import React from 'react';\nimport styled from '@emotion/styled';\n\nimport * as Timeline from 'sentry/components/replays/breadcrumbs/timeline';\n\nimport {countColumns, formatTime} from '../utils';\n\ntype LineStyle = 'dotted' | 'solid' | 'none';\n\nconst Line = styled(Timeline.Col)<{lineStyle: LineStyle}>`\n  border-right: 1px ${p => p.lineStyle} ${p => p.theme.gray100};\n  text-align: right;\n`;\n\nfunction Gridlines({\n  children,\n  cols,\n  lineStyle,\n  remaining,\n}: {\n  cols: number;\n  lineStyle: LineStyle;\n  remaining: number;\n  children?: (i: number) => React.ReactNode;\n}) {\n  return (\n    <Timeline.Columns totalColumns={cols} remainder={remaining}>\n      {[...Array(cols)].map((_, i) => (\n        <Line key={i} lineStyle={lineStyle}>\n          {children ? children(i) : null}\n        </Line>\n      ))}\n    </Timeline.Columns>\n  );\n}\n\ntype Props = {\n  duration: number;\n  width: number;\n  minWidth?: number;\n};\n\nexport function MajorGridlines({duration, minWidth = 50, width}: Props) {\n  const {timespan, cols, remaining} = countColumns(duration, width, minWidth);\n\n  return (\n    <Gridlines cols={cols} lineStyle=\"solid\" remaining={remaining}>\n      {i => <small>{formatTime((i + 1) * timespan)}</small>}\n    </Gridlines>\n  );\n}\n\nexport function MinorGridlines({duration, minWidth = 20, width}: Props) {\n  const {cols, remaining} = countColumns(duration, width, minWidth);\n\n  return <Gridlines cols={cols} lineStyle=\"dotted\" remaining={remaining} />;\n}\n","import styled from '@emotion/styled';\n\nimport Type from 'sentry/components/events/interfaces/breadcrumbs/breadcrumb/type';\nimport Icon from 'sentry/components/events/interfaces/breadcrumbs/breadcrumb/type/icon';\nimport {Hovercard} from 'sentry/components/hovercard';\nimport * as Timeline from 'sentry/components/replays/breadcrumbs/timeline';\nimport space from 'sentry/styles/space';\nimport {BreadcrumbType, Crumb} from 'sentry/types/breadcrumbs';\nimport type {Color} from 'sentry/utils/theme';\n\nimport {getCrumbsByColumn} from '../utils';\n\nconst EVENT_STICK_MARKER_WIDTH = 4;\n\ntype Props = {\n  crumbs: Crumb[];\n  duration: number;\n  startTimestamp: number;\n  width: number;\n  className?: string;\n};\n\nfunction ReplayTimelineEvents({\n  className,\n  crumbs,\n  duration,\n  startTimestamp,\n  width,\n}: Props) {\n  const totalColumns = Math.floor(width / EVENT_STICK_MARKER_WIDTH);\n  const eventsByCol = getCrumbsByColumn(startTimestamp, duration, crumbs, totalColumns);\n\n  return (\n    <EventColumns className={className} totalColumns={totalColumns} remainder={0}>\n      {Array.from(eventsByCol.entries()).map(([column, breadcrumbs]) => (\n        <EventColumn key={column} column={column}>\n          <Event crumbs={breadcrumbs} />\n        </EventColumn>\n      ))}\n    </EventColumns>\n  );\n}\n\nconst EventColumns = styled(Timeline.Columns)`\n  height: ${space(4)};\n  margin-top: ${space(1)};\n`;\n\nconst EventColumn = styled(Timeline.Col)<{column: number}>`\n  grid-column: ${p => Math.floor(p.column)};\n  place-items: stretch;\n  display: grid;\n\n  &:hover {\n    z-index: ${p => p.theme.zIndex.initial};\n  }\n`;\n\nfunction getCrumbDetail(crumb: Crumb) {\n  switch (crumb.type) {\n    case BreadcrumbType.USER:\n    case BreadcrumbType.UI:\n      return crumb.message ?? crumb.description;\n    case BreadcrumbType.NAVIGATION:\n      return crumb.data?.to ?? crumb.description;\n    case BreadcrumbType.ERROR:\n      return `${crumb.data?.type}: ${crumb.data?.value}`;\n    default:\n      return crumb.message;\n  }\n}\n\nfunction sortByMostInterestingType(a: Crumb, b: Crumb) {\n  const rank = {\n    [BreadcrumbType.USER]: 0,\n    [BreadcrumbType.UI]: 0,\n    [BreadcrumbType.NAVIGATION]: 1,\n    [BreadcrumbType.ERROR]: 2,\n  };\n\n  return rank[a.type] - rank[b.type];\n}\n\nfunction Event({crumbs}: {crumbs: Crumb[]; className?: string}) {\n  const title = (\n    <HoverList>\n      {crumbs.map(crumb => (\n        <HoverListItem key={crumb.id}>\n          <Type type={crumb.type} color={crumb.color} description={crumb.description} />\n          <small>{getCrumbDetail(crumb)}</small>\n        </HoverListItem>\n      ))}\n    </HoverList>\n  );\n\n  const mostInteresting = crumbs.reduce((best, crumb) =>\n    sortByMostInterestingType(best, crumb) >= 1 ? best : crumb\n  );\n\n  const icon = crumbs.length === 1 ? <Icon type={mostInteresting.type} /> : crumbs.length;\n\n  return (\n    <IconPosition>\n      <Hovercard key={mostInteresting.id} body={title}>\n        <IconNode color={mostInteresting.color}>{icon}</IconNode>\n      </Hovercard>\n    </IconPosition>\n  );\n}\n\nconst HoverList = styled('ul')`\n  margin: 0;\n  padding: 0;\n`;\nconst HoverListItem = styled('li')`\n  display: flex;\n  gap: ${space(1)};\n  padding: ${space(0.5)};\n  border-bottom: 1px solid ${p => p.theme.innerBorder};\n  &:last-child {\n    border-bottom: none;\n  }\n`;\n\nconst IconPosition = styled('div')`\n  position: absolute;\n  transform: translate(-50%);\n  margin-left: ${EVENT_STICK_MARKER_WIDTH / 2}px;\n`;\n\nconst IconNode = styled('div')<{color: Color}>`\n  font-size: ${p => p.theme.fontSizeSmall};\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  width: 24px;\n  height: 24px;\n  border-radius: 50%;\n  color: ${p => p.theme.white};\n  background: ${p => p.theme[p.color] ?? p.color};\n  border: 1px solid ${p => p.theme.white};\n  box-shadow: ${p => p.theme.dropShadowLightest};\n`;\n\nexport default ReplayTimelineEvents;\n","import React from 'react';\nimport styled from '@emotion/styled';\n\nimport {divide, flattenSpans} from 'sentry/components/replays/utils';\nimport Tooltip from 'sentry/components/tooltip';\nimport {tn} from 'sentry/locale';\nimport space from 'sentry/styles/space';\nimport type {ReplaySpan} from 'sentry/views/replays/types';\n\ntype Props = {\n  /**\n   * Duration, in milliseconds, of the timeline\n   */\n  duration: number;\n\n  /**\n   * The spans to render into the timeline\n   */\n  spans: ReplaySpan[];\n\n  /**\n   * Timestamp when the timeline begins, in milliseconds\n   */\n  startTimestamp: number;\n\n  /**\n   * Extra classNames\n   */\n  className?: string;\n};\n\nfunction ReplayTimelineEvents({className, duration, spans, startTimestamp}: Props) {\n  const flattenedSpans = flattenSpans(spans);\n\n  const startMs = startTimestamp * 1000;\n  return (\n    <Spans className={className}>\n      {flattenedSpans.map((span, i) => {\n        const sinceStart = span.startTimestamp - startMs;\n        const startPct = divide(sinceStart, duration);\n        const widthPct = divide(span.duration, duration);\n\n        const requestsCount = tn(\n          '%s network request',\n          '%s network requests',\n          span.spanCount\n        );\n        return (\n          <Tooltip\n            key={i}\n            title={\n              <React.Fragment>\n                {requestsCount}\n                <br />\n                {span.duration.toFixed(2)}ms\n              </React.Fragment>\n            }\n            skipWrapper\n            disableForVisualTest\n          >\n            <Span startPct={startPct} widthPct={widthPct} />\n          </Tooltip>\n        );\n      })}\n    </Spans>\n  );\n}\n\nconst Spans = styled('ul')`\n  /* Reset defaults for <ul> */\n  list-style: none;\n  margin: 0;\n  padding: 0;\n\n  height: ${space(3)};\n  position: relative;\n`;\n// TODO(replay): sync colors like #865189 with chartPalette so there is consistency\nconst Span = styled('li')<{startPct: number; widthPct: number}>`\n  display: block;\n  position: absolute;\n  top: 0;\n  left: ${p => p.startPct * 100}%;\n  min-width: 1px;\n  width: ${p => p.widthPct * 100}%;\n  height: 100%;\n  background: #865189; /* plucked from static/app/constants/chartPalette.tsx */\n`;\n\nexport default React.memo(ReplayTimelineEvents);\n","import styled from '@emotion/styled';\n\n/**\n * Render all child elements directly on top of each other.\n *\n * This implementation does not remove the stack of elements from the document\n * flow, so width/height is reserved.\n *\n * An alternative would be to use `position:absolute;` in which case the size\n * would not be part of document flow and other elements could render behind.\n */\nconst Stacked = styled('div')`\n  display: grid;\n  grid-template: 1fr / 1fr;\n  > * {\n    grid-area: 1 / 1;\n  }\n`;\n\nexport default Stacked;\n","import type {Replayer} from 'rrweb';\n\nconst DEFAULT_HIGHLIGHT_COLOR = 'rgba(168, 196, 236, 0.75)';\n\nconst highlightsByNodeId: Map<number, {canvas: HTMLCanvasElement}> = new Map();\n\ninterface AddHighlightParams {\n  nodeId: number;\n  replayer: Replayer;\n  annotation?: string;\n  color?: string;\n}\n\ninterface RemoveHighlightParams {\n  nodeId: number;\n  replayer: Replayer;\n}\n\ninterface ClearAllHighlightsParams {\n  replayer: Replayer;\n}\n\nexport function clearAllHighlights({replayer}: ClearAllHighlightsParams) {\n  for (const nodeId of highlightsByNodeId.keys()) {\n    removeHighlightedNode({replayer, nodeId});\n  }\n}\n\n/**\n * Remove the canvas that has the highlight for a node.\n *\n * XXX: This is potentially not good if we have a lot of highlights, as we\n * are creating a new canvas PER highlight.\n */\nexport function removeHighlightedNode({replayer, nodeId}: RemoveHighlightParams) {\n  if (!highlightsByNodeId.has(nodeId)) {\n    return false;\n  }\n\n  const highlightObj = highlightsByNodeId.get(nodeId);\n\n  if (!highlightObj || !replayer.wrapper.contains(highlightObj.canvas)) {\n    return false;\n  }\n\n  replayer.wrapper.removeChild(highlightObj.canvas);\n  highlightsByNodeId.delete(nodeId);\n\n  return true;\n}\n\n/**\n * Attempt to highlight the node inside of a replay recording\n */\nexport function highlightNode({\n  replayer,\n  nodeId,\n  annotation = '',\n  color,\n}: AddHighlightParams) {\n  // @ts-expect-error mouseTail is private\n  const {mouseTail, wrapper} = replayer;\n  const mirror = replayer.getMirror();\n  const node = mirror.getNode(nodeId);\n\n  // TODO(replays): There is some sort of race condition here when you \"rewind\" a replay,\n  // mirror will be empty and highlight does not get added because node is null\n  if (!node || !replayer.iframe.contentDocument?.body?.contains(node)) {\n    return null;\n  }\n\n  // @ts-ignore This builds locally, but fails in CI -- ignoring for now\n  const {top, left, width, height} = node.getBoundingClientRect();\n  const highlightColor = color ?? DEFAULT_HIGHLIGHT_COLOR;\n\n  // Clone the mouseTail canvas as it has the dimensions and position that we\n  // want on top of the replay. We may need to revisit this strategy as we\n  // create a new canvas for every highlight. See additional notes in\n  // removeHighlight() method.\n  const canvas = mouseTail.cloneNode();\n\n  const ctx = canvas.getContext('2d');\n\n  if (!ctx) {\n    return null;\n  }\n\n  // TODO(replays): Does not account for scrolling (should we attempt to keep highlight visible, or does it disappear)\n\n  // Draw a rectangle to highlight element\n  ctx.fillStyle = highlightColor;\n  ctx.fillRect(left, top, width, height);\n\n  // Draw a dashed border around highlight\n  ctx.beginPath();\n  ctx.setLineDash([5, 5]);\n  ctx.moveTo(left, top);\n  ctx.lineTo(left + width, top);\n  ctx.lineTo(left + width, top + height);\n  ctx.lineTo(left, top + height);\n  ctx.closePath();\n  ctx.stroke();\n\n  ctx.font = '24px Rubik';\n  ctx.textAlign = 'right';\n  ctx.textBaseline = 'bottom';\n\n  const textWidth = ctx.measureText(annotation).width;\n\n  // Draw rect around text\n  ctx.fillStyle = 'rgba(30, 30, 30, 0.75)';\n  ctx.fillRect(left + width - textWidth, top + height - 30, textWidth, 30);\n\n  // Draw text\n  ctx.fillStyle = 'white';\n  ctx.fillText(annotation, left + width, top + height);\n\n  highlightsByNodeId.set(nodeId, {\n    canvas,\n  });\n\n  wrapper.insertBefore(canvas, mouseTail);\n\n  return {\n    canvas,\n  };\n}\n","import type {Replayer} from 'rrweb';\nimport type {eventWithTime} from 'rrweb/typings/types';\n\nimport {highlightNode, removeHighlightedNode} from 'sentry/utils/replays/highlightNode';\nimport type {Highlight} from 'sentry/views/replays/types';\n\ninterface HighlightReplayPluginOptions {\n  defaultHighlightColor?: string;\n}\n\ntype HighlightPluginEvent = eventWithTime & {data: Highlight};\n\nconst DEFAULT_HIDE_HIGHLIGHT_TIMEOUT = 5000;\n\nfunction isHighlightEvent(event: eventWithTime): event is HighlightPluginEvent {\n  return 'nodeId' in event.data;\n}\n\nclass HighlightReplayPlugin {\n  defaultHighlightColor: string;\n  highlightsByNodeId: Map<number, {added: number; expires: number}> = new Map();\n\n  constructor({\n    defaultHighlightColor = 'rgba(168, 196, 236, 0.75)',\n  }: HighlightReplayPluginOptions = {}) {\n    this.defaultHighlightColor = defaultHighlightColor;\n  }\n\n  /**\n   * Remove the highlighted node\n   */\n  removeHighlight(nodeId: number, replayer: Replayer) {\n    if (removeHighlightedNode({nodeId, replayer})) {\n      this.highlightsByNodeId.delete(nodeId);\n    }\n  }\n\n  handler(event: eventWithTime, _isSync: boolean, {replayer}: {replayer: Replayer}) {\n    // Check for currently highlighted nodes that have been removed from the DOM in the replay\n    if (\n      this.highlightsByNodeId.size &&\n      'removes' in event.data &&\n      event.data.removes?.length\n    ) {\n      // If a highlighted node was removed from DOM we need to remove the highlight canvas\n      event.data.removes.forEach(removedNode => {\n        if ('id' in removedNode) {\n          this.removeHighlight(removedNode.id, replayer);\n        }\n      });\n    }\n\n    // Check and remove expired highlights\n    if (this.highlightsByNodeId.size) {\n      Array.from(this.highlightsByNodeId.entries())\n        .filter(\n          ([, {added, expires}]) => event.timestamp < added || event.timestamp >= expires\n        )\n        .forEach(([nodeId]) => {\n          this.removeHighlight(nodeId, replayer);\n        });\n    }\n\n    // If we have highlights and the replay event is a scroll event, update the highlight\n    // `event.type` == EventType.IncrementalSnapshot (https://github.com/rrweb-io/rrweb/blob/master/packages/rrweb/src/types.ts#L20)\n    // `event.data.source` == IncrementalSource.Scroll (https://github.com/rrweb-io/rrweb/blob/master/packages/rrweb/src/types.ts#L83)\n    if (this.highlightsByNodeId.size && event.type === 3 && event.data.source === 3) {\n      // TODO(replays): Re-draw rect instead of removing it (:\n      Array.from(this.highlightsByNodeId.entries()).forEach(([nodeId]) => {\n        this.removeHighlight(nodeId, replayer);\n      });\n    }\n\n    if (!isHighlightEvent(event) || event.data.nodeId < 0) {\n      return;\n    }\n\n    const highlightObj = event.data;\n\n    const highlightResult = highlightNode({\n      replayer,\n      nodeId: highlightObj.nodeId,\n      annotation: highlightObj.text,\n    });\n\n    if (!highlightResult) {\n      return;\n    }\n\n    this.highlightsByNodeId.set(highlightObj.nodeId, {\n      added: event.timestamp,\n      expires: event.timestamp + DEFAULT_HIDE_HIGHLIGHT_TIMEOUT,\n    });\n  }\n}\n\nexport default HighlightReplayPlugin;\n","import React, {useCallback, useContext, useEffect, useRef, useState} from 'react';\nimport {useTheme} from '@emotion/react';\nimport {Replayer, ReplayerEvents} from 'rrweb';\n\nimport {\n  clearAllHighlights,\n  highlightNode,\n  removeHighlightedNode,\n} from 'sentry/utils/replays/highlightNode';\nimport useRAF from 'sentry/utils/replays/hooks/useRAF';\nimport type ReplayReader from 'sentry/utils/replays/replayReader';\nimport usePrevious from 'sentry/utils/usePrevious';\n\nimport HighlightReplayPlugin from './highlightReplayPlugin';\n\ntype Dimensions = {height: number; width: number};\ntype RootElem = null | HTMLDivElement;\n\n// Important: Don't allow context Consumers to access `Replayer` directly.\n// It has state that, when changed, will not trigger a react render.\n// Instead only expose methods that wrap `Replayer` and manage state.\ntype ReplayPlayerContextProps = {\n  /**\n   * Clear all existing highlights in replay\n   */\n  clearAllHighlights: () => void;\n\n  /**\n   * The time, in milliseconds, where the user focus is.\n   * The user focus can be reported by any collaborating object, usually on\n   * hover.\n   */\n  currentHoverTime: undefined | number;\n\n  /**\n   * The current time of the video, in milliseconds\n   * The value is updated on every animation frame, about every 16.6ms\n   */\n  currentTime: number;\n\n  /**\n   * Original dimensions in pixels of the captured browser window\n   */\n  dimensions: Dimensions;\n\n  /**\n   * Duration of the video, in miliseconds\n   */\n  duration: undefined | number;\n\n  /**\n   * The calculated speed of the player when fast-forwarding through idle moments in the video\n   * The value is set to `0` when the video is not fast-forwarding\n   * The speed is automatically determined by the length of each idle period\n   */\n  fastForwardSpeed: number;\n\n  /**\n   * Highlight a node in the replay\n   */\n  highlight: ({nodeId}: {nodeId: number}) => void;\n\n  /**\n   * Required to be called with a <div> Ref\n   * Represents the location in the DOM where the iframe video should be mounted\n   *\n   * @param _root\n   */\n  initRoot: (root: RootElem) => void;\n\n  /**\n   * Set to true while the library is reconstructing the DOM\n   */\n  isBuffering: boolean;\n\n  /**\n   * Whether the video is currently playing\n   */\n  isPlaying: boolean;\n\n  /**\n   * Whether fast-forward mode is enabled if RRWeb detects idle moments in the video\n   */\n  isSkippingInactive: boolean;\n\n  /**\n   * Removes a highlighted node from the replay\n   */\n  removeHighlight: ({nodeId}: {nodeId: number}) => void;\n\n  /**\n   * The core replay data\n   */\n  replay: ReplayReader | null;\n\n  /**\n   * Set the currentHoverTime so collaborating components can highlight related\n   * information\n   */\n  setCurrentHoverTime: (time: undefined | number) => void;\n\n  /**\n   * Jump the video to a specific time\n   */\n  setCurrentTime: (time: number) => void;\n\n  /**\n   * Set speed for normal playback\n   */\n  setSpeed: (speed: number) => void;\n\n  /**\n   * The speed for normal playback\n   */\n  speed: number;\n\n  /**\n   * Start or stop playback\n   *\n   * @param play\n   */\n  togglePlayPause: (play: boolean) => void;\n\n  /**\n   * Allow RRWeb to use Fast-Forward mode for idle moments in the video\n   *\n   * @param skip\n   */\n  toggleSkipInactive: (skip: boolean) => void;\n};\n\nconst ReplayPlayerContext = React.createContext<ReplayPlayerContextProps>({\n  clearAllHighlights: () => {},\n  currentHoverTime: undefined,\n  currentTime: 0,\n  dimensions: {height: 0, width: 0},\n  duration: undefined,\n  fastForwardSpeed: 0,\n  highlight: () => {},\n  initRoot: () => {},\n  isBuffering: false,\n  isPlaying: false,\n  isSkippingInactive: false,\n  removeHighlight: () => {},\n  replay: null,\n  setCurrentHoverTime: () => {},\n  setCurrentTime: () => {},\n  setSpeed: () => {},\n  speed: 1,\n  togglePlayPause: () => {},\n  toggleSkipInactive: () => {},\n});\n\ntype Props = {\n  children: React.ReactNode;\n  replay: ReplayReader | null;\n\n  /**\n   * Time, in seconds, when the video should start\n   */\n  initialTimeOffset?: number;\n\n  /**\n   * Override return fields for testing\n   */\n  value?: Partial<ReplayPlayerContextProps>;\n};\n\nfunction useCurrentTime(callback: () => number) {\n  const [currentTime, setCurrentTime] = useState(0);\n  useRAF(() => setCurrentTime(callback));\n  return currentTime;\n}\n\nexport function Provider({children, replay, initialTimeOffset = 0, value = {}}: Props) {\n  const events = replay?.getRRWebEvents();\n\n  const theme = useTheme();\n  const oldEvents = usePrevious(events);\n  // Note we have to check this outside of hooks, see `usePrevious` comments\n  const hasNewEvents = events !== oldEvents;\n  const replayerRef = useRef<Replayer>(null);\n  const [dimensions, setDimensions] = useState<Dimensions>({height: 0, width: 0});\n  const [currentHoverTime, setCurrentHoverTime] = useState<undefined | number>();\n  const [isPlaying, setIsPlaying] = useState(false);\n  const [isSkippingInactive, setIsSkippingInactive] = useState(false);\n  const [speed, setSpeedState] = useState(1);\n  const [fastForwardSpeed, setFFSpeed] = useState(0);\n  const [buffer, setBufferTime] = useState({target: -1, previous: -1});\n  const playTimer = useRef<number | undefined>(undefined);\n\n  const forceDimensions = (dimension: Dimensions) => {\n    setDimensions(dimension);\n  };\n  const setPlayingFalse = () => {\n    setIsPlaying(false);\n  };\n  const onFastForwardStart = (e: {speed: number}) => {\n    setFFSpeed(e.speed);\n  };\n  const onFastForwardEnd = () => {\n    setFFSpeed(0);\n  };\n\n  const highlight = useCallback(({nodeId}: {nodeId: number}) => {\n    const replayer = replayerRef.current;\n    if (!replayer) {\n      return;\n    }\n\n    highlightNode({replayer, nodeId});\n  }, []);\n\n  const clearAllHighlightsCallback = useCallback(() => {\n    const replayer = replayerRef.current;\n    if (!replayer) {\n      return;\n    }\n\n    clearAllHighlights({replayer});\n  }, []);\n\n  const removeHighlight = useCallback(({nodeId}: {nodeId: number}) => {\n    const replayer = replayerRef.current;\n    if (!replayer) {\n      return;\n    }\n\n    removeHighlightedNode({replayer, nodeId});\n  }, []);\n\n  const initRoot = useCallback(\n    (root: RootElem) => {\n      if (events === undefined) {\n        return;\n      }\n\n      if (root === null) {\n        return;\n      }\n\n      if (replayerRef.current) {\n        if (!hasNewEvents) {\n          // Already have a player for these events, the parent node must've re-rendered\n          return;\n        }\n\n        if (replayerRef.current.iframe.contentDocument?.body.childElementCount === 0) {\n          // If this is true, then no need to clear old iframe as nothing was rendered\n          return;\n        }\n\n        // We have new events, need to clear out the old iframe because a new\n        // `Replayer` instance is about to be created\n        while (root.firstChild) {\n          root.removeChild(root.firstChild);\n        }\n      }\n\n      const highlightReplayPlugin = new HighlightReplayPlugin();\n\n      // eslint-disable-next-line no-new\n      const inst = new Replayer(events, {\n        root,\n        blockClass: 'sr-block',\n        // liveMode: false,\n        // triggerFocus: false,\n        mouseTail: {\n          duration: 0.75 * 1000,\n          lineCap: 'round',\n          lineWidth: 2,\n          strokeStyle: theme.purple200,\n        },\n        // unpackFn: _ => _,\n        plugins: [highlightReplayPlugin],\n      });\n\n      // @ts-expect-error: rrweb types event handlers with `unknown` parameters\n      inst.on(ReplayerEvents.Resize, forceDimensions);\n      inst.on(ReplayerEvents.Finish, setPlayingFalse);\n      // @ts-expect-error: rrweb types event handlers with `unknown` parameters\n      inst.on(ReplayerEvents.SkipStart, onFastForwardStart);\n      inst.on(ReplayerEvents.SkipEnd, onFastForwardEnd);\n\n      // `.current` is marked as readonly, but it's safe to set the value from\n      // inside a `useEffect` hook.\n      // See: https://reactjs.org/docs/hooks-faq.html#is-there-something-like-instance-variables\n      // @ts-expect-error\n      replayerRef.current = inst;\n    },\n    [events, theme.purple200, hasNewEvents]\n  );\n\n  useEffect(() => {\n    if (replayerRef.current && events) {\n      initRoot(replayerRef.current.wrapper.parentElement as RootElem);\n    }\n  }, [initRoot, events]);\n\n  const getCurrentTime = useCallback(\n    () => (replayerRef.current ? Math.max(replayerRef.current.getCurrentTime(), 0) : 0),\n    []\n  );\n\n  const setCurrentTime = useCallback(\n    (requestedTimeMs: number) => {\n      const replayer = replayerRef.current;\n      if (!replayer) {\n        return;\n      }\n\n      const maxTimeMs = replayerRef.current?.getMetaData().totalTime;\n      const time = requestedTimeMs > maxTimeMs ? 0 : requestedTimeMs;\n\n      // Sometimes rrweb doesn't get to the exact target time, as long as it has\n      // changed away from the previous time then we can hide then buffering message.\n      setBufferTime({target: time, previous: getCurrentTime()});\n\n      // Clear previous timers. Without this (but with the setTimeout) multiple\n      // requests to set the currentTime could finish out of order and cause jumping.\n      if (playTimer.current) {\n        window.clearTimeout(playTimer.current);\n      }\n\n      if (isPlaying) {\n        playTimer.current = window.setTimeout(() => replayer.play(time), 0);\n        setIsPlaying(true);\n      } else {\n        playTimer.current = window.setTimeout(() => replayer.pause(time), 0);\n        setIsPlaying(false);\n      }\n    },\n    [getCurrentTime, isPlaying]\n  );\n\n  const setSpeed = useCallback(\n    (newSpeed: number) => {\n      const replayer = replayerRef.current;\n      if (!replayer) {\n        return;\n      }\n      if (isPlaying) {\n        replayer.pause();\n        replayer.setConfig({speed: newSpeed});\n        replayer.play(getCurrentTime());\n      } else {\n        replayer.setConfig({speed: newSpeed});\n      }\n      setSpeedState(newSpeed);\n    },\n    [getCurrentTime, isPlaying]\n  );\n\n  const togglePlayPause = useCallback(\n    (play: boolean) => {\n      const replayer = replayerRef.current;\n      if (!replayer) {\n        return;\n      }\n\n      if (play) {\n        replayer.play(getCurrentTime());\n      } else {\n        replayer.pause(getCurrentTime());\n      }\n      setIsPlaying(play);\n    },\n    [getCurrentTime]\n  );\n\n  const toggleSkipInactive = useCallback((skip: boolean) => {\n    const replayer = replayerRef.current;\n    if (!replayer) {\n      return;\n    }\n    if (skip !== replayer.config.skipInactive) {\n      replayer.setConfig({skipInactive: skip});\n    }\n    setIsSkippingInactive(skip);\n  }, []);\n\n  // Only on pageload: set the initial playback timestamp\n  useEffect(() => {\n    if (initialTimeOffset && events && replayerRef.current) {\n      setCurrentTime(initialTimeOffset * 1000);\n    }\n  }, [events, replayerRef.current]); // eslint-disable-line react-hooks/exhaustive-deps\n\n  const currentPlayerTime = useCurrentTime(getCurrentTime);\n\n  const [isBuffering, currentTime] =\n    buffer.target !== -1 && buffer.previous === currentPlayerTime\n      ? [true, buffer.target]\n      : [false, currentPlayerTime];\n\n  if (!isBuffering && buffer.target !== -1) {\n    setBufferTime({target: -1, previous: -1});\n  }\n\n  const event = replay?.getEvent();\n  const duration = event ? (event.endTimestamp - event.startTimestamp) * 1000 : undefined;\n\n  return (\n    <ReplayPlayerContext.Provider\n      value={{\n        clearAllHighlights: clearAllHighlightsCallback,\n        currentHoverTime,\n        currentTime,\n        dimensions,\n        duration,\n        fastForwardSpeed,\n        highlight,\n        initRoot,\n        isBuffering,\n        isPlaying,\n        isSkippingInactive,\n        removeHighlight,\n        replay,\n        setCurrentHoverTime,\n        setCurrentTime,\n        setSpeed,\n        speed,\n        togglePlayPause,\n        toggleSkipInactive,\n        ...value,\n      }}\n    >\n      {children}\n    </ReplayPlayerContext.Provider>\n  );\n}\n\nexport const useReplayContext = () => useContext(ReplayPlayerContext);\n","import {useEffect} from 'react';\n\n// TODO: move into app/utils/*\nexport default function useRAF(callback: () => unknown) {\n  useEffect(() => {\n    const timer = window.requestAnimationFrame(callback);\n    return () => window.cancelAnimationFrame(timer);\n  }, [callback]);\n}\n","import React, {useCallback, useRef} from 'react';\nimport * as Sentry from '@sentry/react';\n\nimport {useReplayContext} from 'sentry/components/replays/replayContext';\n\ntype Props = {\n  children: React.ReactNode;\n};\n\nclass AbortError extends Error {}\n\n/**\n * Replace `elem.getBoundingClientRect()` which is too laggy for onMouseMove\n */\nfunction getBoundingRect(\n  elem: Element,\n  {signal}: {signal: AbortSignal}\n): Promise<DOMRectReadOnly> {\n  return new Promise((resolve, reject) => {\n    if (signal.aborted) {\n      reject(new AbortError());\n    }\n\n    const abortHandler = () => {\n      reject(new AbortError());\n    };\n\n    const observer = new IntersectionObserver(entries => {\n      for (const entry of entries) {\n        const bounds = entry.boundingClientRect;\n        resolve(bounds);\n        signal.removeEventListener('abort', abortHandler);\n      }\n      observer.disconnect();\n    });\n    signal.addEventListener('abort', abortHandler);\n    observer.observe(elem);\n  });\n}\n\n// TODO(replay): should this be an HoC?\nfunction HorizontalMouseTracking({children}: Props) {\n  const elem = useRef<HTMLDivElement>(null);\n  const controller = useRef<AbortController>(new AbortController());\n  const {duration, setCurrentHoverTime} = useReplayContext();\n\n  const onMouseMove = useCallback(\n    async (e: React.MouseEvent<HTMLDivElement, MouseEvent>) => {\n      if (!elem.current || duration === undefined) {\n        setCurrentHoverTime(undefined);\n        return;\n      }\n\n      try {\n        const rect = await getBoundingRect(elem.current, {\n          signal: controller.current.signal,\n        });\n        const left = e.clientX - rect.left;\n        if (left >= 0) {\n          const percent = left / rect.width;\n          const time = percent * duration;\n          setCurrentHoverTime(time);\n        } else {\n          setCurrentHoverTime(undefined);\n        }\n      } catch (err) {\n        if (err instanceof AbortError) {\n          // Ignore abortions\n          return;\n        }\n\n        Sentry.captureException(err);\n      }\n    },\n    [controller, duration, setCurrentHoverTime]\n  );\n\n  const onMouseLeave = useCallback(() => {\n    if (controller.current) {\n      controller.current.abort();\n      controller.current = new AbortController();\n    }\n\n    setCurrentHoverTime(undefined);\n  }, [controller, setCurrentHoverTime]);\n\n  return (\n    <div\n      ref={elem}\n      onMouseEnter={onMouseMove}\n      onMouseMove={onMouseMove}\n      onMouseLeave={onMouseLeave}\n    >\n      {children}\n    </div>\n  );\n}\n\nexport default HorizontalMouseTracking;\n","import styled from '@emotion/styled';\n\n/**\n * A simple progress bar.\n * ```\n * <Meter>\n *   <Value percent={0.75} />\n * </Meter>\n * ```\n *\n * Extend the components to set a background color.\n *\n * Return multiple <Value /> components to render multiple bars directly on top\n * of each other with `position:absolute;`.\n */\nexport const Meter = styled('div')`\n  position: relative;\n  height: 100%;\n  width: 100%;\n  pointer-events: none;\n`;\n\nexport const Value = styled('span')<{\n  percent: number;\n}>`\n  position: absolute;\n  height: 100%;\n  width: ${p => p.percent * 100}%;\n  pointer-events: none;\n`;\n","import React from 'react';\nimport styled from '@emotion/styled';\n\nimport RangeSlider from 'sentry/components/forms/controls/rangeSlider';\nimport * as Progress from 'sentry/components/replays/progress';\nimport {useReplayContext} from 'sentry/components/replays/replayContext';\nimport {divide} from 'sentry/components/replays/utils';\nimport space from 'sentry/styles/space';\n\ntype Props = {\n  className?: string;\n};\n\nfunction Scrubber({className}: Props) {\n  const {currentHoverTime, currentTime, duration, setCurrentTime} = useReplayContext();\n\n  const percentComplete = divide(currentTime, duration);\n  const hoverPlace = divide(currentHoverTime || 0, duration);\n\n  return (\n    <Wrapper className={className}>\n      <Meter>\n        {currentHoverTime ? <MouseTrackingValue percent={hoverPlace} /> : null}\n        <PlaybackTimeValue percent={percentComplete} />\n      </Meter>\n      <RangeWrapper>\n        <Range\n          name=\"replay-timeline\"\n          min={0}\n          max={duration}\n          value={Math.round(currentTime)}\n          onChange={value => setCurrentTime(value || 0)}\n          showLabel={false}\n        />\n      </RangeWrapper>\n    </Wrapper>\n  );\n}\n\nconst Meter = styled(Progress.Meter)`\n  background: ${p => p.theme.gray200};\n`;\n\nconst RangeWrapper = styled('div')`\n  overflow: hidden;\n  width: 100%;\n`;\n\nconst Range = styled(RangeSlider)`\n  input {\n    cursor: pointer;\n    opacity: 0;\n    height: 100%;\n  }\n`;\n\nconst PlaybackTimeValue = styled(Progress.Value)`\n  background: ${p => p.theme.purple300};\n`;\n\nconst MouseTrackingValue = styled(Progress.Value)`\n  background: ${p => p.theme.purple200};\n`;\n\nconst Wrapper = styled('div')`\n  position: relative;\n\n  width: 100%;\n\n  & > * {\n    position: absolute;\n    top: 0;\n    left: 0;\n  }\n\n  ${MouseTrackingValue}:after {\n    content: '';\n    display: block;\n    width: ${space(0.5)};\n    height: ${space(1.5)};\n    pointer-events: none;\n    background: ${p => p.theme.purple200};\n    box-sizing: content-box;\n    position: absolute;\n    top: -${space(0.5)};\n    right: -1px;\n  }\n\n  :hover ${MouseTrackingValue}:after {\n    height: ${space(2)};\n    top: -${space(0.5)};\n  }\n`;\n\nexport const TimelineScubber = styled(Scrubber)`\n  height: ${space(0.5)};\n\n  :hover {\n    margin-block: -${space(0.25)};\n    height: ${space(1)};\n  }\n\n  ${RangeWrapper} {\n    height: ${space(0.5)};\n  }\n  :hover ${RangeWrapper} {\n    height: ${space(0.75)};\n  }\n`;\n\nexport const PlayerScrubber = styled(Scrubber)`\n  height: ${space(0.5)};\n\n  :hover {\n    margin-block: -${space(0.25)};\n    height: ${space(1)};\n  }\n\n  ${RangeWrapper} {\n    height: ${space(0.5)};\n  }\n  :hover ${RangeWrapper} {\n    height: ${space(0.75)};\n  }\n\n  ${PlaybackTimeValue}:after {\n    content: '';\n    display: block;\n    width: ${space(2)};\n    height: ${space(2)}; /* equal to width */\n    z-index: ${p => p.theme.zIndex.initial};\n    pointer-events: none;\n    background: ${p => p.theme.purple300};\n    box-sizing: content-box;\n    border-radius: ${space(2)}; /* greater than or equal to width */\n    border: solid ${p => p.theme.white};\n    border-width: ${space(0.5)};\n    position: absolute;\n    top: -${space(1)}; /* Half the width */\n    right: -${space(1.5)}; /* Half of (width + borderWidth) */\n    opacity: 0;\n    transition: opacity 0.1s ease;\n  }\n  :hover ${PlaybackTimeValue}:after {\n    opacity: 1;\n  }\n`;\n","import React, {useCallback, useRef, useState} from 'react';\nimport {useResizeObserver} from '@react-aria/utils';\n\ntype Dimensions = {height: number; width: number};\n\ntype Props = {\n  children: (props: Dimensions) => React.ReactElement | null;\n  className?: string;\n};\n\n/**\n * Watch and pass element dimensions into child render function.\n *\n * WARNING: be careful not to update the dimensions of child elements based on\n * this parent size as that could cause infinite render loops\n */\nexport function Resizeable({children, className}: Props) {\n  const el = useRef<HTMLDivElement>(null);\n\n  const [dimensions, setDimensions] = useState({height: 0, width: 0});\n\n  const onResize = useCallback(() => {\n    setDimensions({\n      height: el.current?.clientHeight || 0,\n      width: el.current?.clientWidth || 0,\n    });\n  }, [setDimensions]);\n\n  useResizeObserver({ref: el, onResize});\n\n  return (\n    <div className={className} ref={el}>\n      {children(dimensions)}\n    </div>\n  );\n}\n","import React from 'react';\nimport styled from '@emotion/styled';\n\nimport * as Progress from 'sentry/components/replays/progress';\nimport {divide} from 'sentry/components/replays/utils';\nimport space from 'sentry/styles/space';\n\ntype Props = {\n  color: string;\n  currentTime: number;\n  duration: number | undefined;\n};\n\nfunction TimelinePosition({color, currentTime, duration}: Props) {\n  const percentComplete = divide(currentTime, duration);\n\n  return (\n    <Progress.Meter>\n      <Value color={color} percent={percentComplete} />\n    </Progress.Meter>\n  );\n}\n\nconst Value = styled(Progress.Value)<Pick<Props, 'color'>>`\n  border-right: ${space(0.25)} solid ${p => p.color};\n`;\n\nexport default TimelinePosition;\n","import React from 'react';\nimport {useTheme} from '@emotion/react';\nimport styled from '@emotion/styled';\n\nimport {Panel} from 'sentry/components/panels';\nimport Placeholder from 'sentry/components/placeholder';\nimport {\n  MajorGridlines,\n  MinorGridlines,\n} from 'sentry/components/replays/breadcrumbs/gridlines';\nimport ReplayTimelineEvents from 'sentry/components/replays/breadcrumbs/replayTimelineEvents';\nimport ReplayTimelineSpans from 'sentry/components/replays/breadcrumbs/replayTimelineSpans';\nimport Stacked from 'sentry/components/replays/breadcrumbs/stacked';\nimport HorizontalMouseTracking from 'sentry/components/replays/player/horizontalMouseTracking';\nimport {TimelineScubber} from 'sentry/components/replays/player/scrubber';\nimport {useReplayContext} from 'sentry/components/replays/replayContext';\nimport {Resizeable} from 'sentry/components/replays/resizeable';\nimport TimelinePosition from 'sentry/components/replays/timelinePosition';\nimport {BreadcrumbType} from 'sentry/types/breadcrumbs';\n\ntype Props = {};\n\nconst USER_ACTIONS = [\n  BreadcrumbType.ERROR,\n  BreadcrumbType.NAVIGATION,\n  BreadcrumbType.UI,\n  BreadcrumbType.USER,\n];\n\nfunction ReplayTimeline({}: Props) {\n  const theme = useTheme();\n  const {currentHoverTime, currentTime, duration, replay} = useReplayContext();\n\n  if (!replay) {\n    return <Placeholder height=\"86px\" bottomGutter={2} />;\n  }\n\n  const crumbs = replay.getRawCrumbs() || [];\n  const spans = replay.getRawSpans() || [];\n  const userCrumbs = crumbs.filter(crumb => USER_ACTIONS.includes(crumb.type));\n\n  const networkSpans = spans.filter(replay.isNotMemorySpan);\n\n  return (\n    <Panel>\n      <HorizontalMouseTracking>\n        <Resizeable>\n          {({width}) => (\n            <Stacked>\n              <MinorGridlines duration={duration || 0} width={width} />\n              <MajorGridlines duration={duration || 0} width={width} />\n              <StackedUnderTimestamp>\n                <TimelinePosition\n                  color={theme.purple300}\n                  currentTime={currentTime}\n                  duration={duration}\n                />\n                {currentHoverTime ? (\n                  <TimelinePosition\n                    color={theme.purple200}\n                    currentTime={currentHoverTime}\n                    duration={duration}\n                  />\n                ) : null}\n                <div>\n                  <TimelineScubber />\n                  <ReplayTimelineEvents\n                    crumbs={userCrumbs}\n                    duration={duration || 0}\n                    startTimestamp={replay.getEvent().startTimestamp}\n                    width={width}\n                  />\n                  <ReplayTimelineSpans\n                    duration={duration || 0}\n                    spans={networkSpans}\n                    startTimestamp={replay.getEvent().startTimestamp}\n                  />\n                </div>\n              </StackedUnderTimestamp>\n            </Stacked>\n          )}\n        </Resizeable>\n      </HorizontalMouseTracking>\n    </Panel>\n  );\n}\n\nconst StackedUnderTimestamp = styled(Stacked)`\n  /* Weird size to put equal space above/below a <small> node that MajorGridlines emits */\n  padding-top: 24px;\n`;\n\nexport default ReplayTimeline;\n","import {Crumb} from 'sentry/types/breadcrumbs';\n\nexport function getPrevBreadcrumb({\n  crumbs,\n  targetTimestampMs,\n  allowExact = false,\n}: {\n  crumbs: Crumb[];\n  targetTimestampMs: number;\n  allowExact?: boolean;\n}) {\n  return crumbs.reduce<Crumb | undefined>((prev, crumb) => {\n    const crumbTimestampMS = +new Date(crumb.timestamp || '');\n\n    if (\n      crumbTimestampMS > targetTimestampMs ||\n      (!allowExact && crumbTimestampMS === targetTimestampMs)\n    ) {\n      return prev;\n    }\n    if (!prev || crumbTimestampMS > +new Date(prev.timestamp || '')) {\n      return crumb;\n    }\n    return prev;\n  }, undefined);\n}\n\nexport function getNextBreadcrumb({\n  crumbs,\n  targetTimestampMs,\n  allowExact = false,\n}: {\n  crumbs: Crumb[];\n  targetTimestampMs: number;\n  allowExact?: boolean;\n}) {\n  return crumbs.reduce<Crumb | undefined>((found, crumb) => {\n    const crumbTimestampMS = +new Date(crumb.timestamp || '');\n\n    if (\n      crumbTimestampMS < targetTimestampMs ||\n      (!allowExact && crumbTimestampMS === targetTimestampMs)\n    ) {\n      return found;\n    }\n    if (!found || crumbTimestampMS < +new Date(found.timestamp || '')) {\n      return crumb;\n    }\n    return found;\n  }, undefined);\n}\n","import {MutableRefObject, useCallback, useEffect, useRef, useState} from 'react';\nimport screenfull from 'screenfull';\n\n// See: https://developer.mozilla.org/en-US/docs/web/api/element/requestfullscreen#options_2\ninterface FullscreenOptions {\n  navigationUI: 'hide' | 'show' | 'auto';\n}\n\ninterface FullscreenHook {\n  /**\n   * Render, in fullscreen, the `ref` that this instance relates to. If `ref`\n   * is unset, then `<html>` will be used.\n   */\n  enter: (options?: FullscreenOptions) => void;\n\n  /**\n   * Bring the browser out of fullscreen, regardless of which DOM element is\n   * currently active.\n   */\n  exit: () => void;\n\n  /**\n   * If the browser supports going fullscreen or not. iPhone Safari won't do\n   * it. https://caniuse.com/fullscreen\n   */\n  isEnabled: boolean;\n\n  /**\n   * Whether any element on the page is rendered fullscreen.\n   */\n  isFullscreen: boolean;\n\n  /**\n   * The element that this instance of `enter()` will use to go fullscreen.\n   * Calling `useFullscreen()` a second time will create a different instance of\n   * `ref` and `enter.\n   */\n  ref: MutableRefObject<null | HTMLDivElement>;\n\n  /**\n   * Toggle fullscreen mode on and off, for the `ref` that this instance\n   * relates to.\n   */\n  toggle: () => void;\n}\n\n// TODO(replay): move into app/utils/*\nexport default function useFullscreen(): FullscreenHook {\n  const ref = useRef<null | HTMLDivElement>(null);\n\n  const [isFullscreen, setIsFullscreen] = useState(false);\n\n  const enter = useCallback(async (opts: FullscreenOptions = {navigationUI: 'auto'}) => {\n    if (screenfull.isEnabled && ref.current) {\n      await screenfull.request(ref.current, opts);\n    }\n  }, []);\n\n  const exit = useCallback(async () => {\n    if (screenfull.isEnabled) {\n      await screenfull.exit();\n    }\n  }, []);\n\n  const toggle = useCallback(\n    () => (isFullscreen ? exit() : enter()),\n    [enter, exit, isFullscreen]\n  );\n\n  const onChange = () => {\n    setIsFullscreen(screenfull.isFullscreen);\n  };\n\n  useEffect(() => {\n    screenfull.on('change', onChange);\n    return () => screenfull.off('change', onChange);\n  }, []);\n\n  return {\n    enter,\n    exit,\n    isEnabled: screenfull.isEnabled,\n    isFullscreen,\n    ref,\n    toggle,\n  };\n}\n","import React from 'react';\nimport styled from '@emotion/styled';\n\nimport Button from 'sentry/components/button';\nimport ButtonBar from 'sentry/components/buttonBar';\nimport {transformCrumbs} from 'sentry/components/events/interfaces/breadcrumbs/utils';\nimport CompactSelect from 'sentry/components/forms/compactSelect';\nimport {useReplayContext} from 'sentry/components/replays/replayContext';\nimport {formatTime, relativeTimeInMs} from 'sentry/components/replays/utils';\nimport {\n  IconArrow,\n  IconNext,\n  IconPause,\n  IconPlay,\n  IconRefresh,\n  IconResize,\n} from 'sentry/icons';\nimport {t} from 'sentry/locale';\nimport space from 'sentry/styles/space';\nimport {BreadcrumbType} from 'sentry/types/breadcrumbs';\nimport {getNextBreadcrumb} from 'sentry/utils/replays/getBreadcrumb';\nimport useFullscreen from 'sentry/utils/replays/hooks/useFullscreen';\n\nconst SECOND = 1000;\n\nconst USER_ACTIONS = [\n  BreadcrumbType.ERROR,\n  BreadcrumbType.INIT,\n  BreadcrumbType.NAVIGATION,\n  BreadcrumbType.UI,\n  BreadcrumbType.USER,\n];\n\ninterface Props {\n  speedOptions?: number[];\n  toggleFullscreen?: () => void;\n}\n\nfunction ReplayPlayPauseBar() {\n  const {currentTime, isPlaying, replay, setCurrentTime, togglePlayPause} =\n    useReplayContext();\n\n  return (\n    <ButtonBar merged>\n      <Button\n        size=\"xsmall\"\n        title={t('Go back 10 seconds')}\n        icon={<IconRefresh size=\"sm\" />}\n        onClick={() => setCurrentTime(currentTime - 10 * SECOND)}\n        aria-label={t('Go back 10 seconds')}\n      />\n      <Button\n        size=\"xsmall\"\n        title={isPlaying ? t('Pause the Replay') : t('Play the Replay')}\n        icon={isPlaying ? <IconPause size=\"sm\" /> : <IconPlay size=\"sm\" />}\n        onClick={() => togglePlayPause(!isPlaying)}\n        aria-label={isPlaying ? t('Pause the Replay') : t('Play the Replay')}\n      />\n      <Button\n        size=\"xsmall\"\n        title={t('Jump to next event')}\n        icon={<IconNext size=\"sm\" />}\n        onClick={() => {\n          const startTimestampSec = replay?.getEvent().startTimestamp;\n          if (!startTimestampSec) {\n            return;\n          }\n          const transformedCrumbs = transformCrumbs(replay?.getRawCrumbs() || []);\n          const next = getNextBreadcrumb({\n            crumbs: transformedCrumbs.filter(crumb => USER_ACTIONS.includes(crumb.type)),\n            targetTimestampMs: startTimestampSec * 1000 + currentTime,\n          });\n\n          if (startTimestampSec !== undefined && next?.timestamp) {\n            setCurrentTime(relativeTimeInMs(next.timestamp, startTimestampSec));\n          }\n        }}\n        aria-label={t('Jump to next event')}\n      />\n    </ButtonBar>\n  );\n}\n\nfunction ReplayCurrentTime() {\n  const {currentTime, duration} = useReplayContext();\n\n  return (\n    <span>\n      {formatTime(currentTime)} / {duration ? formatTime(duration) : '??:??'}\n    </span>\n  );\n}\n\nfunction ReplayPlaybackSpeed({speedOptions}: {speedOptions: number[]}) {\n  const {setSpeed, speed} = useReplayContext();\n  return (\n    <CompactSelect\n      triggerProps={{\n        size: 'xsmall',\n        prefix: t('Speed'),\n      }}\n      value={speed}\n      options={speedOptions.map(speedOption => ({\n        value: speedOption,\n        label: `${speedOption}x`,\n        disabled: speedOption === speed,\n      }))}\n      onChange={opt => {\n        setSpeed(opt.value);\n      }}\n    />\n  );\n}\n\nconst ReplayControls = ({\n  toggleFullscreen = () => {},\n  speedOptions = [0.1, 0.25, 0.5, 1, 2, 4],\n}: Props) => {\n  const {isFullscreen} = useFullscreen();\n  const {isSkippingInactive, toggleSkipInactive} = useReplayContext();\n\n  return (\n    <ButtonGrid>\n      <ReplayPlayPauseBar />\n      <ReplayCurrentTime />\n\n      {/* TODO(replay): Need a better icon for the FastForward toggle */}\n      <Button\n        size=\"xsmall\"\n        title={t('Fast-forward idle moments')}\n        aria-label={t('Fast-forward idle moments')}\n        icon={<IconArrow size=\"sm\" direction=\"right\" />}\n        priority={isSkippingInactive ? 'primary' : undefined}\n        onClick={() => toggleSkipInactive(!isSkippingInactive)}\n      />\n\n      <ReplayPlaybackSpeed speedOptions={speedOptions} />\n\n      <Button\n        size=\"xsmall\"\n        title={isFullscreen ? t('Exit full screen') : t('View in full screen')}\n        aria-label={isFullscreen ? t('Exit full screen') : t('View in full screen')}\n        icon={<IconResize size=\"sm\" />}\n        priority={isFullscreen ? 'primary' : undefined}\n        onClick={toggleFullscreen}\n      />\n    </ButtonGrid>\n  );\n};\n\nconst ButtonGrid = styled('div')`\n  display: grid;\n  grid-column-gap: ${space(1)};\n  grid-template-columns: max-content auto max-content max-content max-content;\n  align-items: center;\n`;\n\nexport default ReplayControls;\n","import last from 'lodash/last';\n\nimport {transformCrumbs} from 'sentry/components/events/interfaces/breadcrumbs/utils';\nimport {BreadcrumbType, BreadcrumbTypeNavigation} from 'sentry/types/breadcrumbs';\nimport {EventTag} from 'sentry/types/event';\nimport type ReplayReader from 'sentry/utils/replays/replayReader';\n\nfunction findUrlTag(tags: EventTag[]) {\n  return tags.find(tag => tag.key === 'url');\n}\n\nfunction getCurrentUrl(replay: ReplayReader, currentOffsetMS: number) {\n  const event = replay.getEvent();\n  const crumbs = replay.getRawCrumbs();\n\n  const startTimestampMs = event.startTimestamp * 1000;\n  const currentTimeMs = startTimestampMs + Math.floor(currentOffsetMS);\n\n  const navigationCrumbs = transformCrumbs(crumbs).filter(\n    crumb => crumb.type === BreadcrumbType.NAVIGATION\n  ) as BreadcrumbTypeNavigation[];\n\n  const initialUrl = findUrlTag(event.tags)?.value || '';\n  const origin = initialUrl ? new URL(initialUrl).origin : '';\n\n  const mostRecentNavigation = last(\n    navigationCrumbs.filter(({timestamp}) => +new Date(timestamp || 0) < currentTimeMs)\n  )?.data?.to;\n\n  return mostRecentNavigation ? origin + mostRecentNavigation : initialUrl;\n}\n\nexport default getCurrentUrl;\n","import React from 'react';\nimport styled from '@emotion/styled';\n\nimport TextCopyInput, {\n  StyledCopyButton,\n  StyledInput,\n} from 'sentry/components/forms/textCopyInput';\nimport {useReplayContext} from 'sentry/components/replays/replayContext';\nimport space from 'sentry/styles/space';\nimport getCurrentUrl from 'sentry/utils/replays/getCurrentUrl';\n\nfunction ReplayCurrentUrl() {\n  const {currentTime, replay} = useReplayContext();\n  if (!replay) {\n    return <UrlCopyInput disabled>{''}</UrlCopyInput>;\n  }\n\n  return <UrlCopyInput>{getCurrentUrl(replay, currentTime)}</UrlCopyInput>;\n}\n\nconst UrlCopyInput = styled(TextCopyInput)`\n  ${StyledInput} {\n    background: ${p => p.theme.white};\n    border: none;\n    padding: 0 ${space(0.75)};\n    font-size: ${p => p.theme.fontSizeMedium};\n    border-bottom-left-radius: 0;\n    height: ${space(4)};\n  }\n  ${StyledInput}[disabled] {\n    border: none;\n  }\n\n  ${StyledCopyButton} {\n    border-top: none;\n    border-right: none;\n    border-bottom: none;\n    height: ${space(4)};\n    min-height: ${space(4)};\n  }\n`;\n\nexport default ReplayCurrentUrl;\n","import styled from '@emotion/styled';\n\nimport {IconClock} from 'sentry/icons';\nimport {t} from 'sentry/locale';\nimport space from 'sentry/styles/space';\n\ntype Props = {\n  className?: string;\n};\n\nfunction BufferingOverlay({className}: Props) {\n  return (\n    <Overlay className={className}>\n      <Message>\n        <IconClock size=\"sm\" />\n        {t('Buffering...')}\n      </Message>\n    </Overlay>\n  );\n}\n\n/* Position the badge in the corner */\nconst Overlay = styled('div')`\n  user-select: none;\n  display: grid;\n  place-items: center;\n`;\n\n/* Badge layout and style */\nconst Message = styled('div')`\n  display: grid;\n  grid-template-columns: max-content max-content;\n  gap: ${space(0.75)};\n  place-items: center;\n\n  padding: ${space(3)};\n  background: ${p => p.theme.gray300};\n  border-radius: ${p => p.theme.borderRadius};\n  color: ${p => p.theme.white};\n  z-index: ${p => p.theme.zIndex.initial};\n`;\n\nexport default BufferingOverlay;\n","import styled from '@emotion/styled';\n\nimport Tooltip from 'sentry/components/tooltip';\nimport {IconArrow} from 'sentry/icons';\nimport {t} from 'sentry/locale';\nimport space from 'sentry/styles/space';\n\ntype Props = {\n  speed: number;\n  className?: string;\n};\n\nfunction FastForwardBadge({speed, className}: Props) {\n  return (\n    <Badge className={className}>\n      <FastForwardTooltip title={t('Fast forwarding')}>\n        <IconArrow size=\"sm\" direction=\"right\" />\n        {speed}x\n      </FastForwardTooltip>\n    </Badge>\n  );\n}\n\n/* Position the badge in the corner */\nconst Badge = styled('div')`\n  user-select: none;\n  display: grid;\n  align-items: end;\n  justify-items: start;\n`;\n\n/* Badge layout and style */\nconst FastForwardTooltip = styled(Tooltip)`\n  display: grid;\n  grid-template-columns: max-content max-content;\n  gap: ${space(0.5)};\n  align-items: center;\n\n  background: ${p => p.theme.gray300};\n  color: ${p => p.theme.white};\n  padding: ${space(1.5)} ${space(2)};\n  border-top-right-radius: ${p => p.theme.borderRadius};\n  z-index: ${p => p.theme.zIndex.initial};\n`;\n\nexport default FastForwardBadge;\n","import React, {useCallback, useEffect, useRef, useState} from 'react';\nimport styled from '@emotion/styled';\nimport {useResizeObserver} from '@react-aria/utils';\n\nimport {Panel as _Panel} from 'sentry/components/panels';\nimport {useReplayContext} from 'sentry/components/replays/replayContext';\n\nimport BufferingOverlay from './player/bufferingOverlay';\nimport FastForwardBadge from './player/fastForwardBadge';\n\ninterface Props {\n  className?: string;\n  height?: number;\n}\n\nfunction BasePlayerRoot({className, height = Infinity}: Props) {\n  const {\n    initRoot,\n    dimensions: videoDimensions,\n    fastForwardSpeed,\n    isBuffering,\n  } = useReplayContext();\n\n  const windowEl = useRef<HTMLDivElement>(null);\n  const viewEl = useRef<HTMLDivElement>(null);\n\n  const [windowDimensions, setWindowDimensions] = useState({\n    width: 0,\n    height: 0,\n  });\n\n  // Create the `rrweb` instance which creates an iframe inside `viewEl`\n  useEffect(() => initRoot(viewEl.current), [initRoot]);\n\n  // Read the initial width & height where the player will be inserted, this is\n  // so we can shrink the video into the available space.\n  // If the size of the container changes, we can re-calculate the scaling factor\n  const updateWindowDimensions = useCallback(\n    () =>\n      setWindowDimensions({\n        width: windowEl.current?.clientWidth || 0,\n        height: windowEl.current?.clientHeight || 0,\n      }),\n    [setWindowDimensions]\n  );\n  useResizeObserver({ref: windowEl, onResize: updateWindowDimensions});\n  // If your browser doesn't have ResizeObserver then set the size once.\n  useEffect(() => {\n    if (typeof window.ResizeObserver !== 'undefined') {\n      return;\n    }\n    updateWindowDimensions();\n  }, [updateWindowDimensions]);\n\n  // Update the scale of the view whenever dimensions have changed.\n  useEffect(() => {\n    if (viewEl.current) {\n      const windowHeight = height === Infinity ? windowDimensions.height : height;\n\n      const scale = Math.min(\n        windowDimensions.width / videoDimensions.width,\n        windowHeight / videoDimensions.height,\n        1\n      );\n      if (scale) {\n        viewEl.current.style['transform-origin'] = 'top left';\n        viewEl.current.style.transform = `scale(${scale})`;\n        viewEl.current.style.width = `${videoDimensions.width * scale}px`;\n        viewEl.current.style.height = `${videoDimensions.height * scale}px`;\n      }\n    }\n  }, [windowDimensions, videoDimensions, height]);\n  return (\n    <SizingWindow\n      ref={windowEl}\n      className=\"sr-block\"\n      minHeight={height}\n      isLoaded={videoDimensions.height !== 0}\n    >\n      <div ref={viewEl} className={className} />\n      {fastForwardSpeed ? <PositionedFastForward speed={fastForwardSpeed} /> : null}\n      {isBuffering ? <PositionedBuffering /> : null}\n    </SizingWindow>\n  );\n}\n\n// Center the viewEl inside the windowEl.\n// This is useful when the window is inside a container that has large fixed\n// dimensions, like when in fullscreen mode.\nconst SizingWindow = styled('div')<{isLoaded: boolean; minHeight: number}>`\n  width: 100%;\n  height: 100%;\n  ${p =>\n    p.isLoaded\n      ? ''\n      : p.minHeight !== Infinity\n      ? `min-height: ${p.minHeight}px !important;`\n      : ''}\n\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  position: relative;\n\n  background-color: ${p => p.theme.backgroundSecondary};\n  background-image: repeating-linear-gradient(\n      -145deg,\n      transparent,\n      transparent 8px,\n      ${p => p.theme.backgroundSecondary} 8px,\n      ${p => p.theme.backgroundSecondary} 11px\n    ),\n    repeating-linear-gradient(\n      -45deg,\n      transparent,\n      transparent 15px,\n      ${p => p.theme.gray100} 15px,\n      ${p => p.theme.gray100} 16px\n    );\n`;\n\nconst PositionedFastForward = styled(FastForwardBadge)`\n  position: absolute;\n  left: 0;\n  bottom: 0;\n`;\n\nconst PositionedBuffering = styled(BufferingOverlay)`\n  position: absolute;\n  top: 0;\n  left: 0;\n  right: 0;\n  bottom: 0;\n`;\n\n// Base styles, to make the Replayer instance work\nconst PlayerRoot = styled(BasePlayerRoot)`\n  .replayer-wrapper {\n    background: white;\n    user-select: none;\n  }\n  .replayer-wrapper > .replayer-mouse-tail {\n    position: absolute;\n    pointer-events: none;\n  }\n\n  /* Override default user-agent styles */\n  .replayer-wrapper > iframe {\n    border: none;\n  }\n`;\n\n// Sentry-specific styles for the player.\n// The elements we have to work with are:\n// ```css\n// div.replayer-wrapper {}\n// div.replayer-wrapper > div.replayer-mouse {}\n// div.replayer-wrapper > canvas.replayer-mouse-tail {}\n// div.replayer-wrapper > iframe {}\n// ```\n// The mouse-tail is also configured for color/size in `app/components/replays/replayContext.tsx`\nconst SentryPlayerRoot = styled(PlayerRoot)`\n  .replayer-mouse {\n    position: absolute;\n    width: 32px;\n    height: 32px;\n    transition: left 0.05s linear, top 0.05s linear;\n    background-size: contain;\n    background-repeat: no-repeat;\n    background-image: url('data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTIiIGhlaWdodD0iMTkiIHZpZXdCb3g9IjAgMCAxMiAxOSIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPHBhdGggZD0iTTAgMTZWMEwxMS42IDExLjZINC44TDQuNCAxMS43TDAgMTZaIiBmaWxsPSJ3aGl0ZSIvPgo8cGF0aCBkPSJNOS4xIDE2LjdMNS41IDE4LjJMMC43OTk5OTkgNy4xTDQuNSA1LjZMOS4xIDE2LjdaIiBmaWxsPSJ3aGl0ZSIvPgo8cGF0aCBkPSJNNC42NzQ1MSA4LjYxODUxTDIuODMwMzEgOS4zOTI3MUw1LjkyNzExIDE2Ljc2OTVMNy43NzEzMSAxNS45OTUzTDQuNjc0NTEgOC42MTg1MVoiIGZpbGw9ImJsYWNrIi8+CjxwYXRoIGQ9Ik0xIDIuNFYxMy42TDQgMTAuN0w0LjQgMTAuNkg5LjJMMSAyLjRaIiBmaWxsPSJibGFjayIvPgo8L3N2Zz4K');\n    border-color: transparent;\n  }\n  .replayer-mouse:after {\n    content: '';\n    display: inline-block;\n    width: 32px;\n    height: 32px;\n    background: ${p => p.theme.purple300};\n    border-radius: 100%;\n    transform: translate(-50%, -50%);\n    opacity: 0.3;\n  }\n  .replayer-mouse.active:after {\n    animation: click 0.2s ease-in-out 1;\n  }\n  .replayer-mouse.touch-device {\n    background-image: none;\n    width: 70px;\n    height: 70px;\n    border-radius: 100%;\n    margin-left: -37px;\n    margin-top: -37px;\n    border: 4px solid rgba(73, 80, 246, 0);\n    transition: left 0s linear, top 0s linear, border-color 0.2s ease-in-out;\n  }\n  .replayer-mouse.touch-device.touch-active {\n    border-color: ${p => p.theme.purple200};\n    transition: left 0.25s linear, top 0.25s linear, border-color 0.2s ease-in-out;\n  }\n  .replayer-mouse.touch-device:after {\n    opacity: 0;\n  }\n  .replayer-mouse.touch-device.active:after {\n    animation: touch-click 0.2s ease-in-out 1;\n  }\n  @keyframes click {\n    0% {\n      opacity: 0.3;\n      width: 20px;\n      height: 20px;\n    }\n    50% {\n      opacity: 0.5;\n      width: 10px;\n      height: 10px;\n    }\n  }\n  @keyframes touch-click {\n    0% {\n      opacity: 0;\n      width: 20px;\n      height: 20px;\n    }\n    50% {\n      opacity: 0.5;\n      width: 10px;\n      height: 10px;\n    }\n  }\n`;\n\nexport default SentryPlayerRoot;\n","import React, {useEffect, useRef, useState} from 'react';\nimport styled from '@emotion/styled';\nimport debounce from 'lodash/debounce';\n\nimport {Panel, PanelBody, PanelHeader as _PanelHeader} from 'sentry/components/panels';\nimport HorizontalMouseTracking from 'sentry/components/replays/player/horizontalMouseTracking';\nimport {PlayerScrubber} from 'sentry/components/replays/player/scrubber';\nimport ReplayController from 'sentry/components/replays/replayController';\nimport ReplayCurrentUrl from 'sentry/components/replays/replayCurrentUrl';\nimport ReplayPlayer from 'sentry/components/replays/replayPlayer';\nimport space from 'sentry/styles/space';\n\n// How much to reveal under the player, so people can see the 'pagefold' and\n// know that they can scroll the page.\nconst BOTTOM_REVEAL_PIXELS = 70;\n\nconst SCREEN_HEIGHT_DIVISOR = 2;\n\ntype Props = {\n  isFullscreen: boolean;\n  toggleFullscreen: () => void;\n};\n\nfunction ReplayView({isFullscreen, toggleFullscreen}: Props) {\n  const containerRef = useRef<HTMLDivElement>(null);\n  const playerRef = useRef<HTMLDivElement>(null);\n\n  const [windowInnerHeight, setWindowInnerHeight] = useState(window.innerHeight);\n  const [playerHeight, setPlayerHeight] = useState(0);\n\n  useEffect(() => {\n    const onResize = debounce(() => {\n      setWindowInnerHeight(window.innerHeight);\n    });\n    window.addEventListener('resize', onResize);\n    return () => {\n      window.removeEventListener('resize', onResize);\n    };\n  }, []);\n\n  useEffect(() => {\n    const containerBottom =\n      (containerRef.current?.offsetTop || 0) + (containerRef.current?.offsetHeight || 0);\n    const playerOffsetHeight = playerRef.current?.offsetHeight || 0;\n    const calc =\n      windowInnerHeight - (containerBottom - playerOffsetHeight) - BOTTOM_REVEAL_PIXELS;\n    setPlayerHeight(Math.max(200, calc / SCREEN_HEIGHT_DIVISOR));\n  }, [windowInnerHeight]);\n\n  return (\n    <PanelNoMargin ref={containerRef} isFullscreen={isFullscreen}>\n      <PanelHeader>\n        <ReplayCurrentUrl />\n      </PanelHeader>\n      <PanelHeader ref={playerRef} disablePadding noBorder>\n        <ReplayPlayer height={isFullscreen ? Infinity : playerHeight} />\n      </PanelHeader>\n      <HorizontalMouseTracking>\n        <PlayerScrubber />\n      </HorizontalMouseTracking>\n      <ReplayControllerWrapper>\n        <ReplayController toggleFullscreen={toggleFullscreen} />\n      </ReplayControllerWrapper>\n    </PanelNoMargin>\n  );\n}\n\nconst ReplayControllerWrapper = styled(PanelBody)`\n  padding: ${space(1)};\n`;\n\nconst PanelNoMargin = styled(Panel)<{isFullscreen: boolean}>`\n  margin-bottom: 0;\n\n  ${p =>\n    p.isFullscreen\n      ? `height: 100%;\n      display: grid;\n      grid-template-rows: auto 1fr auto;\n      `\n      : ''}\n`;\n\nconst PanelHeader = styled(_PanelHeader)<{noBorder?: boolean}>`\n  display: block;\n  padding: 0;\n  ${p => (p.noBorder ? 'border-bottom: none;' : '')}\n`;\n\nexport default ReplayView;\n","import type {Crumb} from 'sentry/types/breadcrumbs';\nimport type {Event, EventTransaction} from 'sentry/types/event';\nimport {\n  breadcrumbFactory,\n  replayTimestamps,\n  rrwebEventListFactory,\n  spansFactory,\n} from 'sentry/utils/replays/replayDataUtils';\nimport type {\n  MemorySpanType,\n  RecordingEvent,\n  ReplayCrumb,\n  ReplayError,\n  ReplaySpan,\n} from 'sentry/views/replays/types';\n\ninterface ReplayReaderParams {\n  breadcrumbs: ReplayCrumb[] | undefined;\n  errors: ReplayError[] | undefined;\n\n  /**\n   * The root Replay event, created at the start of the browser session.\n   */\n  event: Event | undefined;\n\n  /**\n   * The captured data from rrweb.\n   * Saved as N attachments that belong to the root Replay event.\n   */\n  rrwebEvents: RecordingEvent[] | undefined;\n\n  spans: ReplaySpan[] | undefined;\n}\n\ntype RequiredNotNull<T> = {\n  [P in keyof T]: NonNullable<T[P]>;\n};\n\nexport default class ReplayReader {\n  static factory({breadcrumbs, event, errors, rrwebEvents, spans}: ReplayReaderParams) {\n    if (!breadcrumbs || !event || !rrwebEvents || !spans || !errors) {\n      return null;\n    }\n\n    return new ReplayReader({breadcrumbs, event, errors, rrwebEvents, spans});\n  }\n\n  private constructor({\n    breadcrumbs,\n    event,\n    errors,\n    rrwebEvents,\n    spans,\n  }: RequiredNotNull<ReplayReaderParams>) {\n    const {startTimestampMS, endTimestampMS} = replayTimestamps(\n      rrwebEvents,\n      breadcrumbs,\n      spans\n    );\n\n    this.spans = spansFactory(spans);\n    this.breadcrumbs = breadcrumbFactory(startTimestampMS, event, errors, breadcrumbs);\n\n    this.rrwebEvents = rrwebEventListFactory(\n      startTimestampMS,\n      endTimestampMS,\n      spans,\n      rrwebEvents\n    );\n\n    this.event = {\n      ...event,\n      startTimestamp: startTimestampMS / 1000,\n      endTimestamp: endTimestampMS / 1000,\n    } as EventTransaction;\n  }\n\n  private event: EventTransaction;\n  private rrwebEvents: RecordingEvent[];\n  private breadcrumbs: Crumb[];\n  private spans: ReplaySpan[];\n\n  getEvent = () => {\n    return this.event;\n  };\n\n  getRRWebEvents = () => {\n    return this.rrwebEvents;\n  };\n\n  getRawCrumbs = () => {\n    return this.breadcrumbs;\n  };\n\n  getRawSpans = () => {\n    return this.spans;\n  };\n\n  isMemorySpan = (span: ReplaySpan): span is MemorySpanType => {\n    return span.op === 'memory';\n  };\n\n  isNotMemorySpan = (span: ReplaySpan) => {\n    return !this.isMemorySpan(span);\n  };\n}\n","import first from 'lodash/first';\n\nimport {transformCrumbs} from 'sentry/components/events/interfaces/breadcrumbs/utils';\nimport {t} from 'sentry/locale';\nimport type {BreadcrumbTypeDefault, Crumb, RawCrumb} from 'sentry/types/breadcrumbs';\nimport {BreadcrumbLevelType, BreadcrumbType} from 'sentry/types/breadcrumbs';\nimport {Event} from 'sentry/types/event';\nimport type {\n  RecordingEvent,\n  ReplayCrumb,\n  ReplayError,\n  ReplaySpan,\n} from 'sentry/views/replays/types';\n\nexport function rrwebEventListFactory(\n  startTimestampMS: number,\n  endTimestampMS: number,\n  rawSpanData: ReplaySpan[],\n  rrwebEvents: RecordingEvent[]\n) {\n  const highlights = rawSpanData\n    .filter(({op, data}) => op === 'largest-contentful-paint' && data?.nodeId > 0)\n    .map(({startTimestamp, data: {nodeId}}) => ({\n      type: 6, // plugin type\n      data: {\n        nodeId,\n        text: 'LCP',\n      },\n      timestamp: Math.floor(startTimestamp * 1000),\n    }));\n\n  const events = ([] as RecordingEvent[])\n    .concat(rrwebEvents)\n    .concat(highlights)\n    .concat({\n      type: 5, // EventType.Custom,\n      timestamp: endTimestampMS,\n      data: {\n        tag: 'replay-end',\n      },\n    });\n  events.sort((a, b) => a.timestamp - b.timestamp);\n\n  const firstRRWebEvent = first(events);\n  if (firstRRWebEvent) {\n    firstRRWebEvent.timestamp = startTimestampMS;\n  }\n\n  return events;\n}\n\nexport function breadcrumbFactory(\n  startTimestamp: number,\n  rootEvent: Event,\n  errors: ReplayError[],\n  rawCrumbs: ReplayCrumb[]\n): Crumb[] {\n  const {tags} = rootEvent;\n  const initBreadcrumb = {\n    type: BreadcrumbType.INIT,\n    timestamp: new Date(startTimestamp).toISOString(),\n    level: BreadcrumbLevelType.INFO,\n    action: 'replay-init',\n    message: t('Start recording'),\n    data: {\n      url: tags.find(tag => tag.key === 'url')?.value,\n    },\n  } as BreadcrumbTypeDefault;\n\n  const errorCrumbs: RawCrumb[] = errors.map(error => ({\n    type: BreadcrumbType.ERROR,\n    level: BreadcrumbLevelType.ERROR,\n    category: 'exception',\n    data: {\n      type: error['error.type'],\n      value: error['error.value'],\n    },\n    timestamp: error.timestamp,\n  }));\n\n  const result = transformCrumbs([\n    initBreadcrumb,\n    ...(rawCrumbs.map(({timestamp, ...crumb}) => ({\n      ...crumb,\n      type: BreadcrumbType.DEFAULT,\n      timestamp: new Date(timestamp * 1000).toISOString(),\n    })) as RawCrumb[]),\n    ...errorCrumbs,\n  ]);\n\n  return result.sort((a, b) => +new Date(a.timestamp || 0) - +new Date(b.timestamp || 0));\n}\n\nexport function spansFactory(spans: ReplaySpan[]) {\n  return spans.sort((a, b) => a.startTimestamp - b.startTimestamp);\n}\n\n/**\n * The original `this._event.startTimestamp` and `this._event.endTimestamp`\n * are the same. It's because the root replay event is re-purposing the\n * `transaction` type, but it is not a real span occuring over time.\n * So we need to figure out the real start and end timestamps based on when\n * first and last bits of data were collected. In milliseconds.\n */\nexport function replayTimestamps(\n  rrwebEvents: RecordingEvent[],\n  rawCrumbs: ReplayCrumb[],\n  rawSpanData: ReplaySpan[]\n) {\n  const rrwebTimestamps = rrwebEvents.map(event => event.timestamp);\n  const breadcrumbTimestamps = (\n    rawCrumbs.map(rawCrumb => rawCrumb.timestamp).filter(Boolean) as number[]\n  ).map(timestamp => +new Date(timestamp * 1000));\n  const spanStartTimestamps = rawSpanData.map(span => span.startTimestamp * 1000);\n  const spanEndTimestamps = rawSpanData.map(span => span.endTimestamp * 1000);\n\n  return {\n    startTimestampMS: Math.min(\n      ...[...rrwebTimestamps, ...breadcrumbTimestamps, ...spanStartTimestamps]\n    ),\n    endTimestampMS: Math.max(\n      ...[...rrwebTimestamps, ...breadcrumbTimestamps, ...spanEndTimestamps]\n    ),\n  };\n}\n","import {useCallback, useEffect, useMemo, useState} from 'react';\nimport * as Sentry from '@sentry/react';\nimport {inflate} from 'pako';\n\nimport {IssueAttachment} from 'sentry/types';\nimport {EventTransaction} from 'sentry/types/event';\nimport ReplayReader from 'sentry/utils/replays/replayReader';\nimport RequestError from 'sentry/utils/requestError/requestError';\nimport useApi from 'sentry/utils/useApi';\nimport type {\n  RecordingEvent,\n  ReplayCrumb,\n  ReplayError,\n  ReplaySpan,\n} from 'sentry/views/replays/types';\n\nimport flattenListOfObjects from '../flattenListOfObjects';\n\nimport useReplayErrors from './useReplayErrors';\n\ntype State = {\n  breadcrumbs: undefined | ReplayCrumb[];\n\n  /**\n   * List of errors that occurred during replay\n   */\n  errors: undefined | ReplayError[];\n\n  /**\n   * The root replay event\n   */\n  event: undefined | EventTransaction;\n\n  /**\n   * If any request returned an error then nothing is being returned\n   */\n  fetchError: undefined | RequestError;\n\n  /**\n   * If a fetch is underway for the requested root reply.\n   * This includes fetched all the sub-resources like attachments and `sentry-replay-event`\n   */\n  fetching: boolean;\n\n  /**\n   * Are errors currently being fetched\n   */\n  isErrorsFetching: boolean;\n\n  /**\n   * The flattened list of rrweb events. These are stored as multiple attachments on the root replay object: the `event` prop.\n   */\n  rrwebEvents: undefined | RecordingEvent[];\n\n  spans: undefined | ReplaySpan[];\n};\n\ntype Options = {\n  /**\n   * The projectSlug and eventId concatenated together\n   */\n  eventSlug: string;\n\n  /**\n   * The organization slug\n   */\n  orgId: string;\n};\n\n// Errors if it is an interface\n// See https://github.com/microsoft/TypeScript/issues/15300\ntype ReplayAttachment = {\n  breadcrumbs: ReplayCrumb[];\n  recording: RecordingEvent[];\n  replaySpans: ReplaySpan[];\n};\n\ninterface Result extends Pick<State, 'fetchError' | 'fetching'> {\n  onRetry: () => void;\n  replay: ReplayReader | null;\n}\n\nconst IS_RRWEB_ATTACHMENT_FILENAME = /rrweb-[0-9]{13}.json/;\n\nfunction isRRWebEventAttachment(attachment: IssueAttachment) {\n  return IS_RRWEB_ATTACHMENT_FILENAME.test(attachment.name);\n}\nexport function mapRRWebAttachments(unsortedReplayAttachments): ReplayAttachment {\n  const replayAttachments: ReplayAttachment = {\n    breadcrumbs: [],\n    replaySpans: [],\n    recording: [],\n  };\n\n  unsortedReplayAttachments.forEach(attachment => {\n    if (attachment.data?.tag === 'performanceSpan') {\n      replayAttachments.replaySpans.push(attachment.data.payload);\n    } else if (attachment?.data?.tag === 'breadcrumb') {\n      replayAttachments.breadcrumbs.push(attachment.data.payload);\n    } else {\n      replayAttachments.recording.push(attachment);\n    }\n  });\n\n  return replayAttachments;\n}\n\nconst INITIAL_STATE: State = Object.freeze({\n  errors: undefined,\n  event: undefined,\n  fetchError: undefined,\n  fetching: true,\n  isErrorsFetching: true,\n  rrwebEvents: undefined,\n  spans: undefined,\n  breadcrumbs: undefined,\n});\n\n/**\n * A react hook to load core replay data over the network.\n *\n * Core replay data includes:\n * 1. The root replay EventTransaction object\n *    - This includes `startTimestamp` and `tags` data\n * 2. Breadcrumb and Span data from all the related Event objects\n *    - Data is merged for consumption\n * 3. RRWeb payloads for the replayer video stream\n *    - TODO(replay): incrementally load the stream to speedup pageload\n *\n * This function should stay focused on loading data over the network.\n * Front-end processing, filtering and re-mixing of the different data streams\n * must be delegated to the `ReplayReader` class.\n *\n * @param {orgId, eventSlug} Where to find the root replay event\n * @returns An object representing a unified result of the network reqeusts. Either a single `ReplayReader` data object or fetch errors.\n */\nfunction useReplayData({eventSlug, orgId}: Options): Result {\n  const [projectId, eventId] = eventSlug.split(':');\n\n  const api = useApi();\n  const [state, setState] = useState<State>(INITIAL_STATE);\n\n  const fetchEvent = useCallback(() => {\n    return api.requestPromise(\n      `/organizations/${orgId}/events/${eventSlug}/`\n    ) as Promise<EventTransaction>;\n  }, [api, orgId, eventSlug]);\n\n  const fetchRRWebEvents = useCallback(async () => {\n    const attachmentIds = (await api.requestPromise(\n      `/projects/${orgId}/${projectId}/events/${eventId}/attachments/`\n    )) as IssueAttachment[];\n    const rrwebAttachmentIds = attachmentIds.filter(isRRWebEventAttachment);\n    const attachments = await Promise.all(\n      rrwebAttachmentIds.map(async attachment => {\n        const response = await api.requestPromise(\n          `/api/0/projects/${orgId}/${projectId}/events/${eventId}/attachments/${attachment.id}/?download`,\n          {\n            includeAllArgs: true,\n          }\n        );\n\n        // for non-compressed events, parse and return\n        try {\n          return JSON.parse(response[0]) as ReplayAttachment;\n        } catch (error) {\n          // swallow exception.. if we can't parse it, it's going to be compressed\n        }\n\n        // for non-compressed events, parse and return\n        try {\n          // for compressed events, inflate the blob and map the events\n          const responseBlob = await response[2]?.rawResponse.blob();\n          const responseArray = (await responseBlob?.arrayBuffer()) as Uint8Array;\n          const parsedPayload = JSON.parse(inflate(responseArray, {to: 'string'}));\n          const replayAttachments = mapRRWebAttachments(parsedPayload);\n          return replayAttachments;\n        } catch (error) {\n          return {};\n        }\n      })\n    );\n\n    // ReplayAttachment[] => ReplayAttachment (merge each key of ReplayAttachment)\n    return flattenListOfObjects(attachments);\n  }, [api, eventId, orgId, projectId]);\n\n  const {isLoading: isErrorsFetching, data: errors} = useReplayErrors({\n    replayId: eventId,\n  });\n\n  useEffect(() => {\n    if (!isErrorsFetching) {\n      setState(prevState => ({\n        ...prevState,\n        fetching: prevState.fetching || isErrorsFetching,\n        isErrorsFetching,\n        errors,\n      }));\n    }\n  }, [isErrorsFetching, errors]);\n\n  const loadEvents = useCallback(async () => {\n    setState(INITIAL_STATE);\n\n    try {\n      const [event, attachments] = await Promise.all([fetchEvent(), fetchRRWebEvents()]);\n\n      setState(prev => ({\n        ...prev,\n        event,\n        fetchError: undefined,\n        fetching: prev.isErrorsFetching || false,\n        rrwebEvents: attachments.recording,\n        spans: attachments.replaySpans,\n        breadcrumbs: attachments.breadcrumbs,\n      }));\n    } catch (error) {\n      Sentry.captureException(error);\n      setState({\n        ...INITIAL_STATE,\n        fetchError: error,\n        fetching: false,\n      });\n    }\n  }, [fetchEvent, fetchRRWebEvents]);\n\n  useEffect(() => {\n    loadEvents();\n  }, [loadEvents]);\n\n  const replay = useMemo(() => {\n    return ReplayReader.factory({\n      event: state.event,\n      errors: state.errors,\n      rrwebEvents: state.rrwebEvents,\n      breadcrumbs: state.breadcrumbs,\n      spans: state.spans,\n    });\n  }, [state.event, state.rrwebEvents, state.breadcrumbs, state.spans, state.errors]);\n\n  return {\n    fetchError: state.fetchError,\n    fetching: state.fetching,\n    onRetry: loadEvents,\n    replay,\n  };\n}\n\nexport default useReplayData;\n","import {Fragment} from 'react';\nimport styled from '@emotion/styled';\n\nimport space from 'sentry/styles/space';\n\n/**\n * Very similar to app/components/keyValueTable.tsx\n * TODO(replay): move into app/components\n */\n\ntype Props = {\n  keyName: React.ReactNode;\n  value: React.ReactNode;\n};\n\nexport const KeyMetrics = styled('dl')`\n  margin: 0; /* Reset default dl styles */\n\n  display: grid;\n  grid-template-rows: auto auto;\n  grid-auto-columns: 1fr;\n  grid-auto-flow: column;\n  gap: ${space(0.5)} ${space(2)};\n\n  text-align: right;\n`;\n\nexport const KeyMetricData = ({keyName, value}: Props) => {\n  return (\n    <Fragment>\n      <Key>{keyName}</Key>\n      <Value>{value}</Value>\n    </Fragment>\n  );\n};\n\nconst Key = styled('dt')`\n  color: ${p => p.theme.subText};\n  font-size: 14px;\n  font-weight: bold;\n`;\n\nconst Value = styled('dt')`\n  color: ${p => p.theme.textColor};\n  font-weight: normal;\n`;\n","import React, {useMemo} from 'react';\nimport styled from '@emotion/styled';\n\nimport Breadcrumbs from 'sentry/components/breadcrumbs';\nimport Button from 'sentry/components/button';\nimport Clipboard from 'sentry/components/clipboard';\nimport Duration from 'sentry/components/duration';\nimport FeatureBadge from 'sentry/components/featureBadge';\nimport {FeatureFeedback} from 'sentry/components/featureFeedback';\nimport UserBadge, {StyledName} from 'sentry/components/idBadge/userBadge';\nimport * as Layout from 'sentry/components/layouts/thirds';\nimport Placeholder from 'sentry/components/placeholder';\nimport {KeyMetricData, KeyMetrics} from 'sentry/components/replays/keyMetrics';\nimport {useReplayContext} from 'sentry/components/replays/replayContext';\nimport SentryDocumentTitle from 'sentry/components/sentryDocumentTitle';\nimport TimeSince from 'sentry/components/timeSince';\nimport {IconLink} from 'sentry/icons';\nimport {t} from 'sentry/locale';\nimport space from 'sentry/styles/space';\nimport {Crumb} from 'sentry/types/breadcrumbs';\nimport {Event} from 'sentry/types/event';\nimport getUrlPathname from 'sentry/utils/getUrlPathname';\nimport createUrlToShare from 'sentry/utils/replays/createUrlToShare';\n\ntype Props = {\n  children: React.ReactNode;\n  orgId: string;\n  crumbs?: Crumb[];\n  event?: Event;\n};\n\nfunction DetailLayout({children, event, orgId, crumbs}: Props) {\n  const {currentTime} = useReplayContext();\n  const title = event ? `${event.id} - Replays - ${orgId}` : `Replays - ${orgId}`;\n\n  const urlToShare = useMemo(() => {\n    return createUrlToShare(currentTime);\n  }, [currentTime]);\n\n  return (\n    <SentryDocumentTitle title={title}>\n      <React.Fragment>\n        <Layout.Header>\n          <Layout.HeaderContent>\n            <Breadcrumbs\n              crumbs={[\n                {\n                  to: `/organizations/${orgId}/replays/`,\n                  label: t('Replays'),\n                },\n                {\n                  label: (\n                    <React.Fragment>\n                      {t('Replay Details')}\n                      <FeatureBadge type=\"alpha\" />\n                    </React.Fragment>\n                  ),\n                },\n              ]}\n            />\n          </Layout.HeaderContent>\n          <ButtonActionsWrapper>\n            <Clipboard hideUnsupported value={urlToShare}>\n              <Button icon={<IconLink />}>{t('Share')}</Button>\n            </Clipboard>\n            <FeatureFeedback featureName=\"replay\" />\n          </ButtonActionsWrapper>\n          <React.Fragment>\n            <Layout.HeaderContent>\n              <EventHeader event={event} />\n            </Layout.HeaderContent>\n            <MetaDataColumn>\n              <EventMetaData event={event} crumbs={crumbs} />\n            </MetaDataColumn>\n          </React.Fragment>\n        </Layout.Header>\n        {children}\n      </React.Fragment>\n    </SentryDocumentTitle>\n  );\n}\n\nconst HeaderPlaceholder = styled(function HeaderPlaceholder(\n  props: React.ComponentProps<typeof Placeholder>\n) {\n  return <Placeholder width=\"100%\" height=\"19px\" {...props} />;\n})`\n  background-color: ${p => p.theme.background};\n`;\n\nfunction EventHeader({event}: Pick<Props, 'event'>) {\n  if (!event) {\n    return <HeaderPlaceholder width=\"500px\" height=\"48px\" />;\n  }\n\n  const urlTag = event.tags.find(({key}) => key === 'url');\n  const pathname = getUrlPathname(urlTag?.value ?? '') ?? '';\n\n  return (\n    <BigNameUserBadge\n      avatarSize={32}\n      user={{\n        username: event.user?.username ?? '',\n        id: event.user?.id ?? '',\n        ip_address: event.user?.ip_address ?? '',\n        name: event.user?.name ?? '',\n        email: event.user?.email ?? '',\n      }}\n      // this is the subheading for the avatar, so displayEmail in this case is a misnomer\n      displayEmail={pathname}\n    />\n  );\n}\n\nconst MetaDataColumn = styled(Layout.HeaderActions)`\n  width: 325px;\n`;\n\nfunction EventMetaData({event, crumbs}: Pick<Props, 'event' | 'crumbs'>) {\n  const {duration} = useReplayContext();\n\n  const errors = crumbs?.filter(crumb => crumb.type === 'error').length;\n\n  return (\n    <KeyMetrics>\n      <KeyMetricData\n        keyName={t('Timestamp')}\n        value={event ? <TimeSince date={event.dateReceived} /> : <HeaderPlaceholder />}\n      />\n      <KeyMetricData\n        keyName={t('Duration')}\n        value={\n          duration !== undefined ? (\n            <Duration\n              seconds={Math.floor(msToSec(duration || 0)) || 1}\n              abbreviation\n              exact\n            />\n          ) : (\n            <HeaderPlaceholder />\n          )\n        }\n      />\n      <KeyMetricData keyName={t('Errors')} value={errors ?? <HeaderPlaceholder />} />\n    </KeyMetrics>\n  );\n}\n\nfunction msToSec(ms: number) {\n  return ms / 1000;\n}\n\nconst BigNameUserBadge = styled(UserBadge)`\n  align-items: flex-start;\n\n  ${StyledName} {\n    font-size: 26px;\n  }\n`;\n\n// TODO(replay); This could make a lot of sense to put inside HeaderActions by default\nconst ButtonActionsWrapper = styled(Layout.HeaderActions)`\n  display: grid;\n  grid-template-columns: repeat(2, max-content);\n  justify-content: flex-end;\n  gap: ${space(1)};\n`;\n\nexport default DetailLayout;\n","function createUrlToShare(currentTimeMs: number) {\n  const url = new URL(window.location.href);\n  const currentTimeSec = Math.floor(msToSec(currentTimeMs) || 0);\n  if (currentTimeSec > 0) {\n    url.searchParams.set('t', currentTimeSec.toString());\n  }\n  return url.toString();\n}\n\nfunction msToSec(ms: number) {\n  return ms / 1000;\n}\n\nexport default createUrlToShare;\n","import type {eventWithTime} from 'rrweb/typings/types';\n\nimport type {RawCrumb} from 'sentry/types/breadcrumbs';\n\nexport type Replay = {\n  eventID: string;\n  id: string;\n  project: string;\n  timestamp: string;\n  url: string;\n  'user.display': string;\n  'user.email': string;\n  'user.id': string;\n  'user.ip_address': string;\n  'user.name': string;\n  'user.username': string;\n};\n\nexport enum ReplayTabs {\n  CONSOLE = 'console',\n  NETWORK = 'network',\n  TRACE = 'trace',\n  ISSUES = 'issues',\n  TAGS = 'tags',\n  MEMORY = 'memory',\n}\n\nexport function isReplayTab(tab: string): tab is ReplayTabs {\n  return tab.toUpperCase() in ReplayTabs;\n}\n\n/**\n * Highlight Replay Plugin types\n */\nexport interface Highlight {\n  nodeId: number;\n  text: string;\n  color?: string;\n}\n\nexport type RecordingEvent = eventWithTime;\n\nexport interface ReplaySpan<T = Record<string, any>> {\n  data: T;\n  endTimestamp: number;\n  op: string;\n  startTimestamp: number;\n  description?: string;\n}\n\nexport type MemorySpanType = ReplaySpan<{\n  memory: {\n    jsHeapSizeLimit: number;\n    totalJSHeapSize: number;\n    usedJSHeapSize: number;\n  };\n}>;\n\nexport type ReplayCrumb = RawCrumb & {\n  /**\n   * Replay crumbs are unprocessed and come in as unix timestamp in seconds\n   */\n  timestamp: number;\n};\n\n/**\n * This is a result of a custom discover query\n */\nexport interface ReplayError {\n  ['error.type']: string;\n  ['error.value']: string;\n  id: string;\n  ['issue.id']: number;\n  ['project.name']: string;\n  timestamp: string;\n}\n","import {isReplayTab, ReplayTabs} from 'sentry/views/replays/types';\n\nconst DEFAULT_TAB = ReplayTabs.CONSOLE;\n\nfunction useActiveTabFromLocation() {\n  const hash = location.hash.replace(/^#/, '');\n  const tabFromHash = isReplayTab(hash) ? hash : DEFAULT_TAB;\n\n  return tabFromHash;\n}\n\nexport default useActiveTabFromLocation;\n","import {Fragment} from 'react';\nimport styled from '@emotion/styled';\nimport {sprintf, vsprintf} from 'sprintf-js';\n\nimport DateTime from 'sentry/components/dateTime';\nimport ErrorBoundary from 'sentry/components/errorBoundary';\nimport AnnotatedText from 'sentry/components/events/meta/annotatedText';\nimport {getMeta} from 'sentry/components/events/meta/metaProxy';\nimport {useReplayContext} from 'sentry/components/replays/replayContext';\nimport {relativeTimeInMs, showPlayerTime} from 'sentry/components/replays/utils';\nimport Tooltip from 'sentry/components/tooltip';\nimport {IconClose, IconWarning} from 'sentry/icons';\nimport space from 'sentry/styles/space';\nimport {BreadcrumbTypeDefault} from 'sentry/types/breadcrumbs';\n\ninterface MessageFormatterProps {\n  breadcrumb: BreadcrumbTypeDefault;\n}\n\n/**\n * Attempt to stringify\n */\nfunction renderString(arg: string | number | boolean | Object) {\n  if (typeof arg !== 'object') {\n    return arg;\n  }\n\n  try {\n    return JSON.stringify(arg);\n  } catch {\n    return arg.toString();\n  }\n}\n\n/**\n * Attempt to emulate the browser console as much as possible\n */\nfunction MessageFormatter({breadcrumb}: MessageFormatterProps) {\n  // Browser's console formatter only works on the first arg\n  const [message, ...args] = breadcrumb.data?.arguments;\n\n  const isMessageString = typeof message === 'string';\n\n  const placeholders = isMessageString\n    ? sprintf.parse(message).filter(parsed => Array.isArray(parsed))\n    : [];\n\n  // TODO `%c` is console specific, it applies colors to messages\n  // for now we are stripping it as this is potentially risky to implement due to xss\n  const consoleColorPlaceholderIndexes = placeholders\n    .filter(([placeholder]) => placeholder === '%c')\n    .map((_, i) => i);\n\n  // Retrieve message formatting args\n  const messageArgs = args.slice(0, placeholders.length);\n\n  // Filter out args that were for %c\n  for (const colorIndex of consoleColorPlaceholderIndexes) {\n    messageArgs.splice(colorIndex, 1);\n  }\n\n  // Attempt to stringify the rest of the args\n  const restArgs = args.slice(placeholders.length).map(renderString);\n\n  const formattedMessage = isMessageString\n    ? vsprintf(message.replaceAll('%c', ''), messageArgs)\n    : renderString(message);\n\n  // TODO(replays): Add better support for AnnotatedText (e.g. we use message\n  // args from breadcrumb.data.arguments and not breadcrumb.message directly)\n  return (\n    <AnnotatedText\n      meta={getMeta(breadcrumb, 'message')}\n      value={[formattedMessage, ...restArgs].join(' ')}\n    />\n  );\n}\n\ninterface ConsoleMessageProps extends MessageFormatterProps {\n  isActive: boolean;\n  isLast: boolean;\n  startTimestamp: number;\n}\nfunction ConsoleMessage({\n  breadcrumb,\n  isActive = false,\n  isLast,\n  startTimestamp = 0,\n}: ConsoleMessageProps) {\n  const ICONS = {\n    error: <IconClose isCircled size=\"xs\" />,\n    warning: <IconWarning size=\"xs\" />,\n  };\n\n  const {setCurrentTime, setCurrentHoverTime} = useReplayContext();\n\n  const diff = relativeTimeInMs(breadcrumb.timestamp || '', startTimestamp);\n  const handleOnClick = () => setCurrentTime(diff);\n  const handleOnMouseOver = () => setCurrentHoverTime(diff);\n  const handleOnMouseOut = () => setCurrentHoverTime(undefined);\n\n  return (\n    <Fragment>\n      <Icon isLast={isLast} level={breadcrumb.level} isActive={isActive}>\n        {ICONS[breadcrumb.level]}\n      </Icon>\n      <Message isLast={isLast} level={breadcrumb.level}>\n        <ErrorBoundary mini>\n          <MessageFormatter breadcrumb={breadcrumb} />\n        </ErrorBoundary>\n      </Message>\n      <ConsoleTimestamp isLast={isLast} level={breadcrumb.level}>\n        <Tooltip title={<DateTime date={breadcrumb.timestamp} seconds />}>\n          <div\n            onClick={handleOnClick}\n            onMouseOver={handleOnMouseOver}\n            onMouseOut={handleOnMouseOut}\n          >\n            {showPlayerTime(breadcrumb.timestamp || '', startTimestamp)}\n          </div>\n        </Tooltip>\n      </ConsoleTimestamp>\n    </Fragment>\n  );\n}\n\nconst Common = styled('div')<{isLast: boolean; level: string}>`\n  background-color: ${p =>\n    ['warning', 'error'].includes(p.level)\n      ? p.theme.alert[p.level].backgroundLight\n      : 'inherit'};\n  color: ${p =>\n    ['warning', 'error'].includes(p.level)\n      ? p.theme.alert[p.level].iconHoverColor\n      : 'inherit'};\n  ${p => (!p.isLast ? `border-bottom: 1px solid ${p.theme.innerBorder}` : '')};\n`;\n\nconst ConsoleTimestamp = styled(Common)<{isLast: boolean; level: string}>`\n  padding: ${space(0.25)} ${space(1)};\n  cursor: pointer;\n`;\n\nconst Icon = styled(Common)<{isActive: boolean}>`\n  padding: ${space(0.5)} ${space(1)};\n  border-left: 4px solid ${p => (p.isActive ? p.theme.focus : 'transparent')};\n`;\nconst Message = styled(Common)`\n  padding: ${space(0.25)} 0;\n  white-space: pre-wrap;\n  word-break: break-word;\n`;\n\nexport default ConsoleMessage;\n","import {Fragment, useMemo, useState} from 'react';\nimport styled from '@emotion/styled';\nimport debounce from 'lodash/debounce';\n\nimport CompactSelect from 'sentry/components/forms/compactSelect';\nimport {Panel} from 'sentry/components/panels';\nimport {useReplayContext} from 'sentry/components/replays/replayContext';\nimport {relativeTimeInMs, showPlayerTime} from 'sentry/components/replays/utils';\nimport SearchBar from 'sentry/components/searchBar';\nimport {t} from 'sentry/locale';\nimport space from 'sentry/styles/space';\nimport type {BreadcrumbLevelType, BreadcrumbTypeDefault} from 'sentry/types/breadcrumbs';\nimport EmptyMessage from 'sentry/views/settings/components/emptyMessage';\n\nimport ConsoleMessage from './consoleMessage';\nimport {filterBreadcrumbs} from './utils';\n\ninterface Props {\n  breadcrumbs: BreadcrumbTypeDefault[];\n  startTimestamp: number;\n}\n\nconst getDistinctLogLevels = (breadcrumbs: BreadcrumbTypeDefault[]) =>\n  Array.from(new Set<string>(breadcrumbs.map(breadcrumb => breadcrumb.level)));\n\nfunction Console({breadcrumbs, startTimestamp = 0}: Props) {\n  const {currentHoverTime} = useReplayContext();\n  const [searchTerm, setSearchTerm] = useState('');\n  const [logLevel, setLogLevel] = useState<BreadcrumbLevelType[]>([]);\n  const handleSearch = debounce(query => setSearchTerm(query), 150);\n\n  const filteredBreadcrumbs = useMemo(\n    () => filterBreadcrumbs(breadcrumbs, searchTerm, logLevel),\n    [logLevel, searchTerm, breadcrumbs]\n  );\n\n  const activeConsoleBounds = useMemo(() => {\n    if (filteredBreadcrumbs.length <= 0 || currentHoverTime === undefined) {\n      return [-1, -1];\n    }\n\n    let indexUpperBound = 0;\n    const finalBreadCrumbIndex = filteredBreadcrumbs.length - 1;\n    const finalBreadcrumbTimestamp =\n      filteredBreadcrumbs[finalBreadCrumbIndex].timestamp || '';\n\n    if (currentHoverTime >= relativeTimeInMs(finalBreadcrumbTimestamp, startTimestamp)) {\n      indexUpperBound = finalBreadCrumbIndex;\n    } else {\n      indexUpperBound =\n        filteredBreadcrumbs.findIndex(\n          breadcrumb =>\n            relativeTimeInMs(breadcrumb.timestamp || '', startTimestamp) >=\n            (currentHoverTime || 0)\n        ) - 1;\n    }\n\n    const activeMessageBoundary = showPlayerTime(\n      filteredBreadcrumbs[indexUpperBound]?.timestamp || '',\n      startTimestamp\n    );\n\n    const indexLowerBound = filteredBreadcrumbs.findIndex(\n      breadcrumb =>\n        showPlayerTime(breadcrumb.timestamp || '', startTimestamp) ===\n        activeMessageBoundary\n    );\n\n    return [indexLowerBound, indexUpperBound];\n  }, [currentHoverTime, filteredBreadcrumbs, startTimestamp]);\n\n  return (\n    <Fragment>\n      <ConsoleFilters>\n        <CompactSelect\n          triggerProps={{\n            prefix: t('Log Level'),\n          }}\n          multiple\n          options={getDistinctLogLevels(breadcrumbs).map(breadcrumbLogLevel => ({\n            value: breadcrumbLogLevel,\n            label: breadcrumbLogLevel,\n          }))}\n          onChange={selections =>\n            setLogLevel(selections.map(selection => selection.value))\n          }\n        />\n        <SearchBar onChange={handleSearch} placeholder={t('Search console logs...')} />\n      </ConsoleFilters>\n\n      {filteredBreadcrumbs.length > 0 ? (\n        <ConsoleTable>\n          {filteredBreadcrumbs.map((breadcrumb, i) => {\n            return (\n              <ConsoleMessage\n                isActive={i >= activeConsoleBounds[0] && i <= activeConsoleBounds[1]}\n                startTimestamp={startTimestamp}\n                key={i}\n                isLast={i === breadcrumbs.length - 1}\n                breadcrumb={breadcrumb}\n              />\n            );\n          })}\n        </ConsoleTable>\n      ) : (\n        <StyledEmptyMessage title={t('No results found.')} />\n      )}\n    </Fragment>\n  );\n}\n\nconst ConsoleFilters = styled('div')`\n  display: grid;\n  gap: ${space(1)};\n  grid-template-columns: max-content 1fr;\n  margin-bottom: ${space(1)};\n\n  @media (max-width: ${p => p.theme.breakpoints.small}) {\n    margin-top: ${space(1)};\n  }\n`;\n\nconst StyledEmptyMessage = styled(EmptyMessage)`\n  align-items: center;\n`;\n\nconst ConsoleTable = styled(Panel)`\n  display: grid;\n  grid-template-columns: max-content auto max-content;\n  width: 100%;\n  font-family: ${p => p.theme.text.familyMono};\n  font-size: 0.8em;\n`;\n\nexport default Console;\n","import {BreadcrumbTypeDefault} from 'sentry/types/breadcrumbs';\n\nexport const filterBreadcrumbs = (\n  breadcrumbs: BreadcrumbTypeDefault[],\n  searchTerm: string,\n  logLevel: Array<string>\n) => {\n  if (!searchTerm && logLevel.length === 0) {\n    return breadcrumbs;\n  }\n  return breadcrumbs.filter(breadcrumb => {\n    const normalizedSearchTerm = searchTerm.toLowerCase();\n    const doesMatch = JSON.stringify(breadcrumb.data)\n      .toLowerCase()\n      .includes(normalizedSearchTerm);\n    if (logLevel.length > 0) {\n      return doesMatch && logLevel.includes(breadcrumb.level);\n    }\n    return doesMatch;\n  });\n};\n","import {Fragment, useCallback, useEffect, useState} from 'react';\nimport styled from '@emotion/styled';\nimport keyBy from 'lodash/keyBy';\n\nimport EventOrGroupExtraDetails from 'sentry/components/eventOrGroupExtraDetails';\nimport EventOrGroupHeader from 'sentry/components/eventOrGroupHeader';\nimport {PanelTable} from 'sentry/components/panels';\nimport Placeholder from 'sentry/components/placeholder';\nimport {DEFAULT_STREAM_GROUP_STATS_PERIOD} from 'sentry/components/stream/group';\nimport GroupChart from 'sentry/components/stream/groupChart';\nimport {t} from 'sentry/locale';\nimport space from 'sentry/styles/space';\nimport {Group, NewQuery} from 'sentry/types';\nimport DiscoverQuery from 'sentry/utils/discover/discoverQuery';\nimport EventView from 'sentry/utils/discover/eventView';\nimport theme from 'sentry/utils/theme';\nimport useApi from 'sentry/utils/useApi';\nimport {useLocation} from 'sentry/utils/useLocation';\nimport useMedia from 'sentry/utils/useMedia';\nimport useOrganization from 'sentry/utils/useOrganization';\nimport usePageFilters from 'sentry/utils/usePageFilters';\n\ntype Props = {\n  projectId: string;\n  replayId: string;\n};\nconst columns = [t('Issue'), t('Graph'), t('Events'), t('Users')];\n\nfunction IssueList(props: Props) {\n  const organization = useOrganization();\n  const location = useLocation();\n  const api = useApi();\n  const {selection} = usePageFilters();\n  const isScreenLarge = useMedia(`(min-width: ${theme.breakpoints.large})`);\n\n  const [issuesById, setIssuesById] = useState<Record<string, Group>>({});\n  const [issueStatsById, setIssuesStatsById] = useState<Record<string, Group>>({});\n\n  const getEventView = () => {\n    const eventQueryParams: NewQuery = {\n      id: '',\n      name: '',\n      version: 2,\n      fields: ['count(issue)', 'issue'],\n      environment: selection.environments,\n      projects: selection.projects,\n      query: `replayId:${props.replayId} AND event.type:error`,\n    };\n    const result = EventView.fromNewQueryWithLocation(eventQueryParams, location);\n    return result;\n  };\n\n  const fetchIssueData = useCallback(async () => {\n    let issues;\n    try {\n      issues = await api.requestPromise(`/organizations/${organization.slug}/issues/`, {\n        includeAllArgs: true,\n        query: {\n          project: props.projectId,\n          query: `replayId:${props.replayId}`,\n        },\n      });\n\n      setIssuesById(keyBy(issues[0], 'id'));\n    } catch (error) {\n      setIssuesById({});\n      return;\n    }\n\n    try {\n      const issuesResults = await api.requestPromise(\n        `/organizations/${organization.slug}/issues-stats/`,\n        {\n          includeAllArgs: true,\n          query: {\n            project: props.projectId,\n            groups: issues[0]?.map(issue => issue.id),\n            query: `replayId:${props.replayId}`,\n          },\n        }\n      );\n      setIssuesStatsById(keyBy(issuesResults[0], 'id'));\n    } catch (error) {\n      setIssuesStatsById({});\n    }\n  }, [api, organization.slug, props.replayId, props.projectId]);\n\n  useEffect(() => {\n    fetchIssueData();\n  }, [fetchIssueData]);\n\n  const renderTableRow = error => {\n    const matchedIssue = issuesById[error['issue.id']];\n    const matchedIssueStats = issueStatsById[error['issue.id']];\n\n    if (!matchedIssue) {\n      return null;\n    }\n    return (\n      <Fragment key={matchedIssue.id}>\n        <IssueDetailsWrapper>\n          <EventOrGroupHeader\n            includeLink\n            data={matchedIssue}\n            organization={organization}\n            size=\"normal\"\n          />\n          <EventOrGroupExtraDetails\n            data={{\n              ...matchedIssue,\n              firstSeen: matchedIssueStats?.firstSeen || '',\n              lastSeen: matchedIssueStats?.lastSeen || '',\n            }}\n          />\n        </IssueDetailsWrapper>\n        {isScreenLarge && (\n          <ChartWrapper>\n            {matchedIssueStats?.stats ? (\n              <GroupChart\n                statsPeriod={DEFAULT_STREAM_GROUP_STATS_PERIOD}\n                data={matchedIssueStats}\n                showSecondaryPoints\n                showMarkLine\n              />\n            ) : (\n              <Placeholder height=\"44px\" />\n            )}\n          </ChartWrapper>\n        )}\n\n        <Item>\n          {matchedIssueStats?.count ? (\n            matchedIssueStats?.count\n          ) : (\n            <Placeholder height=\"24px\" />\n          )}\n        </Item>\n\n        <Item>\n          {matchedIssueStats?.userCount ? (\n            matchedIssueStats?.userCount\n          ) : (\n            <Placeholder height=\"24px\" />\n          )}\n        </Item>\n      </Fragment>\n    );\n  };\n\n  return (\n    <DiscoverQuery\n      eventView={getEventView()}\n      location={location}\n      orgSlug={organization.slug}\n      limit={15}\n    >\n      {data => {\n        return (\n          <StyledPanelTable\n            isEmpty={data.tableData?.data.length === 0}\n            emptyMessage={t('No related Issues found.')}\n            isLoading={data.isLoading}\n            headers={\n              isScreenLarge ? columns : columns.filter(column => column !== t('Graph'))\n            }\n          >\n            {data.tableData?.data.map(renderTableRow) || null}\n          </StyledPanelTable>\n        );\n      }}\n    </DiscoverQuery>\n  );\n}\n\nconst ChartWrapper = styled('div')`\n  width: 200px;\n  margin-left: -${space(2)};\n  padding-left: ${space(0)};\n`;\n\nconst Item = styled('div')`\n  display: flex;\n  align-items: center;\n`;\n\nconst IssueDetailsWrapper = styled('div')`\n  overflow: hidden;\n  line-height: normal;\n`;\n\nconst StyledPanelTable = styled(PanelTable)`\n  /* overflow: visible allows the tooltip to be completely shown */\n  overflow: visible;\n  grid-template-columns: minmax(1fr, max-content) repeat(3, max-content);\n\n  @media (max-width: ${p => p.theme.breakpoints.large}) {\n    grid-template-columns: minmax(0, 1fr) repeat(2, max-content);\n  }\n`;\n\nexport default IssueList;\n","import {forwardRef, memo, useEffect, useRef} from 'react';\nimport {useTheme} from '@emotion/react';\nimport styled from '@emotion/styled';\nimport moment from 'moment';\n\nimport {AreaChart, AreaChartProps} from 'sentry/components/charts/areaChart';\nimport Grid from 'sentry/components/charts/components/grid';\nimport Tooltip from 'sentry/components/charts/components/tooltip';\nimport XAxis from 'sentry/components/charts/components/xAxis';\nimport YAxis from 'sentry/components/charts/components/yAxis';\nimport EmptyStateWarning from 'sentry/components/emptyStateWarning';\nimport {showPlayerTime} from 'sentry/components/replays/utils';\nimport {t} from 'sentry/locale';\nimport space from 'sentry/styles/space';\nimport {ReactEchartsRef, Series} from 'sentry/types/echarts';\nimport {formatBytesBase2} from 'sentry/utils';\nimport {getFormattedDate} from 'sentry/utils/dates';\nimport type {MemorySpanType} from 'sentry/views/replays/types';\n\ninterface Props {\n  memorySpans: MemorySpanType[];\n  setCurrentHoverTime: (time: undefined | number) => void;\n  setCurrentTime: (time: number) => void;\n  startTimestamp: number | undefined;\n}\n\ninterface MemoryChartProps extends Props {\n  forwardedRef: React.Ref<ReactEchartsRef>;\n}\n\nconst formatTimestamp = timestamp =>\n  getFormattedDate(timestamp * 1000, 'MMM D, YYYY hh:mm:ss A z', {local: false});\n\nfunction MemoryChart({\n  forwardedRef,\n  memorySpans,\n  startTimestamp = 0,\n  setCurrentTime,\n  setCurrentHoverTime,\n}: MemoryChartProps) {\n  const theme = useTheme();\n\n  if (memorySpans.length <= 0) {\n    return (\n      <EmptyStateWarning withIcon={false} small>\n        {t('No memory metrics found')}\n      </EmptyStateWarning>\n    );\n  }\n\n  const chartOptions: Omit<AreaChartProps, 'series'> = {\n    grid: Grid({\n      // makes space for the title\n      top: '40px',\n      left: space(1),\n      right: space(1),\n    }),\n    tooltip: Tooltip({\n      trigger: 'axis',\n      formatter: values => {\n        const seriesTooltips = values.map(\n          value => `\n            <div>\n              <span className=\"tooltip-label\">${value.marker}<strong>${\n            value.seriesName\n          }</strong></span>\n          ${formatBytesBase2(value.data[1])}\n            </div>\n          `\n        );\n        // showPlayerTime expects a timestamp so we take the captured time in seconds and convert it to a UTC timestamp\n        const template = [\n          '<div class=\"tooltip-series\">',\n          ...seriesTooltips,\n          '</div>',\n          `<div class=\"tooltip-date\" style=\"display: inline-block; width: max-content;\">${t(\n            'Span Time'\n          )}:\n            ${formatTimestamp(values[0].axisValue)}\n          </div>`,\n          `<div class=\"tooltip-date\" style=\"border: none;\">${'Relative Time'}:\n            ${showPlayerTime(\n              moment(values[0].axisValue * 1000)\n                .toDate()\n                .toUTCString(),\n              startTimestamp\n            )}\n          </div>`,\n          '<div class=\"tooltip-arrow\"></div>',\n        ].join('');\n        return template;\n      },\n    }),\n    xAxis: XAxis({\n      type: 'time',\n      axisLabel: {\n        formatter: formatTimestamp,\n      },\n      theme,\n    }),\n    yAxis: YAxis({\n      type: 'value',\n      name: t('Heap Size'),\n      theme,\n      nameTextStyle: {\n        padding: 8,\n        fontSize: theme.fontSizeLarge,\n        fontWeight: 600,\n        lineHeight: 1.2,\n        color: theme.gray300,\n      },\n      // input is in bytes, minInterval is a megabyte\n      minInterval: 1024 * 1024,\n      // maxInterval is a terabyte\n      maxInterval: Math.pow(1024, 4),\n      // format the axis labels to be whole number values\n      axisLabel: {\n        formatter: value => formatBytesBase2(value, 0),\n      },\n    }),\n\n    // XXX: For area charts, mouse events *only* occurs when interacting with\n    // the \"line\" of the area chart. Mouse events do not fire when interacting\n    // with the \"area\" under the line.\n    onMouseOver: ({data}) => {\n      if (data[0]) {\n        setCurrentHoverTime((data[0] - startTimestamp) * 1000);\n      }\n    },\n    onMouseOut: () => {\n      setCurrentHoverTime(undefined);\n    },\n    onClick: ({data}) => {\n      if (data.value) {\n        setCurrentTime((data.value - startTimestamp) * 1000);\n      }\n    },\n  };\n\n  const series: Series[] = [\n    {\n      seriesName: t('Used Heap Memory'),\n      data: memorySpans.map(span => ({\n        value: span.data.memory.usedJSHeapSize,\n        name: span.endTimestamp,\n      })),\n      stack: 'heap-memory',\n      lineStyle: {\n        opacity: 0.75,\n        width: 1,\n      },\n    },\n    {\n      seriesName: t('Free Heap Memory'),\n      data: memorySpans.map(span => ({\n        value: span.data.memory.totalJSHeapSize - span.data.memory.usedJSHeapSize,\n        name: span.endTimestamp,\n      })),\n      stack: 'heap-memory',\n      lineStyle: {\n        opacity: 0.75,\n        width: 1,\n      },\n    },\n\n    // Inserting this here so we can update in Container\n    {\n      id: 'currentTime',\n      seriesName: t('Current player time'),\n      data: [],\n      markLine: {\n        symbol: ['', ''],\n        data: [],\n        label: {\n          show: false,\n        },\n        lineStyle: {\n          type: 'solid' as const,\n          color: theme.purple300,\n          width: 2,\n        },\n      },\n    },\n    {\n      id: 'hoverTime',\n      seriesName: t('Hover player time'),\n      data: [],\n      markLine: {\n        symbol: ['', ''],\n        data: [],\n        label: {\n          show: false,\n        },\n        lineStyle: {\n          type: 'solid' as const,\n          color: theme.purple200,\n          width: 2,\n        },\n      },\n    },\n  ];\n\n  return (\n    <MemoryChartWrapper>\n      <AreaChart forwardedRef={forwardedRef} series={series} {...chartOptions} />\n    </MemoryChartWrapper>\n  );\n}\n\nconst MemoryChartWrapper = styled('div')`\n  margin-top: ${space(2)};\n  margin-bottom: ${space(3)};\n  border-radius: ${space(0.5)};\n  border: 1px solid ${p => p.theme.border};\n`;\n\nconst MemoizedMemoryChart = memo(\n  forwardRef<ReactEchartsRef, Props>((props, ref) => (\n    <MemoryChart forwardedRef={ref} {...props} />\n  ))\n);\n\ninterface MemoryChartContainerProps extends Props {\n  currentHoverTime: number | undefined;\n  currentTime: number;\n}\n\n/**\n * This container is used to update echarts outside of React. `currentTime` is\n * the current time of the player -- if replay is currently playing, this will be\n * updated quite frequently causing the chart to constantly re-render. The\n * re-renders will conflict with mouse interactions (e.g. hovers and\n * tooltips).\n *\n * We need `MemoryChart` (which wraps an `<AreaChart>`) to re-render as\n * infrequently as possible, so we use React.memo and only pass in props that\n * are not frequently updated.\n * */\nfunction MemoryChartContainer({\n  currentTime,\n  currentHoverTime,\n  startTimestamp = 0,\n  ...props\n}: MemoryChartContainerProps) {\n  const chart = useRef<ReactEchartsRef>(null);\n  const theme = useTheme();\n\n  useEffect(() => {\n    if (!chart.current) {\n      return;\n    }\n    const echarts = chart.current.getEchartsInstance();\n\n    echarts.setOption({\n      series: [\n        {\n          id: 'currentTime',\n          markLine: {\n            data: [\n              {\n                xAxis: currentTime / 1000 + startTimestamp,\n              },\n            ],\n          },\n        },\n      ],\n    });\n  }, [currentTime, startTimestamp, theme]);\n\n  useEffect(() => {\n    if (!chart.current) {\n      return;\n    }\n    const echarts = chart.current.getEchartsInstance();\n\n    echarts.setOption({\n      series: [\n        {\n          id: 'hoverTime',\n          markLine: {\n            data: [\n              ...(currentHoverTime\n                ? [\n                    {\n                      xAxis: currentHoverTime / 1000 + startTimestamp,\n                    },\n                  ]\n                : []),\n            ],\n          },\n        },\n      ],\n    });\n  }, [currentHoverTime, startTimestamp, theme]);\n\n  return <MemoizedMemoryChart ref={chart} startTimestamp={startTimestamp} {...props} />;\n}\n\nexport default MemoryChartContainer;\n","import {useEffect, useState} from 'react';\n\nimport EmptyStateWarning from 'sentry/components/emptyStateWarning';\nimport LoadingError from 'sentry/components/loadingError';\nimport LoadingIndicator from 'sentry/components/loadingIndicator';\nimport {ALL_ACCESS_PROJECTS} from 'sentry/constants/pageFilters';\nimport {t} from 'sentry/locale';\nimport {Organization} from 'sentry/types';\nimport type {EventTransaction} from 'sentry/types/event';\nimport {getUtcDateString} from 'sentry/utils/dates';\nimport {TableData} from 'sentry/utils/discover/discoverQuery';\nimport EventView from 'sentry/utils/discover/eventView';\nimport {doDiscoverQuery} from 'sentry/utils/discover/genericDiscoverQuery';\nimport {TraceFullDetailed} from 'sentry/utils/performance/quickTrace/types';\nimport {\n  getTraceRequestPayload,\n  makeEventView,\n} from 'sentry/utils/performance/quickTrace/utils';\nimport useApi from 'sentry/utils/useApi';\nimport {useRouteContext} from 'sentry/utils/useRouteContext';\nimport TraceView from 'sentry/views/performance/traceDetails/traceView';\n\ntype State = {\n  /**\n   * Error, if not null.\n   */\n  // error: QueryError | null;\n  error: any | null;\n  /**\n   * Loading state of this query.\n   */\n  isLoading: boolean;\n  /**\n   * Pagelinks, if applicable. Can be provided to the Pagination component.\n   */\n  pageLinks: string | null;\n  /**\n   * EventView that generates API payload\n   */\n  traceEventView: EventView | null;\n  /**\n   * Data / result.\n   */\n  traces: TraceFullDetailed[] | null;\n};\n\ninterface Props {\n  event: EventTransaction;\n  organization: Organization;\n}\n\nconst INITIAL_STATE = Object.freeze({\n  error: null,\n  isLoading: true,\n  pageLinks: null,\n  traceEventView: null,\n  traces: null,\n});\n\nexport default function Trace({event, organization}: Props) {\n  const [state, setState] = useState<State>(INITIAL_STATE);\n  const api = useApi();\n\n  const {\n    location,\n    params: {eventSlug, orgId},\n  } = useRouteContext();\n  const [, eventId] = eventSlug.split(':');\n\n  useEffect(() => {\n    async function loadTraces() {\n      const start = getUtcDateString(event.startTimestamp * 1000);\n      const end = getUtcDateString(event.endTimestamp * 1000);\n\n      const eventView = EventView.fromSavedQuery({\n        id: undefined,\n        name: `Traces in replay ${eventId}`,\n        fields: ['trace', 'count(trace)', 'min(timestamp)'],\n        orderby: 'min_timestamp',\n        query: `replayId:${eventId} !title:\"sentry-replay-event*\"`,\n        projects: [ALL_ACCESS_PROJECTS],\n        version: 2,\n\n        start,\n        end,\n      });\n\n      try {\n        const [data, , resp] = await doDiscoverQuery<TableData>(\n          api,\n          `/organizations/${orgId}/events/`,\n          eventView.getEventsAPIPayload(location)\n        );\n\n        const traceIds = data.data.map(({trace}) => trace).filter(trace => trace);\n\n        // TODO(replays): Potential performance concerns here if number of traceIds is large\n        const traceDetails = await Promise.all(\n          traceIds.map(traceId =>\n            doDiscoverQuery(\n              api,\n              `/organizations/${orgId}/events-trace/${traceId}/`,\n              getTraceRequestPayload({\n                eventView: makeEventView({start, end}),\n                location,\n              })\n            )\n          )\n        );\n\n        setState(prevState => ({\n          isLoading: false,\n          error: null,\n          traceEventView: eventView,\n          pageLinks: resp?.getResponseHeader('Link') ?? prevState.pageLinks,\n          traces: traceDetails.flatMap(([trace]) => trace as TraceFullDetailed[]) || [],\n        }));\n      } catch (err) {\n        setState({\n          isLoading: false,\n          error: err,\n          pageLinks: null,\n          traceEventView: null,\n          traces: null,\n        });\n      }\n    }\n\n    loadTraces();\n\n    return () => {};\n  }, [api, eventId, orgId, location, event.startTimestamp, event.endTimestamp]);\n\n  if (state.isLoading) {\n    return <LoadingIndicator />;\n  }\n\n  if (state.error || !state.traceEventView) {\n    return <LoadingError />;\n  }\n\n  if (!state.traces?.length) {\n    return (\n      <EmptyStateWarning withIcon={false} small>\n        {t('No traces found')}\n      </EmptyStateWarning>\n    );\n  }\n\n  return (\n    <TraceView\n      meta={null}\n      traces={state.traces}\n      location={location}\n      organization={organization}\n      traceEventView={state.traceEventView}\n      traceSlug=\"Replay\"\n    />\n  );\n  // TODO(replays): pagination\n}\n","import {useMemo} from 'react';\nimport {uuid4} from '@sentry/utils';\n\nimport Spans from 'sentry/components/events/interfaces/spans';\nimport Placeholder from 'sentry/components/placeholder';\nimport {useReplayContext} from 'sentry/components/replays/replayContext';\nimport TagsTable from 'sentry/components/tagsTable';\nimport type {RawCrumb} from 'sentry/types/breadcrumbs';\nimport {isBreadcrumbTypeDefault} from 'sentry/types/breadcrumbs';\nimport type {EventTransaction} from 'sentry/types/event';\nimport {EntryType} from 'sentry/types/event';\nimport useActiveTabFromLocation from 'sentry/utils/replays/hooks/useActiveTabFromLocation';\nimport ReplayReader from 'sentry/utils/replays/replayReader';\nimport useOrganization from 'sentry/utils/useOrganization';\n\nimport Console from './console';\nimport IssueList from './issueList';\nimport MemoryChart from './memoryChart';\nimport Trace from './trace';\n\ntype Props = {\n  replay: ReplayReader | null;\n};\n\nfunction getBreadcrumbsByCategory(breadcrumbs: RawCrumb[], categories: string[]) {\n  return breadcrumbs\n    .filter(isBreadcrumbTypeDefault)\n    .filter(breadcrumb => categories.includes(breadcrumb.category || ''));\n}\n\nfunction FocusArea({replay}: Props) {\n  const active = useActiveTabFromLocation();\n  const {currentTime, currentHoverTime, setCurrentTime, setCurrentHoverTime} =\n    useReplayContext();\n  const organization = useOrganization();\n\n  // Memoize this because re-renders will interfere with the mouse state of the\n  // chart (e.g. on mouse over and out)\n  const memorySpans = useMemo(() => {\n    return replay?.getRawSpans().filter(replay.isMemorySpan);\n  }, [replay]);\n\n  if (!replay || !memorySpans) {\n    return <Placeholder height=\"150px\" />;\n  }\n\n  const event = replay.getEvent();\n\n  switch (active) {\n    case 'console':\n      const consoleMessages = getBreadcrumbsByCategory(replay?.getRawCrumbs(), [\n        'console',\n      ]);\n      return (\n        <Console\n          breadcrumbs={consoleMessages ?? []}\n          startTimestamp={event?.startTimestamp}\n        />\n      );\n    case 'network': {\n      // Fake the span and Trace context\n      const nonMemorySpansEntry = {\n        type: EntryType.SPANS,\n        data: replay\n          .getRawSpans()\n          .filter(replay.isNotMemorySpan)\n          .map(({startTimestamp, endTimestamp, ...span}) => ({\n            ...span,\n            timestamp: endTimestamp,\n            start_timestamp: startTimestamp,\n            span_id: uuid4(), // TODO(replays): used as a React key\n            parent_span_id: 'replay_network_trace',\n          })),\n      };\n      const performanceEvent = {\n        ...event,\n        contexts: {\n          trace: {\n            type: 'trace',\n            op: 'Network',\n            description: 'WIP',\n            span_id: 'replay_network_trace',\n            status: 'ok',\n          },\n        },\n        entries: [nonMemorySpansEntry],\n      } as EventTransaction;\n      return <Spans organization={organization} event={performanceEvent} />;\n    }\n    case 'trace':\n      return <Trace organization={organization} event={event} />;\n    case 'issues':\n      return <IssueList replayId={event.id} projectId={event.projectID} />;\n    case 'tags':\n      return <TagsTable generateUrl={() => ''} event={event} query=\"\" />;\n    case 'memory':\n      return (\n        <MemoryChart\n          currentTime={currentTime}\n          currentHoverTime={currentHoverTime}\n          memorySpans={memorySpans}\n          setCurrentTime={setCurrentTime}\n          setCurrentHoverTime={setCurrentHoverTime}\n          startTimestamp={event?.startTimestamp}\n        />\n      );\n    default:\n      return null;\n  }\n}\n\nexport default FocusArea;\n","import React from 'react';\n\nimport NavTabs from 'sentry/components/navTabs';\nimport {t} from 'sentry/locale';\nimport useActiveTabFromLocation from 'sentry/utils/replays/hooks/useActiveTabFromLocation';\n\ntype Props = {};\n\nconst TABS = [\n  t('Console'),\n  t('Network'),\n  t('Trace'),\n  t('Issues'),\n  t('Tags'),\n  t('Memory'),\n];\n\nfunction FocusTabs({}: Props) {\n  const active = useActiveTabFromLocation();\n  return (\n    <NavTabs underlined>\n      {TABS.map(tab => (\n        <li key={tab} className={active === tab.toLowerCase() ? 'active' : ''}>\n          <a href={`#${tab.toLowerCase()}`}>{tab}</a>\n        </li>\n      ))}\n    </NavTabs>\n  );\n}\n\nexport default FocusTabs;\n","import {memo} from 'react';\nimport styled from '@emotion/styled';\n\nimport Tooltip from 'sentry/components/tooltip';\nimport {t} from 'sentry/locale';\nimport {BreadcrumbType, Crumb} from 'sentry/types/breadcrumbs';\n\ntype Props = {\n  action: Crumb;\n};\n\ntype ActionCategoryInfo = {\n  description: string;\n  title: string;\n};\n\nfunction getActionCategoryInfo(crumb: Crumb): ActionCategoryInfo {\n  switch (crumb.type) {\n    case BreadcrumbType.USER:\n    case BreadcrumbType.UI:\n      return {\n        title: t('UI Click'),\n        description: `${crumb.category}: ${crumb.message}`,\n      };\n    case BreadcrumbType.NAVIGATION:\n      return {\n        title: t('Navigation'),\n        description: `${crumb.category}: ${crumb.data?.from ?? ''} => ${\n          crumb.data?.to ?? ''\n        }`,\n      };\n    case BreadcrumbType.ERROR:\n      return {\n        title: t('Error'),\n        description: `${crumb.data?.type}: ${crumb.data?.value}`,\n      };\n    case BreadcrumbType.INIT:\n      return {\n        title: t('Replay Start'),\n        description: crumb.data?.url,\n      };\n    default:\n      return {\n        title: t('Default'),\n        description: '',\n      };\n  }\n}\n\nconst ActionCategory = memo(({action}: Props) => {\n  const {title, description} = getActionCategoryInfo(action);\n\n  return (\n    <Tooltip title={description} disabled={!description} skipWrapper disableForVisualTest>\n      <Value>{title}</Value>\n    </Tooltip>\n  );\n});\n\nconst Value = styled('div')`\n  color: ${p => p.theme.headingColor};\n  font-size: ${p => p.theme.fontSizeMedium};\n  font-weight: 400;\n  text-transform: capitalize;\n`;\n\nexport default ActionCategory;\n","import styled from '@emotion/styled';\n\nimport DateTime from 'sentry/components/dateTime';\nimport Tooltip from 'sentry/components/tooltip';\n\nimport {showPlayerTime} from './utils';\n\ntype Props = {\n  relativeTime: number | undefined;\n  timestamp: string | undefined;\n};\n\nconst PlayerRelativeTime = ({relativeTime, timestamp}: Props) => {\n  if (!timestamp || !relativeTime) {\n    return <div />;\n  }\n\n  return (\n    <Tooltip\n      title={<DateTime date={timestamp} />}\n      disabled={!timestamp}\n      skipWrapper\n      disableForVisualTest\n      underlineColor=\"gray300\"\n      showUnderline\n    >\n      <Value>{showPlayerTime(timestamp, relativeTime)}</Value>\n    </Tooltip>\n  );\n};\n\nconst Value = styled('p')`\n  color: ${p => p.theme.subText};\n  font-size: ${p => p.theme.fontSizeSmall};\n  font-weight: normal;\n`;\n\nexport default PlayerRelativeTime;\n","import {Fragment, useCallback} from 'react';\nimport styled from '@emotion/styled';\n\nimport Type from 'sentry/components/events/interfaces/breadcrumbs/breadcrumb/type';\nimport {\n  Panel as BasePanel,\n  PanelBody as BasePanelBody,\n  PanelHeader as BasePanelHeader,\n  PanelItem,\n} from 'sentry/components/panels';\nimport Placeholder from 'sentry/components/placeholder';\nimport ActionCategory from 'sentry/components/replays/actionCategory';\nimport PlayerRelativeTime from 'sentry/components/replays/playerRelativeTime';\nimport {useReplayContext} from 'sentry/components/replays/replayContext';\nimport {relativeTimeInMs} from 'sentry/components/replays/utils';\nimport {t} from 'sentry/locale';\nimport space from 'sentry/styles/space';\nimport {BreadcrumbType, Crumb} from 'sentry/types/breadcrumbs';\nimport {EventTransaction} from 'sentry/types/event';\nimport {getPrevBreadcrumb} from 'sentry/utils/replays/getBreadcrumb';\n\nfunction CrumbPlaceholder({number}: {number: number}) {\n  return (\n    <Fragment>\n      {[...Array(number)].map((_, i) => (\n        <PlaceholderMargin key={i} height=\"40px\" />\n      ))}\n    </Fragment>\n  );\n}\n\ntype Props = {\n  /**\n   * Raw breadcrumbs, `undefined` means it is still loading\n   */\n  crumbs: Crumb[] | undefined;\n  /**\n   * Root replay event, `undefined` means it is still loading\n   */\n  event: EventTransaction | undefined;\n};\n\ntype ContainerProps = {\n  isHovered: boolean;\n  isSelected: boolean;\n};\n\nconst USER_ACTIONS = [\n  BreadcrumbType.ERROR,\n  BreadcrumbType.INIT,\n  BreadcrumbType.NAVIGATION,\n  BreadcrumbType.UI,\n  BreadcrumbType.USER,\n];\n\nfunction UserActionsNavigator({event, crumbs}: Props) {\n  const {\n    setCurrentTime,\n    setCurrentHoverTime,\n    currentHoverTime,\n    currentTime,\n    highlight,\n    removeHighlight,\n    clearAllHighlights,\n  } = useReplayContext();\n\n  const startTimestamp = event?.startTimestamp || 0;\n  const userActionCrumbs =\n    crumbs?.filter(crumb => USER_ACTIONS.includes(crumb.type)) || [];\n\n  const isLoaded = Boolean(event);\n\n  const currentUserAction = getPrevBreadcrumb({\n    crumbs: userActionCrumbs,\n    targetTimestampMs: startTimestamp * 1000 + currentTime,\n    allowExact: true,\n  });\n\n  const closestUserAction =\n    currentHoverTime !== undefined\n      ? getPrevBreadcrumb({\n          crumbs: userActionCrumbs,\n          targetTimestampMs: startTimestamp * 1000 + (currentHoverTime ?? 0),\n          allowExact: true,\n        })\n      : undefined;\n\n  const onMouseEnter = useCallback(\n    (item: Crumb) => {\n      if (startTimestamp) {\n        setCurrentHoverTime(relativeTimeInMs(item.timestamp ?? '', startTimestamp));\n      }\n\n      if (item.data && 'nodeId' in item.data) {\n        // XXX: Kind of hacky, but mouseLeave does not fire if you move from a\n        // crumb to a tooltip\n        clearAllHighlights();\n        highlight({nodeId: item.data.nodeId});\n      }\n    },\n    [setCurrentHoverTime, startTimestamp, highlight, clearAllHighlights]\n  );\n\n  const onMouseLeave = useCallback(\n    (item: Crumb) => {\n      setCurrentHoverTime(undefined);\n\n      if (item.data && 'nodeId' in item.data) {\n        removeHighlight({nodeId: item.data.nodeId});\n      }\n    },\n    [setCurrentHoverTime, removeHighlight]\n  );\n\n  return (\n    <Panel>\n      <PanelHeader>{t('Event Chapters')}</PanelHeader>\n\n      <PanelBody>\n        {!isLoaded && <CrumbPlaceholder number={4} />}\n        {isLoaded &&\n          userActionCrumbs.map(item => (\n            <PanelItemCenter\n              key={item.id}\n              onMouseEnter={() => onMouseEnter(item)}\n              onMouseLeave={() => onMouseLeave(item)}\n            >\n              <Container\n                isHovered={closestUserAction?.id === item.id}\n                isSelected={currentUserAction?.id === item.id}\n                onClick={() =>\n                  item.timestamp !== undefined\n                    ? setCurrentTime(relativeTimeInMs(item.timestamp, startTimestamp))\n                    : null\n                }\n              >\n                <Wrapper>\n                  <Type\n                    type={item.type}\n                    color={item.color}\n                    description={item.description}\n                  />\n                  <ActionCategory action={item} />\n                </Wrapper>\n                <PlayerRelativeTime\n                  relativeTime={startTimestamp}\n                  timestamp={item.timestamp}\n                />\n              </Container>\n            </PanelItemCenter>\n          ))}\n      </PanelBody>\n    </Panel>\n  );\n}\n\n// FYI: Since the Replay Player has dynamic height based\n// on the width of the window,\n// height: 0; will helps us to reset the height\n// min-height: 100%; will helps us to grow at the same height of Player\nconst Panel = styled(BasePanel)`\n  width: 100%;\n  display: grid;\n  grid-template-rows: auto 1fr;\n  height: 0;\n  min-height: 100%;\n  @media only screen and (max-width: ${p => p.theme.breakpoints.large}) {\n    height: fit-content;\n    max-height: 400px;\n    margin-top: ${space(2)};\n  }\n`;\n\nconst PanelHeader = styled(BasePanelHeader)`\n  background-color: ${p => p.theme.white};\n  border-bottom: none;\n  font-size: ${p => p.theme.fontSizeSmall};\n  color: ${p => p.theme.gray300};\n  text-transform: capitalize;\n  padding: ${space(1.5)} ${space(2)} ${space(0.5)};\n`;\n\nconst PanelBody = styled(BasePanelBody)`\n  overflow-y: auto;\n`;\n\nconst PanelItemCenter = styled(PanelItem)`\n  display: block;\n  padding: ${space(0)};\n  cursor: pointer;\n`;\n\nconst Container = styled('button')<ContainerProps>`\n  display: inline-flex;\n  width: 100%;\n  border: none;\n  background: transparent;\n  justify-content: space-between;\n  align-items: center;\n  border-left: 4px solid transparent;\n  padding: ${space(1)} ${space(1.5)};\n  ${p => p.isHovered && `background: ${p.theme.surface400};`}\n  ${p => p.isSelected && `border-left: 4px solid ${p.theme.purple300};`}\n`;\n\nconst Wrapper = styled('div')`\n  display: flex;\n  align-items: center;\n  gap: ${space(1)};\n  font-size: ${p => p.theme.fontSizeMedium};\n  color: ${p => p.theme.gray500};\n`;\n\nconst PlaceholderMargin = styled(Placeholder)`\n  margin: ${space(1)} ${space(1.5)};\n  width: auto;\n`;\n\nexport default UserActionsNavigator;\n","import React from 'react';\nimport styled from '@emotion/styled';\n\nimport ErrorBoundary from 'sentry/components/errorBoundary';\nimport DetailedError from 'sentry/components/errors/detailedError';\nimport NotFound from 'sentry/components/errors/notFound';\nimport {HeaderContainer} from 'sentry/components/events/interfaces/spans/header';\nimport * as Layout from 'sentry/components/layouts/thirds';\nimport ReplayTimeline from 'sentry/components/replays/breadcrumbs/replayTimeline';\nimport {Provider as ReplayContextProvider} from 'sentry/components/replays/replayContext';\nimport ReplayView from 'sentry/components/replays/replayView';\nimport {t} from 'sentry/locale';\nimport {PageContent} from 'sentry/styles/organization';\nimport space from 'sentry/styles/space';\nimport useFullscreen from 'sentry/utils/replays/hooks/useFullscreen';\nimport useReplayData from 'sentry/utils/replays/hooks/useReplayData';\nimport {useRouteContext} from 'sentry/utils/useRouteContext';\n\nimport DetailLayout from './detail/detailLayout';\nimport FocusArea from './detail/focusArea';\nimport FocusTabs from './detail/focusTabs';\nimport UserActionsNavigator from './detail/userActionsNavigator';\n\nfunction ReplayDetails() {\n  const {\n    location,\n    params: {eventSlug, orgId},\n  } = useRouteContext();\n\n  const {\n    t: initialTimeOffset, // Time, in seconds, where the video should start\n  } = location.query;\n\n  const {fetchError, fetching, onRetry, replay} = useReplayData({\n    eventSlug,\n    orgId,\n  });\n\n  const {ref: fullscreenRef, isFullscreen, toggle: toggleFullscreen} = useFullscreen();\n\n  if (!fetching && !replay) {\n    // TODO(replay): Give the user more details when errors happen\n    console.log({fetching, fetchError}); // eslint-disable-line no-console\n    return (\n      <DetailLayout orgId={orgId}>\n        <PageContent>\n          <NotFound />\n        </PageContent>\n      </DetailLayout>\n    );\n  }\n\n  if (!fetching && replay && replay.getRRWebEvents().length < 2) {\n    return (\n      <DetailLayout event={replay.getEvent()} orgId={orgId}>\n        <DetailedError\n          onRetry={onRetry}\n          hideSupportLinks\n          heading={t('Expected two or more replay events')}\n          message={\n            <React.Fragment>\n              <p>{t('This Replay may not have captured any user actions.')}</p>\n              <p>\n                {t(\n                  'Or there may be an issue loading the actions from the server, click to try loading the Replay again.'\n                )}\n              </p>\n            </React.Fragment>\n          }\n        />\n      </DetailLayout>\n    );\n  }\n\n  return (\n    <ReplayContextProvider replay={replay} initialTimeOffset={initialTimeOffset}>\n      <DetailLayout\n        event={replay?.getEvent()}\n        orgId={orgId}\n        crumbs={replay?.getRawCrumbs()}\n      >\n        <Layout.Body>\n          <Layout.Main ref={fullscreenRef}>\n            <ReplayView toggleFullscreen={toggleFullscreen} isFullscreen={isFullscreen} />\n          </Layout.Main>\n\n          <Layout.Side>\n            <ErrorBoundary>\n              <UserActionsNavigator\n                crumbs={replay?.getRawCrumbs()}\n                event={replay?.getEvent()}\n              />\n            </ErrorBoundary>\n          </Layout.Side>\n\n          <StickyMain fullWidth>\n            <ErrorBoundary>\n              <ReplayTimeline />\n            </ErrorBoundary>\n            <FocusTabs />\n          </StickyMain>\n\n          <StyledLayoutMain fullWidth>\n            <ErrorBoundary>\n              <FocusArea replay={replay} />\n            </ErrorBoundary>\n          </StyledLayoutMain>\n        </Layout.Body>\n      </DetailLayout>\n    </ReplayContextProvider>\n  );\n}\n\nconst StickyMain = styled(Layout.Main)`\n  position: sticky;\n  top: 0;\n  z-index: ${p => p.theme.zIndex.header};\n\n  /* Make this component full-bleed, so the background covers everything underneath it */\n  margin: -${space(1.5)} -${space(4)} -${space(3)};\n  padding: ${space(1.5)} ${space(4)} 0;\n  max-width: none;\n  background: ${p => p.theme.background};\n`;\n\nconst StyledLayoutMain = styled(Layout.Main)`\n  ${HeaderContainer} {\n    position: relative;\n  }\n`;\n\nexport default ReplayDetails;\n","/**\n * Given a list of objects (or maps) of `string` -> `any[]`,\n * merge the arrays of each key in the object.\n *\n * e.g. [{a: [1]}, {a: [2]}, {b: [3]}] ==> {a: [1, 2], b: {3}}\n *\n * Any non-array values will throw an exception\n */\nexport default function flattenListOfObjects(\n  objs: Array<Record<string, any[] | undefined>>\n) {\n  return objs.reduce((acc, obj) => {\n    Object.entries(obj).forEach(([key, value]) => {\n      if (!Array.isArray(value)) {\n        // e.g. if value is undefined (otherwise, a non-Array type will get caught by ts)\n        // TS doesn't like our test where object keys are no equivalent, so we\n        // need to allow `undefined` as a valid type in the Record.\n        throw new Error('Invalid value');\n      }\n\n      acc[key] = (acc[key] || []).concat(value);\n    });\n\n    return acc;\n  }, {});\n}\n","import {useMemo} from 'react';\n\nimport {ReplayError} from 'sentry/views/replays/types';\n\nimport useDiscoverQuery from './useDiscoveryQuery';\n\ninterface Params {\n  replayId: string;\n  ignoreCursor?: boolean;\n}\n\n/**\n * Fetches a list of errors that occurred in a replay\n */\nexport default function useReplayErrors({replayId, ...props}: Params) {\n  const discoverQuery = useMemo(\n    () => ({\n      query: `replayId:${replayId} AND event.type:error`,\n      fields: ['event.id', 'error.value', 'timestamp', 'error.type', 'issue.id'],\n\n      // environment and project shouldn't matter because having a replayId\n      // assumes we have already filtered down to proper env/project\n      environment: [],\n      projects: [],\n    }),\n    [replayId]\n  );\n\n  return useDiscoverQuery<ReplayError>({discoverQuery, ...props});\n}\n"],"names":["AreaChart","series","stacked","colors","props","map","i","seriesName","data","otherSeriesProps","LineSeries","AreaSeries","stack","undefined","name","value","lineStyle","color","opacity","width","areaStyle","animation","animationThreshold","animationDuration","FeatureFeedback","feedbackTypes","featureName","buttonProps","icon","onClick","async","mod","FeedbackModal","modalCss","openModal","deps","t","KeyValueTable","KeyValueTableRow","keyName","Fragment","Key","Value","commonStyles","theme","fontSizeMedium","space","p","overflowEllipsis","backgroundSecondary","textColor","subText","TagsTable","event","query","generateUrl","title","tags","withMeta","formatErrorKind","kind","capitalize","replace","getTooltipTitle","errors","TooltipTitle","error","Array","isArray","reason","StyledTagsTable","tag","tagInQuery","includes","key","target","keyMetaData","getMeta","valueMetaData","renderTagValue","version","anchor","withPackage","err","length","StyledTooltip","to","Tooltip","getUrlPathname","url","URL","pathname","INITIAL_STATE","isLoading","pageLinks","FAKE_LOCATION","useDiscoverQuery","endpoint","discoverQuery","ignoreCursor","state","setState","useState","api","useApi","organization","useOrganization","useEffect","slug","EventView","environment","projects","id","getEventsAPIPayload","prevState","clear","resp","requestPromise","includeAllArgs","getResponseHeader","runQuery","useLocation","useRouteContext","location","ref","useRef","current","Columns","totalColumns","remainder","Col","padZero","num","len","str","String","threshold","Math","pow","HOUR","relativeTimeInMs","timestamp","diffMs","moment","diff","valueOf","showPlayerTime","relativeTime","format","formatTime","ms","hour","floor","minute","second","countColumns","duration","minWidth","maxCols","timeOptions","timeBasedCols","reduce","time","set","Map","timespan","cols","from","entries","filter","_span","c","best","next","remaining","doesOverlap","a","b","bStartsWithinA","startTimestamp","endTimestamp","bEndsWithinA","divide","numerator","denominator","isNaN","Line","Timeline","gray100","Gridlines","children","_","MajorGridlines","MinorGridlines","ReplayTimelineEvents","className","crumbs","eventsByCol","startMilliSeconds","safeDuration","breadcrumb","timestampMilliSeconds","Date","sinceStart","column","has","get","push","getCrumbsByColumn","EventColumns","breadcrumbs","EventColumn","Event","zIndex","initial","getCrumbDetail","crumb","type","BreadcrumbType","message","description","HoverList","HoverListItem","mostInteresting","rank","sortByMostInterestingType","IconPosition","body","IconNode","innerBorder","EVENT_STICK_MARKER_WIDTH","fontSizeSmall","white","dropShadowLightest","spans","flattenedSpans","rawSpans","span","spanCount","firstSpan","restSpans","flatSpans","overlap","fspan","min","max","flattenSpans","startMs","Spans","startPct","widthPct","requestsCount","tn","toFixed","skipWrapper","disableForVisualTest","Span","React","highlightsByNodeId","removeHighlightedNode","replayer","nodeId","highlightObj","wrapper","contains","canvas","removeChild","delete","highlightNode","annotation","mouseTail","node","getMirror","getNode","iframe","contentDocument","top","left","height","getBoundingClientRect","highlightColor","cloneNode","ctx","getContext","fillStyle","fillRect","beginPath","setLineDash","moveTo","lineTo","closePath","stroke","font","textAlign","textBaseline","textWidth","measureText","fillText","insertBefore","ReplayPlayerContext","clearAllHighlights","currentHoverTime","currentTime","dimensions","fastForwardSpeed","highlight","initRoot","isBuffering","isPlaying","isSkippingInactive","removeHighlight","replay","setCurrentHoverTime","setCurrentTime","setSpeed","speed","togglePlayPause","toggleSkipInactive","Provider","initialTimeOffset","events","getRRWebEvents","useTheme","oldEvents","usePrevious","hasNewEvents","replayerRef","setDimensions","setIsPlaying","setIsSkippingInactive","setSpeedState","setFFSpeed","buffer","setBufferTime","previous","playTimer","forceDimensions","dimension","setPlayingFalse","onFastForwardStart","e","onFastForwardEnd","useCallback","clearAllHighlightsCallback","keys","root","childElementCount","firstChild","highlightReplayPlugin","constructor","defaultHighlightColor","this","handler","_isSync","size","removes","forEach","removedNode","added","expires","source","isHighlightEvent","text","inst","Replayer","blockClass","lineCap","lineWidth","strokeStyle","purple200","plugins","on","ReplayerEvents","parentElement","getCurrentTime","requestedTimeMs","getMetaData","totalTime","window","clearTimeout","setTimeout","play","pause","newSpeed","setConfig","skip","config","skipInactive","currentPlayerTime","callback","timer","requestAnimationFrame","cancelAnimationFrame","useRAF","useCurrentTime","getEvent","useReplayContext","useContext","AbortError","Error","HorizontalMouseTracking","elem","controller","AbortController","onMouseMove","rect","signal","Promise","resolve","reject","aborted","abortHandler","observer","IntersectionObserver","entry","bounds","boundingClientRect","removeEventListener","disconnect","addEventListener","observe","getBoundingRect","clientX","percent","Sentry","onMouseLeave","abort","onMouseEnter","Meter","Scrubber","percentComplete","hoverPlace","Wrapper","MouseTrackingValue","PlaybackTimeValue","RangeWrapper","Range","round","onChange","showLabel","Progress","gray200","RangeSlider","purple300","TimelineScubber","PlayerScrubber","Resizeable","el","onResize","clientHeight","clientWidth","useResizeObserver","TimelinePosition","USER_ACTIONS","ReplayTimeline","bottomGutter","getRawCrumbs","getRawSpans","userCrumbs","networkSpans","isNotMemorySpan","StackedUnderTimestamp","Stacked","getPrevBreadcrumb","targetTimestampMs","allowExact","prev","crumbTimestampMS","useFullscreen","isFullscreen","setIsFullscreen","enter","opts","navigationUI","screenfull","exit","toggle","isEnabled","ReplayPlayPauseBar","merged","startTimestampSec","found","getNextBreadcrumb","transformCrumbs","ReplayCurrentTime","ReplayPlaybackSpeed","speedOptions","triggerProps","prefix","options","speedOption","label","disabled","opt","ReplayControls","toggleFullscreen","ButtonGrid","direction","priority","currentOffsetMS","currentTimeMs","navigationCrumbs","initialUrl","find","origin","mostRecentNavigation","last","ReplayCurrentUrl","UrlCopyInput","getCurrentUrl","TextCopyInput","StyledInput","StyledCopyButton","BufferingOverlay","Overlay","Message","gray300","borderRadius","FastForwardBadge","Badge","FastForwardTooltip","BasePlayerRoot","Infinity","videoDimensions","windowEl","viewEl","windowDimensions","setWindowDimensions","updateWindowDimensions","ResizeObserver","windowHeight","scale","style","transform","SizingWindow","minHeight","isLoaded","PositionedFastForward","PositionedBuffering","PlayerRoot","ReplayView","containerRef","playerRef","windowInnerHeight","setWindowInnerHeight","innerHeight","playerHeight","setPlayerHeight","debounce","containerBottom","offsetTop","offsetHeight","playerOffsetHeight","calc","PanelNoMargin","PanelHeader","disablePadding","noBorder","ReplayControllerWrapper","PanelBody","Panel","_PanelHeader","ReplayReader","rrwebEvents","op","isMemorySpan","startTimestampMS","endTimestampMS","rawCrumbs","rawSpanData","rrwebTimestamps","breadcrumbTimestamps","rawCrumb","Boolean","spanStartTimestamps","spanEndTimestamps","replayTimestamps","sort","spansFactory","rootEvent","initBreadcrumb","toISOString","level","BreadcrumbLevelType","action","errorCrumbs","category","breadcrumbFactory","highlights","concat","firstRRWebEvent","first","rrwebEventListFactory","IS_RRWEB_ATTACHMENT_FILENAME","isRRWebEventAttachment","attachment","test","Object","freeze","fetchError","fetching","isErrorsFetching","KeyMetrics","KeyMetricData","DetailLayout","orgId","urlToShare","useMemo","href","currentTimeSec","searchParams","toString","createUrlToShare","ButtonActionsWrapper","hideUnsupported","EventHeader","MetaDataColumn","EventMetaData","HeaderPlaceholder","background","urlTag","BigNameUserBadge","avatarSize","user","username","ip_address","email","displayEmail","Layout","date","dateReceived","seconds","abbreviation","exact","UserBadge","StyledName","ReplayTabs","DEFAULT_TAB","CONSOLE","hash","toUpperCase","renderString","arg","JSON","stringify","MessageFormatter","args","arguments","isMessageString","placeholders","sprintf","parsed","consoleColorPlaceholderIndexes","placeholder","messageArgs","slice","colorIndex","splice","restArgs","formattedMessage","vsprintf","replaceAll","meta","join","ConsoleMessage","isActive","isLast","ICONS","isCircled","warning","Icon","mini","ConsoleTimestamp","onMouseOver","onMouseOut","Common","alert","backgroundLight","iconHoverColor","focus","getDistinctLogLevels","Set","Console","searchTerm","setSearchTerm","logLevel","setLogLevel","handleSearch","filteredBreadcrumbs","normalizedSearchTerm","toLowerCase","doesMatch","filterBreadcrumbs","activeConsoleBounds","indexUpperBound","finalBreadCrumbIndex","finalBreadcrumbTimestamp","findIndex","activeMessageBoundary","ConsoleFilters","multiple","breadcrumbLogLevel","selections","selection","ConsoleTable","StyledEmptyMessage","breakpoints","small","EmptyMessage","familyMono","columns","IssueList","usePageFilters","isScreenLarge","useMedia","issuesById","setIssuesById","issueStatsById","setIssuesStatsById","fetchIssueData","issues","project","projectId","replayId","keyBy","issuesResults","groups","issue","renderTableRow","matchedIssue","matchedIssueStats","IssueDetailsWrapper","includeLink","firstSeen","lastSeen","ChartWrapper","stats","statsPeriod","DEFAULT_STREAM_GROUP_STATS_PERIOD","showSecondaryPoints","showMarkLine","Item","count","userCount","eventView","eventQueryParams","fields","environments","getEventView","orgSlug","limit","StyledPanelTable","isEmpty","tableData","emptyMessage","headers","PanelTable","large","formatTimestamp","getFormattedDate","local","MemoryChart","forwardedRef","memorySpans","withIcon","chartOptions","grid","Grid","right","tooltip","trigger","formatter","values","marker","formatBytesBase2","axisValue","toDate","toUTCString","xAxis","XAxis","axisLabel","yAxis","YAxis","nameTextStyle","padding","fontSize","fontSizeLarge","fontWeight","lineHeight","minInterval","maxInterval","memory","usedJSHeapSize","totalJSHeapSize","markLine","symbol","show","MemoryChartWrapper","border","MemoizedMemoryChart","memo","forwardRef","MemoryChartContainer","chart","getEchartsInstance","setOption","traceEventView","traces","Trace","params","eventSlug","eventId","split","start","getUtcDateString","end","orderby","ALL_ACCESS_PROJECTS","doDiscoverQuery","traceIds","trace","traceDetails","all","traceId","getTraceRequestPayload","makeEventView","flatMap","loadTraces","traceSlug","active","useActiveTabFromLocation","consoleMessages","categories","isBreadcrumbTypeDefault","getBreadcrumbsByCategory","nonMemorySpansEntry","EntryType","start_timestamp","span_id","uuid4","parent_span_id","performanceEvent","contexts","status","projectID","TABS","FocusTabs","underlined","tab","ActionCategory","getActionCategoryInfo","headingColor","PlayerRelativeTime","underlineColor","showUnderline","CrumbPlaceholder","number","PlaceholderMargin","UserActionsNavigator","userActionCrumbs","currentUserAction","closestUserAction","item","PanelItemCenter","Container","isHovered","isSelected","BasePanel","BasePanelHeader","BasePanelBody","PanelItem","surface400","gray500","Placeholder","ReplayDetails","onRetry","fetchEvent","fetchRRWebEvents","rrwebAttachmentIds","response","parse","responseBlob","rawResponse","blob","responseArray","arrayBuffer","replayAttachments","unsortedReplayAttachments","replaySpans","recording","payload","mapRRWebAttachments","inflate","acc","obj","useReplayErrors","loadEvents","attachments","factory","useReplayData","fullscreenRef","hideSupportLinks","heading","StickyMain","fullWidth","StyledLayoutMain","console","log","header","HeaderContainer"],"sourceRoot":""}